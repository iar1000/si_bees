{"custom_metrics": {"reward_total_mean": -15.9375, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001953125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001953125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 4.502599318822225, "policy_loss": -0.1372078169758121, "vf_loss": 6.150990394751231, "vf_explained_var": -0.03243823746840159, "kl": 0.0, "entropy": 99.67753480275472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9375, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.9375, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001953125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001953125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2369169826396027, "mean_inference_ms": 10.096335736399272, "mean_action_processing_ms": 0.42621015805250023, "mean_env_wait_ms": 0.2695863474646972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2506673336029053, "StateBufferConnector_ms": 0.0048860907554626465, "ViewRequirementAgentConnector_ms": 0.14900043606758118}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9375, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2369169826396027, "mean_inference_ms": 10.096335736399272, "mean_action_processing_ms": 0.42621015805250023, "mean_env_wait_ms": 0.2695863474646972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2506673336029053, "StateBufferConnector_ms": 0.0048860907554626465, "ViewRequirementAgentConnector_ms": 0.14900043606758118}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.095070967934627, "num_agent_steps_trained_throughput_per_sec": 7.095070967934627, "timesteps_total": 512, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 512, "timers": {"training_iteration_time_ms": 72162.729, "sample_time_ms": 6192.228, "load_time_ms": 1.012, "load_throughput": 506123.886, "learn_time_ms": 65968.785, "learn_throughput": 7.761, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512}, "done": false, "episodes_total": 32, "training_iteration": 1, "trial_id": "08022_00064", "date": "2024-02-26_20-54-21", "timestamp": 1708977261, "time_this_iter_s": 72.16483569145203, "time_total_s": 72.16483569145203, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 72.16483569145203, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 51.76601941747573, "ram_util_percent": 19.313592233009715}, "checkpoint_dir_name": "checkpoint_000000"}
{"custom_metrics": {"reward_total_mean": -15.96875, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0009765625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0009765625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 3.1858932316303252, "policy_loss": -0.10741134310762088, "vf_loss": 4.3659325043360395, "vf_explained_var": -0.02675627718369166, "kl": 0.0, "entropy": 99.96142400105795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96875, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.96875, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0009765625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0009765625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2675866841283714, "mean_inference_ms": 10.235606856303734, "mean_action_processing_ms": 0.4336709912264336, "mean_env_wait_ms": 0.27574426056751195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.258009135723114, "StateBufferConnector_ms": 0.0052988529205322266, "ViewRequirementAgentConnector_ms": 0.17186813056468964}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96875, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2675866841283714, "mean_inference_ms": 10.235606856303734, "mean_action_processing_ms": 0.4336709912264336, "mean_env_wait_ms": 0.27574426056751195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.258009135723114, "StateBufferConnector_ms": 0.0052988529205322266, "ViewRequirementAgentConnector_ms": 0.17186813056468964}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.952341952987521, "num_agent_steps_trained_throughput_per_sec": 6.952341952987521, "timesteps_total": 1024, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 1024, "timers": {"training_iteration_time_ms": 72903.472, "sample_time_ms": 6375.857, "load_time_ms": 0.655, "load_throughput": 781187.213, "learn_time_ms": 66526.366, "learn_throughput": 7.696, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "done": false, "episodes_total": 64, "training_iteration": 2, "trial_id": "08022_00064", "date": "2024-02-26_20-55-39", "timestamp": 1708977339, "time_this_iter_s": 73.64764761924744, "time_total_s": 145.81248331069946, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 145.81248331069946, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 52.78727272727272, "ram_util_percent": 19.400000000000006}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.958333333333334, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0013020833333333333, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0013020833333333333, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 2.9309448262055713, "policy_loss": -0.10868198114136855, "vf_loss": 4.029631978273391, "vf_explained_var": -0.015157722433408101, "kl": 0.0, "entropy": 99.71080837249755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.958333333333334, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.958333333333334, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0013020833333333333, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0013020833333333333, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2806949141499941, "mean_inference_ms": 10.29128903196698, "mean_action_processing_ms": 0.43578407814438475, "mean_env_wait_ms": 0.27810536318717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25961995124816895, "StateBufferConnector_ms": 0.005113085110982259, "ViewRequirementAgentConnector_ms": 0.1771827538808187}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.958333333333334, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2806949141499941, "mean_inference_ms": 10.29128903196698, "mean_action_processing_ms": 0.43578407814438475, "mean_env_wait_ms": 0.27810536318717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25961995124816895, "StateBufferConnector_ms": 0.005113085110982259, "ViewRequirementAgentConnector_ms": 0.1771827538808187}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.979111449748013, "num_agent_steps_trained_throughput_per_sec": 6.979111449748013, "timesteps_total": 1536, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 1536, "timers": {"training_iteration_time_ms": 73056.223, "sample_time_ms": 6392.605, "load_time_ms": 0.526, "load_throughput": 972885.978, "learn_time_ms": 66662.502, "learn_throughput": 7.68, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536}, "done": false, "episodes_total": 96, "training_iteration": 3, "trial_id": "08022_00064", "date": "2024-02-26_20-56-53", "timestamp": 1708977413, "time_this_iter_s": 73.36684322357178, "time_total_s": 219.17932653427124, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 219.17932653427124, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 52.454807692307696, "ram_util_percent": 19.43653846153846}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 2.798956282933553, "policy_loss": -0.10321037471294403, "vf_loss": 3.8474010725816092, "vf_explained_var": -0.033906500041484836, "kl": 0.0, "entropy": 99.64392585754395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3071009921728216, "mean_inference_ms": 10.41206806610047, "mean_action_processing_ms": 0.4413838089864414, "mean_env_wait_ms": 0.28303414163078533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2673351764678955, "StateBufferConnector_ms": 0.0052089691162109375, "ViewRequirementAgentConnector_ms": 0.19508862495422363}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3071009921728216, "mean_inference_ms": 10.41206806610047, "mean_action_processing_ms": 0.4413838089864414, "mean_env_wait_ms": 0.28303414163078533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2673351764678955, "StateBufferConnector_ms": 0.0052089691162109375, "ViewRequirementAgentConnector_ms": 0.19508862495422363}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.937200939149424, "num_agent_steps_trained_throughput_per_sec": 6.937200939149424, "timesteps_total": 2048, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 73243.405, "sample_time_ms": 6454.584, "load_time_ms": 0.471, "load_throughput": 1087058.288, "learn_time_ms": 66787.767, "learn_throughput": 7.666, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "done": false, "episodes_total": 128, "training_iteration": 4, "trial_id": "08022_00064", "date": "2024-02-26_20-58-06", "timestamp": 1708977486, "time_this_iter_s": 73.81045341491699, "time_total_s": 292.98977994918823, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 292.98977994918823, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 52.474285714285706, "ram_util_percent": 19.3952380952381}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 2.4269271244605384, "policy_loss": -0.10089680493498841, "vf_loss": 3.3511351029078167, "vf_explained_var": 0.017696044345696767, "kl": 0.0, "entropy": 99.19581871032715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3205629988094285, "mean_inference_ms": 10.47875706814797, "mean_action_processing_ms": 0.4438310305648965, "mean_env_wait_ms": 0.28529485409550676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2676725387573242, "StateBufferConnector_ms": 0.005038261413574219, "ViewRequirementAgentConnector_ms": 0.1975994110107422}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3205629988094285, "mean_inference_ms": 10.47875706814797, "mean_action_processing_ms": 0.4438310305648965, "mean_env_wait_ms": 0.28529485409550676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2676725387573242, "StateBufferConnector_ms": 0.005038261413574219, "ViewRequirementAgentConnector_ms": 0.1975994110107422}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.909000121695846, "num_agent_steps_trained_throughput_per_sec": 6.909000121695846, "timesteps_total": 2560, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 2560, "timers": {"training_iteration_time_ms": 73415.961, "sample_time_ms": 6485.952, "load_time_ms": 0.441, "load_throughput": 1161681.082, "learn_time_ms": 66928.962, "learn_throughput": 7.65, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560}, "done": false, "episodes_total": 160, "training_iteration": 5, "trial_id": "08022_00064", "date": "2024-02-26_20-59-21", "timestamp": 1708977561, "time_this_iter_s": 74.11185789108276, "time_total_s": 367.101637840271, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 367.101637840271, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 52.578095238095244, "ram_util_percent": 19.351428571428574}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 2.2143607079982757, "policy_loss": -0.09750274304921429, "vf_loss": 3.064836402734121, "vf_explained_var": 0.004355708758036296, "kl": 0.0, "entropy": 98.96370754241943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3311975246073209, "mean_inference_ms": 10.539620342739516, "mean_action_processing_ms": 0.4468079227378822, "mean_env_wait_ms": 0.2871550361021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26848459243774414, "StateBufferConnector_ms": 0.0051174163818359375, "ViewRequirementAgentConnector_ms": 0.2017204761505127}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3311975246073209, "mean_inference_ms": 10.539620342739516, "mean_action_processing_ms": 0.4468079227378822, "mean_env_wait_ms": 0.2871550361021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26848459243774414, "StateBufferConnector_ms": 0.0051174163818359375, "ViewRequirementAgentConnector_ms": 0.2017204761505127}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.931659718718305, "num_agent_steps_trained_throughput_per_sec": 6.931659718718305, "timesteps_total": 3072, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 3072, "timers": {"training_iteration_time_ms": 73490.623, "sample_time_ms": 6511.972, "load_time_ms": 0.423, "load_throughput": 1211214.691, "learn_time_ms": 66977.615, "learn_throughput": 7.644, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "done": false, "episodes_total": 192, "training_iteration": 6, "trial_id": "08022_00064", "date": "2024-02-26_21-00-34", "timestamp": 1708977634, "time_this_iter_s": 73.86922669410706, "time_total_s": 440.97086453437805, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 440.97086453437805, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 52.56571428571428, "ram_util_percent": 19.283809523809527}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.98, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.000625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.000625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 1.972245141863823, "policy_loss": -0.09998902001728614, "vf_loss": 2.747159932057063, "vf_explained_var": 0.08918199390172958, "kl": 0.0, "entropy": 98.71464716593424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.98, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.000625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.000625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3329413290928187, "mean_inference_ms": 10.55322079495839, "mean_action_processing_ms": 0.44720796208556635, "mean_env_wait_ms": 0.28697363345513166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2607407569885254, "StateBufferConnector_ms": 0.004930973052978516, "ViewRequirementAgentConnector_ms": 0.19011664390563965}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3329413290928187, "mean_inference_ms": 10.55322079495839, "mean_action_processing_ms": 0.44720796208556635, "mean_env_wait_ms": 0.28697363345513166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2607407569885254, "StateBufferConnector_ms": 0.004930973052978516, "ViewRequirementAgentConnector_ms": 0.19011664390563965}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.946886079002945, "num_agent_steps_trained_throughput_per_sec": 6.946886079002945, "timesteps_total": 3584, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 3584, "timers": {"training_iteration_time_ms": 73520.828, "sample_time_ms": 6470.857, "load_time_ms": 0.408, "load_throughput": 1256153.216, "learn_time_ms": 67048.953, "learn_throughput": 7.636, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584}, "done": false, "episodes_total": 224, "training_iteration": 7, "trial_id": "08022_00064", "date": "2024-02-26_21-01-48", "timestamp": 1708977708, "time_this_iter_s": 73.70712423324585, "time_total_s": 514.6779887676239, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 514.6779887676239, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 52.37884615384616, "ram_util_percent": 19.356730769230772}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 1.7715996732314427, "policy_loss": -0.10358834788203239, "vf_loss": 2.485935962200165, "vf_explained_var": 0.1090030441681544, "kl": 0.0, "entropy": 99.09763743082682, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.329680651355674, "mean_inference_ms": 10.539963166398344, "mean_action_processing_ms": 0.44608807363892167, "mean_env_wait_ms": 0.2857018838230478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2554759979248047, "StateBufferConnector_ms": 0.004740715026855469, "ViewRequirementAgentConnector_ms": 0.18288636207580566}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.329680651355674, "mean_inference_ms": 10.539963166398344, "mean_action_processing_ms": 0.44608807363892167, "mean_env_wait_ms": 0.2857018838230478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2554759979248047, "StateBufferConnector_ms": 0.004740715026855469, "ViewRequirementAgentConnector_ms": 0.18288636207580566}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.9430860893135975, "num_agent_steps_trained_throughput_per_sec": 6.9430860893135975, "timesteps_total": 4096, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 73548.524, "sample_time_ms": 6450.539, "load_time_ms": 0.391, "load_throughput": 1308344.314, "learn_time_ms": 67097.004, "learn_throughput": 7.631, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "done": false, "episodes_total": 256, "training_iteration": 8, "trial_id": "08022_00064", "date": "2024-02-26_21-03-02", "timestamp": 1708977782, "time_this_iter_s": 73.74756217002869, "time_total_s": 588.4255509376526, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 588.4255509376526, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 52.08571428571429, "ram_util_percent": 19.25428571428571}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.98, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.000625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.000625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 1.7167227029800416, "policy_loss": -0.10242646876722575, "vf_loss": 2.4116452733675637, "vf_explained_var": 0.11897843728462855, "kl": 0.0, "entropy": 98.88178990681966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.98, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.000625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.000625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3269126282654837, "mean_inference_ms": 10.529832391594288, "mean_action_processing_ms": 0.4449598047037395, "mean_env_wait_ms": 0.284628392529171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2573368549346924, "StateBufferConnector_ms": 0.004717111587524414, "ViewRequirementAgentConnector_ms": 0.19057774543762207}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3269126282654837, "mean_inference_ms": 10.529832391594288, "mean_action_processing_ms": 0.4449598047037395, "mean_env_wait_ms": 0.284628392529171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2573368549346924, "StateBufferConnector_ms": 0.004717111587524414, "ViewRequirementAgentConnector_ms": 0.19057774543762207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.884472324228153, "num_agent_steps_trained_throughput_per_sec": 6.884472324228153, "timesteps_total": 4608, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4608, "timers": {"training_iteration_time_ms": 73639.824, "sample_time_ms": 6483.36, "load_time_ms": 0.381, "load_throughput": 1345072.923, "learn_time_ms": 67155.506, "learn_throughput": 7.624, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608}, "done": false, "episodes_total": 288, "training_iteration": 9, "trial_id": "08022_00064", "date": "2024-02-26_21-04-16", "timestamp": 1708977856, "time_this_iter_s": 74.37534642219543, "time_total_s": 662.800897359848, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 662.800897359848, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 51.32380952380952, "ram_util_percent": 19.343809523809526}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.98, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.000625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.000625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 1.6499459544817607, "policy_loss": -0.08945843164498607, "vf_loss": 2.3059276471535366, "vf_explained_var": 0.05192852516969045, "kl": 0.0, "entropy": 98.32983207702637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.98, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.000625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.000625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.326564189990772, "mean_inference_ms": 10.53273532360901, "mean_action_processing_ms": 0.4447028849903674, "mean_env_wait_ms": 0.28433846626596987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26073122024536133, "StateBufferConnector_ms": 0.004930257797241211, "ViewRequirementAgentConnector_ms": 0.1940009593963623}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.326564189990772, "mean_inference_ms": 10.53273532360901, "mean_action_processing_ms": 0.4447028849903674, "mean_env_wait_ms": 0.28433846626596987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26073122024536133, "StateBufferConnector_ms": 0.004930257797241211, "ViewRequirementAgentConnector_ms": 0.1940009593963623}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.866687856622031, "num_agent_steps_trained_throughput_per_sec": 6.866687856622031, "timesteps_total": 5120, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 73732.125, "sample_time_ms": 6478.353, "load_time_ms": 0.37, "load_throughput": 1385473.321, "learn_time_ms": 67252.823, "learn_throughput": 7.613, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "done": false, "episodes_total": 320, "training_iteration": 10, "trial_id": "08022_00064", "date": "2024-02-26_21-05-31", "timestamp": 1708977931, "time_this_iter_s": 74.56841278076172, "time_total_s": 737.3693101406097, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 737.3693101406097, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 50.994339622641505, "ram_util_percent": 19.47452830188679}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 1.5530298878749211, "policy_loss": -0.07550595939780275, "vf_loss": 2.158949276804924, "vf_explained_var": 0.10015640904506047, "kl": 0.0, "entropy": 98.27233295440674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.329918273665184, "mean_inference_ms": 10.551361319923924, "mean_action_processing_ms": 0.4455867714907231, "mean_env_wait_ms": 0.2848835078821311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2669694423675537, "StateBufferConnector_ms": 0.004990816116333008, "ViewRequirementAgentConnector_ms": 0.2023773193359375}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.329918273665184, "mean_inference_ms": 10.551361319923924, "mean_action_processing_ms": 0.4455867714907231, "mean_env_wait_ms": 0.2848835078821311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2669694423675537, "StateBufferConnector_ms": 0.004990816116333008, "ViewRequirementAgentConnector_ms": 0.2023773193359375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.897168666133886, "num_agent_steps_trained_throughput_per_sec": 6.897168666133886, "timesteps_total": 5632, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 5632, "timers": {"training_iteration_time_ms": 73939.184, "sample_time_ms": 6520.192, "load_time_ms": 0.331, "load_throughput": 1546287.189, "learn_time_ms": 67418.076, "learn_throughput": 7.594, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632}, "done": false, "episodes_total": 352, "training_iteration": 11, "trial_id": "08022_00064", "date": "2024-02-26_21-06-45", "timestamp": 1708978005, "time_this_iter_s": 74.23884105682373, "time_total_s": 811.6081511974335, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 811.6081511974335, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 50.82285714285714, "ram_util_percent": 19.52}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 1.299610993762811, "policy_loss": -0.09560484668860833, "vf_loss": 1.8496370444695154, "vf_explained_var": 0.019741877416769662, "kl": 0.0, "entropy": 98.4780657450358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3315102836781536, "mean_inference_ms": 10.555996488436056, "mean_action_processing_ms": 0.44607446109060694, "mean_env_wait_ms": 0.28510715620668936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2647416591644287, "StateBufferConnector_ms": 0.004927635192871094, "ViewRequirementAgentConnector_ms": 0.19289922714233398}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3315102836781536, "mean_inference_ms": 10.555996488436056, "mean_action_processing_ms": 0.44607446109060694, "mean_env_wait_ms": 0.28510715620668936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2647416591644287, "StateBufferConnector_ms": 0.004927635192871094, "ViewRequirementAgentConnector_ms": 0.19289922714233398}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.870623237299792, "num_agent_steps_trained_throughput_per_sec": 6.870623237299792, "timesteps_total": 6144, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 6144, "timers": {"training_iteration_time_ms": 74026.777, "sample_time_ms": 6513.141, "load_time_ms": 0.359, "load_throughput": 1424627.602, "learn_time_ms": 67512.683, "learn_throughput": 7.584, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "done": false, "episodes_total": 384, "training_iteration": 12, "trial_id": "08022_00064", "date": "2024-02-26_21-08-00", "timestamp": 1708978080, "time_this_iter_s": 74.52542114257812, "time_total_s": 886.1335723400116, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 886.1335723400116, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 50.88584905660377, "ram_util_percent": 19.496226415094338}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 1.210696358482043, "policy_loss": -0.0977932117258509, "vf_loss": 1.7346640596787135, "vf_explained_var": 0.08252460360527039, "kl": 0.0, "entropy": 98.88814086914063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.332664607844242, "mean_inference_ms": 10.562473744995383, "mean_action_processing_ms": 0.4462544557277397, "mean_env_wait_ms": 0.28508267808518517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26341819763183594, "StateBufferConnector_ms": 0.004754066467285156, "ViewRequirementAgentConnector_ms": 0.1933426856994629}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.332664607844242, "mean_inference_ms": 10.562473744995383, "mean_action_processing_ms": 0.4462544557277397, "mean_env_wait_ms": 0.28508267808518517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26341819763183594, "StateBufferConnector_ms": 0.004754066467285156, "ViewRequirementAgentConnector_ms": 0.1933426856994629}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.967705643794022, "num_agent_steps_trained_throughput_per_sec": 6.967705643794022, "timesteps_total": 6656, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 6656, "timers": {"training_iteration_time_ms": 74038.787, "sample_time_ms": 6520.968, "load_time_ms": 0.359, "load_throughput": 1426520.292, "learn_time_ms": 67516.889, "learn_throughput": 7.583, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656}, "done": false, "episodes_total": 416, "training_iteration": 13, "trial_id": "08022_00064", "date": "2024-02-26_21-09-13", "timestamp": 1708978153, "time_this_iter_s": 73.48693180084229, "time_total_s": 959.6205041408539, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 959.6205041408539, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 50.97596153846154, "ram_util_percent": 19.347115384615385}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 1.0224785506725311, "policy_loss": -0.093409499215583, "vf_loss": 1.479332309961319, "vf_explained_var": 0.07214415272076925, "kl": 0.0, "entropy": 98.80595556894939, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.332555929567169, "mean_inference_ms": 10.564830338934126, "mean_action_processing_ms": 0.44628228520734253, "mean_env_wait_ms": 0.2850179043261361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2614614963531494, "StateBufferConnector_ms": 0.00472712516784668, "ViewRequirementAgentConnector_ms": 0.19148468971252441}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.332555929567169, "mean_inference_ms": 10.564830338934126, "mean_action_processing_ms": 0.44628228520734253, "mean_env_wait_ms": 0.2850179043261361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2614614963531494, "StateBufferConnector_ms": 0.00472712516784668, "ViewRequirementAgentConnector_ms": 0.19148468971252441}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.948629210100123, "num_agent_steps_trained_throughput_per_sec": 6.948629210100123, "timesteps_total": 7168, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 7168, "timers": {"training_iteration_time_ms": 74026.649, "sample_time_ms": 6507.082, "load_time_ms": 0.388, "load_throughput": 1320147.322, "learn_time_ms": 67518.285, "learn_throughput": 7.583, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "done": false, "episodes_total": 448, "training_iteration": 14, "trial_id": "08022_00064", "date": "2024-02-26_21-10-27", "timestamp": 1708978227, "time_this_iter_s": 73.68871426582336, "time_total_s": 1033.3092184066772, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1033.3092184066772, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 51.18666666666667, "ram_util_percent": 19.316190476190478}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.9178245887160301, "policy_loss": -0.09508444759994746, "vf_loss": 1.3428130666414897, "vf_explained_var": 0.11708643784125645, "kl": 0.0, "entropy": 98.4247538248698, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3325474838164004, "mean_inference_ms": 10.570854066167229, "mean_action_processing_ms": 0.4464032603314325, "mean_env_wait_ms": 0.28504697363273673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2629270553588867, "StateBufferConnector_ms": 0.004786968231201172, "ViewRequirementAgentConnector_ms": 0.19364476203918457}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3325474838164004, "mean_inference_ms": 10.570854066167229, "mean_action_processing_ms": 0.4464032603314325, "mean_env_wait_ms": 0.28504697363273673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2629270553588867, "StateBufferConnector_ms": 0.004786968231201172, "ViewRequirementAgentConnector_ms": 0.19364476203918457}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.8873054169866545, "num_agent_steps_trained_throughput_per_sec": 6.8873054169866545, "timesteps_total": 7680, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 7680, "timers": {"training_iteration_time_ms": 74049.994, "sample_time_ms": 6506.726, "load_time_ms": 0.384, "load_throughput": 1331772.805, "learn_time_ms": 67542.01, "learn_throughput": 7.58, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680}, "done": false, "episodes_total": 480, "training_iteration": 15, "trial_id": "08022_00064", "date": "2024-02-26_21-11-41", "timestamp": 1708978301, "time_this_iter_s": 74.34504508972168, "time_total_s": 1107.654263496399, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1107.654263496399, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 51.54, "ram_util_percent": 19.383809523809525}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.8066467759509881, "policy_loss": -0.09856914716462294, "vf_loss": 1.200044364730517, "vf_explained_var": 0.12672145515680314, "kl": 0.0, "entropy": 99.12105801900228, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3320195036148834, "mean_inference_ms": 10.570874448224778, "mean_action_processing_ms": 0.446497441277475, "mean_env_wait_ms": 0.2850795101544452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26218605041503906, "StateBufferConnector_ms": 0.0047664642333984375, "ViewRequirementAgentConnector_ms": 0.19031643867492676}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3320195036148834, "mean_inference_ms": 10.570874448224778, "mean_action_processing_ms": 0.446497441277475, "mean_env_wait_ms": 0.2850795101544452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26218605041503906, "StateBufferConnector_ms": 0.0047664642333984375, "ViewRequirementAgentConnector_ms": 0.19031643867492676}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.976027503747658, "num_agent_steps_trained_throughput_per_sec": 6.976027503747658, "timesteps_total": 8192, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 74003.018, "sample_time_ms": 6477.341, "load_time_ms": 0.383, "load_throughput": 1338079.412, "learn_time_ms": 67524.435, "learn_throughput": 7.582, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "done": false, "episodes_total": 512, "training_iteration": 16, "trial_id": "08022_00064", "date": "2024-02-26_21-12-55", "timestamp": 1708978375, "time_this_iter_s": 73.39946794509888, "time_total_s": 1181.0537314414978, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1181.0537314414978, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 52.083809523809514, "ram_util_percent": 19.34190476190476}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.7151405019064744, "policy_loss": -0.08958874984333913, "vf_loss": 1.0668292433023452, "vf_explained_var": 0.10338612447182337, "kl": 0.0, "entropy": 98.83141021728515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.331123658094088, "mean_inference_ms": 10.565535760966943, "mean_action_processing_ms": 0.44617404287398016, "mean_env_wait_ms": 0.28481643529055484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25920677185058594, "StateBufferConnector_ms": 0.004785776138305664, "ViewRequirementAgentConnector_ms": 0.18368220329284668}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.331123658094088, "mean_inference_ms": 10.565535760966943, "mean_action_processing_ms": 0.44617404287398016, "mean_env_wait_ms": 0.28481643529055484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25920677185058594, "StateBufferConnector_ms": 0.004785776138305664, "ViewRequirementAgentConnector_ms": 0.18368220329284668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.007356759286453, "num_agent_steps_trained_throughput_per_sec": 7.007356759286453, "timesteps_total": 8704, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8704, "timers": {"training_iteration_time_ms": 73939.414, "sample_time_ms": 6487.705, "load_time_ms": 0.382, "load_throughput": 1341841.82, "learn_time_ms": 67450.466, "learn_throughput": 7.591, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704}, "done": false, "episodes_total": 544, "training_iteration": 17, "trial_id": "08022_00064", "date": "2024-02-26_21-14-08", "timestamp": 1708978448, "time_this_iter_s": 73.07126092910767, "time_total_s": 1254.1249923706055, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1254.1249923706055, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 51.03009708737864, "ram_util_percent": 19.378640776699033}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.7342569145063559, "policy_loss": -0.09781659267221889, "vf_loss": 1.1030794809261957, "vf_explained_var": 0.14976309686899186, "kl": 0.0, "entropy": 99.06228872934977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3299560895985207, "mean_inference_ms": 10.55735804823665, "mean_action_processing_ms": 0.4457133849092014, "mean_env_wait_ms": 0.28447088480966465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25893664360046387, "StateBufferConnector_ms": 0.004782915115356445, "ViewRequirementAgentConnector_ms": 0.18348145484924316}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3299560895985207, "mean_inference_ms": 10.55735804823665, "mean_action_processing_ms": 0.4457133849092014, "mean_env_wait_ms": 0.28447088480966465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25893664360046387, "StateBufferConnector_ms": 0.004782915115356445, "ViewRequirementAgentConnector_ms": 0.18348145484924316}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.953798442965482, "num_agent_steps_trained_throughput_per_sec": 6.953798442965482, "timesteps_total": 9216, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 9216, "timers": {"training_iteration_time_ms": 73928.054, "sample_time_ms": 6507.688, "load_time_ms": 0.385, "load_throughput": 1331442.525, "learn_time_ms": 67419.118, "learn_throughput": 7.594, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "done": false, "episodes_total": 576, "training_iteration": 18, "trial_id": "08022_00064", "date": "2024-02-26_21-15-22", "timestamp": 1708978522, "time_this_iter_s": 73.63386631011963, "time_total_s": 1327.758858680725, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1327.758858680725, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 51.24761904761905, "ram_util_percent": 19.375238095238096}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.6028726389010747, "policy_loss": -0.09320528569320838, "vf_loss": 0.9227901975313823, "vf_explained_var": 0.14393739700317382, "kl": 0.0, "entropy": 98.42262179056803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.329603285514048, "mean_inference_ms": 10.554045351959035, "mean_action_processing_ms": 0.44548927684064277, "mean_env_wait_ms": 0.28440492515940474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26201486587524414, "StateBufferConnector_ms": 0.004805088043212891, "ViewRequirementAgentConnector_ms": 0.18777084350585938}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.329603285514048, "mean_inference_ms": 10.554045351959035, "mean_action_processing_ms": 0.44548927684064277, "mean_env_wait_ms": 0.28440492515940474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26201486587524414, "StateBufferConnector_ms": 0.004805088043212891, "ViewRequirementAgentConnector_ms": 0.18777084350585938}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.95166023711159, "num_agent_steps_trained_throughput_per_sec": 6.95166023711159, "timesteps_total": 9728, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 9728, "timers": {"training_iteration_time_ms": 73856.175, "sample_time_ms": 6486.381, "load_time_ms": 0.379, "load_throughput": 1352234.524, "learn_time_ms": 67368.556, "learn_throughput": 7.6, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728}, "done": false, "episodes_total": 608, "training_iteration": 19, "trial_id": "08022_00064", "date": "2024-02-26_21-16-35", "timestamp": 1708978595, "time_this_iter_s": 73.65652251243591, "time_total_s": 1401.415381193161, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1401.415381193161, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 51.002884615384616, "ram_util_percent": 19.26826923076923}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.7302276566624641, "policy_loss": -0.08633202069128552, "vf_loss": 1.0825128115713596, "vf_explained_var": 0.1166949987411499, "kl": 0.0, "entropy": 98.68490962982177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.329774720379589, "mean_inference_ms": 10.554923383467507, "mean_action_processing_ms": 0.44552297296766985, "mean_env_wait_ms": 0.28451525432138625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26358652114868164, "StateBufferConnector_ms": 0.004826784133911133, "ViewRequirementAgentConnector_ms": 0.1919419765472412}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.329774720379589, "mean_inference_ms": 10.554923383467507, "mean_action_processing_ms": 0.44552297296766985, "mean_env_wait_ms": 0.28451525432138625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26358652114868164, "StateBufferConnector_ms": 0.004826784133911133, "ViewRequirementAgentConnector_ms": 0.1919419765472412}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.026987965493682, "num_agent_steps_trained_throughput_per_sec": 7.026987965493682, "timesteps_total": 10240, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 10240, "timers": {"training_iteration_time_ms": 73686.083, "sample_time_ms": 6489.086, "load_time_ms": 0.378, "load_throughput": 1354452.001, "learn_time_ms": 67195.777, "learn_throughput": 7.62, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "done": false, "episodes_total": 640, "training_iteration": 20, "trial_id": "08022_00064", "date": "2024-02-26_21-17-48", "timestamp": 1708978668, "time_this_iter_s": 72.86717391014099, "time_total_s": 1474.282555103302, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1474.282555103302, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 51.11067961165048, "ram_util_percent": 19.14368932038835}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.529980123663942, "policy_loss": -0.10451127983008822, "vf_loss": 0.8411449829737345, "vf_explained_var": 0.18405189365148544, "kl": 0.0, "entropy": 98.90770956675212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3299587024773565, "mean_inference_ms": 10.560306343747095, "mean_action_processing_ms": 0.44553394229128057, "mean_env_wait_ms": 0.28474265663907167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26416492462158203, "StateBufferConnector_ms": 0.00486302375793457, "ViewRequirementAgentConnector_ms": 0.1916055679321289}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3299587024773565, "mean_inference_ms": 10.560306343747095, "mean_action_processing_ms": 0.44553394229128057, "mean_env_wait_ms": 0.28474265663907167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26416492462158203, "StateBufferConnector_ms": 0.00486302375793457, "ViewRequirementAgentConnector_ms": 0.1916055679321289}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.924762471341463, "num_agent_steps_trained_throughput_per_sec": 6.924762471341463, "timesteps_total": 10752, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 73656.503, "sample_time_ms": 6492.221, "load_time_ms": 0.343, "load_throughput": 1492655.625, "learn_time_ms": 67163.133, "learn_throughput": 7.623, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "done": false, "episodes_total": 672, "training_iteration": 21, "trial_id": "08022_00064", "date": "2024-02-26_21-19-02", "timestamp": 1708978742, "time_this_iter_s": 73.94256830215454, "time_total_s": 1548.2251234054565, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1548.2251234054565, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 51.114285714285714, "ram_util_percent": 19.175238095238093}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.4622473863263925, "policy_loss": -0.08263479229062795, "vf_loss": 0.7223500788211823, "vf_explained_var": 0.10345897028843562, "kl": 0.0, "entropy": 98.36660607655843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3298158054942701, "mean_inference_ms": 10.5619030939679, "mean_action_processing_ms": 0.4454526194641308, "mean_env_wait_ms": 0.28492084204913914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26132655143737793, "StateBufferConnector_ms": 0.00481104850769043, "ViewRequirementAgentConnector_ms": 0.19037222862243652}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3298158054942701, "mean_inference_ms": 10.5619030939679, "mean_action_processing_ms": 0.4454526194641308, "mean_env_wait_ms": 0.28492084204913914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26132655143737793, "StateBufferConnector_ms": 0.00481104850769043, "ViewRequirementAgentConnector_ms": 0.19037222862243652}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.011835268098167, "num_agent_steps_trained_throughput_per_sec": 7.011835268098167, "timesteps_total": 11264, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 11264, "timers": {"training_iteration_time_ms": 73506.426, "sample_time_ms": 6483.029, "load_time_ms": 0.314, "load_throughput": 1630587.432, "learn_time_ms": 67022.276, "learn_throughput": 7.639, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "done": false, "episodes_total": 704, "training_iteration": 22, "trial_id": "08022_00064", "date": "2024-02-26_21-20-15", "timestamp": 1708978815, "time_this_iter_s": 73.02455735206604, "time_total_s": 1621.2496807575226, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1621.2496807575226, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 51.48846153846153, "ram_util_percent": 19.132692307692306}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.98, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.000625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.000625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.38930380896975597, "policy_loss": -0.08716375498721997, "vf_loss": 0.6316528392334779, "vf_explained_var": 0.1075540840625763, "kl": 0.0, "entropy": 97.83015473683675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.98, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.000625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.000625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3296648881062592, "mean_inference_ms": 10.56274114728566, "mean_action_processing_ms": 0.4454702418481007, "mean_env_wait_ms": 0.2851462933967274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26229166984558105, "StateBufferConnector_ms": 0.004793405532836914, "ViewRequirementAgentConnector_ms": 0.18981266021728516}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3296648881062592, "mean_inference_ms": 10.56274114728566, "mean_action_processing_ms": 0.4454702418481007, "mean_env_wait_ms": 0.2851462933967274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26229166984558105, "StateBufferConnector_ms": 0.004793405532836914, "ViewRequirementAgentConnector_ms": 0.18981266021728516}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.874704507104039, "num_agent_steps_trained_throughput_per_sec": 6.874704507104039, "timesteps_total": 11776, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 11776, "timers": {"training_iteration_time_ms": 73605.832, "sample_time_ms": 6477.423, "load_time_ms": 0.316, "load_throughput": 1619886.587, "learn_time_ms": 67127.272, "learn_throughput": 7.627, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776}, "done": false, "episodes_total": 736, "training_iteration": 23, "trial_id": "08022_00064", "date": "2024-02-26_21-21-30", "timestamp": 1708978890, "time_this_iter_s": 74.48117089271545, "time_total_s": 1695.730851650238, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1695.730851650238, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 51.65904761904762, "ram_util_percent": 19.15238095238095}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 1.1513311088085174, "policy_loss": -0.0702303273913761, "vf_loss": 1.6194234862923622, "vf_explained_var": 0.10362959802150726, "kl": 0.0, "entropy": 98.09546693166097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3294479958660483, "mean_inference_ms": 10.55903252852736, "mean_action_processing_ms": 0.44541972511786293, "mean_env_wait_ms": 0.2852362961873661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26181697845458984, "StateBufferConnector_ms": 0.004782199859619141, "ViewRequirementAgentConnector_ms": 0.19062304496765137}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3294479958660483, "mean_inference_ms": 10.55903252852736, "mean_action_processing_ms": 0.44541972511786293, "mean_env_wait_ms": 0.2852362961873661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26181697845458984, "StateBufferConnector_ms": 0.004782199859619141, "ViewRequirementAgentConnector_ms": 0.19062304496765137}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.961828736658652, "num_agent_steps_trained_throughput_per_sec": 6.961828736658652, "timesteps_total": 12288, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12288, "timers": {"training_iteration_time_ms": 73591.862, "sample_time_ms": 6472.805, "load_time_ms": 0.287, "load_throughput": 1786740.701, "learn_time_ms": 67118.281, "learn_throughput": 7.628, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "done": false, "episodes_total": 768, "training_iteration": 24, "trial_id": "08022_00064", "date": "2024-02-26_21-22-43", "timestamp": 1708978963, "time_this_iter_s": 73.54899001121521, "time_total_s": 1769.2798416614532, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1769.2798416614532, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 51.56190476190476, "ram_util_percent": 19.225714285714282}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.458488272006313, "policy_loss": -0.09154625274240971, "vf_loss": 0.7291805366675059, "vf_explained_var": 0.11251535018285115, "kl": 0.0, "entropy": 97.16809253692627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3296380205656688, "mean_inference_ms": 10.55784364052379, "mean_action_processing_ms": 0.4455040000421626, "mean_env_wait_ms": 0.285343230431089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26303958892822266, "StateBufferConnector_ms": 0.004813194274902344, "ViewRequirementAgentConnector_ms": 0.19323253631591797}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3296380205656688, "mean_inference_ms": 10.55784364052379, "mean_action_processing_ms": 0.4455040000421626, "mean_env_wait_ms": 0.285343230431089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26303958892822266, "StateBufferConnector_ms": 0.004813194274902344, "ViewRequirementAgentConnector_ms": 0.19323253631591797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.011866336242588, "num_agent_steps_trained_throughput_per_sec": 7.011866336242588, "timesteps_total": 12800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12800, "timers": {"training_iteration_time_ms": 73459.804, "sample_time_ms": 6465.814, "load_time_ms": 0.286, "load_throughput": 1790912.891, "learn_time_ms": 66993.213, "learn_throughput": 7.643, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "done": false, "episodes_total": 800, "training_iteration": 25, "trial_id": "08022_00064", "date": "2024-02-26_21-23-57", "timestamp": 1708979037, "time_this_iter_s": 73.02419137954712, "time_total_s": 1842.3040330410004, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1842.3040330410004, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 50.86601941747573, "ram_util_percent": 19.24077669902913}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.8, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00625, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.3505540331825614, "policy_loss": -0.10007382469872633, "vf_loss": 0.5973971600333849, "vf_explained_var": 0.04769625266393026, "kl": 0.0, "entropy": 97.51496645609538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.8, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.8, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00625, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3297275893416873, "mean_inference_ms": 10.557043054789247, "mean_action_processing_ms": 0.4455422553529732, "mean_env_wait_ms": 0.28546575977670835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26396775245666504, "StateBufferConnector_ms": 0.004819631576538086, "ViewRequirementAgentConnector_ms": 0.1956186294555664}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.8, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3297275893416873, "mean_inference_ms": 10.557043054789247, "mean_action_processing_ms": 0.4455422553529732, "mean_env_wait_ms": 0.28546575977670835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26396775245666504, "StateBufferConnector_ms": 0.004819631576538086, "ViewRequirementAgentConnector_ms": 0.1956186294555664}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.953782163070021, "num_agent_steps_trained_throughput_per_sec": 6.953782163070021, "timesteps_total": 13312, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 13312, "timers": {"training_iteration_time_ms": 73483.281, "sample_time_ms": 6475.361, "load_time_ms": 0.279, "load_throughput": 1832480.287, "learn_time_ms": 67007.146, "learn_throughput": 7.641, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "done": false, "episodes_total": 832, "training_iteration": 26, "trial_id": "08022_00064", "date": "2024-02-26_21-25-10", "timestamp": 1708979110, "time_this_iter_s": 73.63432574272156, "time_total_s": 1915.938358783722, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1915.938358783722, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 51.285714285714285, "ram_util_percent": 19.20952380952381}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.18464744001006086, "policy_loss": -0.10950909952322642, "vf_loss": 0.3899631987015406, "vf_explained_var": 0.11135990122954051, "kl": 0.0, "entropy": 97.3948813756307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3304490660274493, "mean_inference_ms": 10.560829659433104, "mean_action_processing_ms": 0.4458114391040546, "mean_env_wait_ms": 0.2857298857125243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2671821117401123, "StateBufferConnector_ms": 0.004938840866088867, "ViewRequirementAgentConnector_ms": 0.20318984985351562}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3304490660274493, "mean_inference_ms": 10.560829659433104, "mean_action_processing_ms": 0.4458114391040546, "mean_env_wait_ms": 0.2857298857125243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2671821117401123, "StateBufferConnector_ms": 0.004938840866088867, "ViewRequirementAgentConnector_ms": 0.20318984985351562}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.011949056233285, "num_agent_steps_trained_throughput_per_sec": 7.011949056233285, "timesteps_total": 13824, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 13824, "timers": {"training_iteration_time_ms": 73478.496, "sample_time_ms": 6511.862, "load_time_ms": 0.279, "load_throughput": 1837969.572, "learn_time_ms": 66965.867, "learn_throughput": 7.646, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824}, "done": false, "episodes_total": 864, "training_iteration": 27, "trial_id": "08022_00064", "date": "2024-02-26_21-26-23", "timestamp": 1708979183, "time_this_iter_s": 73.0234625339508, "time_total_s": 1988.9618213176727, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1988.9618213176727, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 51.243689320388356, "ram_util_percent": 19.361165048543693}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.303855223612239, "policy_loss": -0.08757738390316566, "vf_loss": 0.5189220381279787, "vf_explained_var": 0.19466040035088858, "kl": 0.0, "entropy": 97.52900816599528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3308074702462178, "mean_inference_ms": 10.562887159458155, "mean_action_processing_ms": 0.44596095923828794, "mean_env_wait_ms": 0.2858885366653088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2637825012207031, "StateBufferConnector_ms": 0.004901409149169922, "ViewRequirementAgentConnector_ms": 0.1944272518157959}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3308074702462178, "mean_inference_ms": 10.562887159458155, "mean_action_processing_ms": 0.44596095923828794, "mean_env_wait_ms": 0.2858885366653088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2637825012207031, "StateBufferConnector_ms": 0.004901409149169922, "ViewRequirementAgentConnector_ms": 0.1944272518157959}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.981048731845864, "num_agent_steps_trained_throughput_per_sec": 6.981048731845864, "timesteps_total": 14336, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 14336, "timers": {"training_iteration_time_ms": 73449.753, "sample_time_ms": 6504.51, "load_time_ms": 0.274, "load_throughput": 1867539.48, "learn_time_ms": 66944.472, "learn_throughput": 7.648, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "done": false, "episodes_total": 896, "training_iteration": 28, "trial_id": "08022_00064", "date": "2024-02-26_21-27-37", "timestamp": 1708979257, "time_this_iter_s": 73.34677791595459, "time_total_s": 2062.3085992336273, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2062.3085992336273, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 50.99423076923077, "ram_util_percent": 19.51730769230769}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.98, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.000625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.000625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.3003942693583667, "policy_loss": -0.08762250918274124, "vf_loss": 0.514393684019645, "vf_explained_var": 0.2717320129275322, "kl": 0.0, "entropy": 97.48505643208821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.98, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.000625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.000625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3308436516684898, "mean_inference_ms": 10.562617390479815, "mean_action_processing_ms": 0.4459988978284569, "mean_env_wait_ms": 0.2859285789297388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2613086700439453, "StateBufferConnector_ms": 0.005071163177490234, "ViewRequirementAgentConnector_ms": 0.1892075538635254}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3308436516684898, "mean_inference_ms": 10.562617390479815, "mean_action_processing_ms": 0.4459988978284569, "mean_env_wait_ms": 0.2859285789297388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2613086700439453, "StateBufferConnector_ms": 0.005071163177490234, "ViewRequirementAgentConnector_ms": 0.1892075538635254}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.066885784464502, "num_agent_steps_trained_throughput_per_sec": 7.066885784464502, "timesteps_total": 14848, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 14848, "timers": {"training_iteration_time_ms": 73329.665, "sample_time_ms": 6483.485, "load_time_ms": 0.277, "load_throughput": 1851119.428, "learn_time_ms": 66845.41, "learn_throughput": 7.659, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848}, "done": false, "episodes_total": 928, "training_iteration": 29, "trial_id": "08022_00064", "date": "2024-02-26_21-28-49", "timestamp": 1708979329, "time_this_iter_s": 72.45557427406311, "time_total_s": 2134.7641735076904, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2134.7641735076904, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 51.208737864077676, "ram_util_percent": 19.645631067961162}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.15132882765804728, "policy_loss": -0.10998315596953034, "vf_loss": 0.346421184639136, "vf_explained_var": 0.24940532098213833, "kl": 0.0, "entropy": 96.7841090520223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.330190443003693, "mean_inference_ms": 10.558558601956493, "mean_action_processing_ms": 0.445844229336357, "mean_env_wait_ms": 0.2858034055148518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25885701179504395, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.18328309059143066}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.330190443003693, "mean_inference_ms": 10.558558601956493, "mean_action_processing_ms": 0.445844229336357, "mean_env_wait_ms": 0.2858034055148518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25885701179504395, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.18328309059143066}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.037187409523528, "num_agent_steps_trained_throughput_per_sec": 7.037187409523528, "timesteps_total": 15360, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 15360, "timers": {"training_iteration_time_ms": 73319.104, "sample_time_ms": 6482.077, "load_time_ms": 0.279, "load_throughput": 1832323.932, "learn_time_ms": 66836.253, "learn_throughput": 7.661, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "done": false, "episodes_total": 960, "training_iteration": 30, "trial_id": "08022_00064", "date": "2024-02-26_21-30-02", "timestamp": 1708979402, "time_this_iter_s": 72.76141715049744, "time_total_s": 2207.525590658188, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2207.525590658188, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 51.83883495145631, "ram_util_percent": 19.54466019417476}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.6893066132130722, "policy_loss": -0.06001380185286204, "vf_loss": 0.993373753875494, "vf_explained_var": 0.41713200211524964, "kl": 0.0, "entropy": 96.95780111948649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3293976181928608, "mean_inference_ms": 10.554371284894337, "mean_action_processing_ms": 0.4456523564230295, "mean_env_wait_ms": 0.2856496856579017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2582740783691406, "StateBufferConnector_ms": 0.004954099655151367, "ViewRequirementAgentConnector_ms": 0.18391180038452148}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3293976181928608, "mean_inference_ms": 10.554371284894337, "mean_action_processing_ms": 0.4456523564230295, "mean_env_wait_ms": 0.2856496856579017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2582740783691406, "StateBufferConnector_ms": 0.004954099655151367, "ViewRequirementAgentConnector_ms": 0.18391180038452148}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872, "num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.041608204205268, "num_agent_steps_trained_throughput_per_sec": 7.041608204205268, "timesteps_total": 15872, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 15872, "timers": {"training_iteration_time_ms": 73196.415, "sample_time_ms": 6461.992, "load_time_ms": 0.282, "load_throughput": 1816975.758, "learn_time_ms": 66733.623, "learn_throughput": 7.672, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872}, "done": false, "episodes_total": 992, "training_iteration": 31, "trial_id": "08022_00064", "date": "2024-02-26_21-31-15", "timestamp": 1708979475, "time_this_iter_s": 72.71606707572937, "time_total_s": 2280.2416577339172, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2280.2416577339172, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 51.55436893203884, "ram_util_percent": 19.640776699029125}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.589036665763706, "policy_loss": -0.0946142596192658, "vf_loss": 0.9063157272835572, "vf_explained_var": 0.31297987202803296, "kl": 0.0, "entropy": 97.10612068176269, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3290476903614974, "mean_inference_ms": 10.553265418329131, "mean_action_processing_ms": 0.44558937918742986, "mean_env_wait_ms": 0.2855712602937694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2646334171295166, "StateBufferConnector_ms": 0.004817008972167969, "ViewRequirementAgentConnector_ms": 0.18711161613464355}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3290476903614974, "mean_inference_ms": 10.553265418329131, "mean_action_processing_ms": 0.44558937918742986, "mean_env_wait_ms": 0.2855712602937694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2646334171295166, "StateBufferConnector_ms": 0.004817008972167969, "ViewRequirementAgentConnector_ms": 0.18711161613464355}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.075073416264961, "num_agent_steps_trained_throughput_per_sec": 7.075073416264961, "timesteps_total": 16384, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 73131.149, "sample_time_ms": 6472.707, "load_time_ms": 0.284, "load_throughput": 1802941.523, "learn_time_ms": 66657.656, "learn_throughput": 7.681, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "done": false, "episodes_total": 1024, "training_iteration": 32, "trial_id": "08022_00064", "date": "2024-02-26_21-32-27", "timestamp": 1708979547, "time_this_iter_s": 72.37178778648376, "time_total_s": 2352.613445520401, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2352.613445520401, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 51.363106796116504, "ram_util_percent": 19.736893203883493}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5997257038019598, "policy_loss": -0.09214016658564408, "vf_loss": 0.9172062840312719, "vf_explained_var": 0.36338520993789036, "kl": 0.0, "entropy": 97.5965399424235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3288060082679394, "mean_inference_ms": 10.552948191303454, "mean_action_processing_ms": 0.4455118342530719, "mean_env_wait_ms": 0.28550246784838684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2655932903289795, "StateBufferConnector_ms": 0.004861354827880859, "ViewRequirementAgentConnector_ms": 0.18764281272888184}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3288060082679394, "mean_inference_ms": 10.552948191303454, "mean_action_processing_ms": 0.4455118342530719, "mean_env_wait_ms": 0.28550246784838684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2655932903289795, "StateBufferConnector_ms": 0.004861354827880859, "ViewRequirementAgentConnector_ms": 0.18764281272888184}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896, "num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.037730963989782, "num_agent_steps_trained_throughput_per_sec": 7.037730963989782, "timesteps_total": 16896, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16896, "timers": {"training_iteration_time_ms": 72958.628, "sample_time_ms": 6474.818, "load_time_ms": 0.285, "load_throughput": 1795705.032, "learn_time_ms": 66483.024, "learn_throughput": 7.701, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896}, "done": false, "episodes_total": 1056, "training_iteration": 33, "trial_id": "08022_00064", "date": "2024-02-26_21-33-40", "timestamp": 1708979620, "time_this_iter_s": 72.7557806968689, "time_total_s": 2425.36922621727, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2425.36922621727, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 51.17961165048543, "ram_util_percent": 19.72718446601942}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5649908483338852, "policy_loss": -0.09398294780403375, "vf_loss": 0.8736012774209182, "vf_explained_var": 0.17359511653582255, "kl": 0.0, "entropy": 97.58338851928711, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3287617985360152, "mean_inference_ms": 10.553488726547823, "mean_action_processing_ms": 0.4455071244544866, "mean_env_wait_ms": 0.2854835568976655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2679450511932373, "StateBufferConnector_ms": 0.004857540130615234, "ViewRequirementAgentConnector_ms": 0.18972015380859375}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3287617985360152, "mean_inference_ms": 10.553488726547823, "mean_action_processing_ms": 0.4455071244544866, "mean_env_wait_ms": 0.2854835568976655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2679450511932373, "StateBufferConnector_ms": 0.004857540130615234, "ViewRequirementAgentConnector_ms": 0.18972015380859375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.064587048698407, "num_agent_steps_trained_throughput_per_sec": 7.064587048698407, "timesteps_total": 17408, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 17408, "timers": {"training_iteration_time_ms": 72851.654, "sample_time_ms": 6479.416, "load_time_ms": 0.281, "load_throughput": 1823455.59, "learn_time_ms": 66371.453, "learn_throughput": 7.714, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "done": false, "episodes_total": 1088, "training_iteration": 34, "trial_id": "08022_00064", "date": "2024-02-26_21-34-53", "timestamp": 1708979693, "time_this_iter_s": 72.47946381568909, "time_total_s": 2497.848690032959, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2497.848690032959, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 51.42135922330097, "ram_util_percent": 20.058252427184467}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5354549571250876, "policy_loss": -0.10555868664135536, "vf_loss": 0.8497915261735519, "vf_explained_var": 0.3909154588977496, "kl": 0.0, "entropy": 97.18344097137451, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3289883114425587, "mean_inference_ms": 10.555300944527323, "mean_action_processing_ms": 0.44550203152718654, "mean_env_wait_ms": 0.28548642795499257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2652301788330078, "StateBufferConnector_ms": 0.004892826080322266, "ViewRequirementAgentConnector_ms": 0.19438958168029785}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3289883114425587, "mean_inference_ms": 10.555300944527323, "mean_action_processing_ms": 0.44550203152718654, "mean_env_wait_ms": 0.28548642795499257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2652301788330078, "StateBufferConnector_ms": 0.004892826080322266, "ViewRequirementAgentConnector_ms": 0.19438958168029785}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.006526341052828, "num_agent_steps_trained_throughput_per_sec": 7.006526341052828, "timesteps_total": 17920, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 17920, "timers": {"training_iteration_time_ms": 72857.217, "sample_time_ms": 6484.288, "load_time_ms": 0.284, "load_throughput": 1802185.002, "learn_time_ms": 66372.122, "learn_throughput": 7.714, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920}, "done": false, "episodes_total": 1120, "training_iteration": 35, "trial_id": "08022_00064", "date": "2024-02-26_21-36-06", "timestamp": 1708979766, "time_this_iter_s": 73.08031368255615, "time_total_s": 2570.929003715515, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2570.929003715515, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 51.67087378640777, "ram_util_percent": 20.12718446601942}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5687949626706541, "policy_loss": -0.09737377210209767, "vf_loss": 0.8831396027157704, "vf_explained_var": 0.3091144601504008, "kl": 0.0, "entropy": 97.34308535257975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3292109841578659, "mean_inference_ms": 10.556578859104196, "mean_action_processing_ms": 0.44555953503191126, "mean_env_wait_ms": 0.2855157647921029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2645609378814697, "StateBufferConnector_ms": 0.004842281341552734, "ViewRequirementAgentConnector_ms": 0.19456696510314941}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3292109841578659, "mean_inference_ms": 10.556578859104196, "mean_action_processing_ms": 0.44555953503191126, "mean_env_wait_ms": 0.2855157647921029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2645609378814697, "StateBufferConnector_ms": 0.004842281341552734, "ViewRequirementAgentConnector_ms": 0.19456696510314941}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.051561899196605, "num_agent_steps_trained_throughput_per_sec": 7.051561899196605, "timesteps_total": 18432, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 18432, "timers": {"training_iteration_time_ms": 72755.121, "sample_time_ms": 6485.007, "load_time_ms": 0.286, "load_throughput": 1790614.232, "learn_time_ms": 66269.308, "learn_throughput": 7.726, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "done": false, "episodes_total": 1152, "training_iteration": 36, "trial_id": "08022_00064", "date": "2024-02-26_21-37-18", "timestamp": 1708979838, "time_this_iter_s": 72.61329865455627, "time_total_s": 2643.5423023700714, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2643.5423023700714, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 51.84368932038836, "ram_util_percent": 20.149514563106788}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5682329321590562, "policy_loss": -0.0948760938209792, "vf_loss": 0.8790833542744318, "vf_explained_var": 0.4575163652499517, "kl": 0.0, "entropy": 97.66882076263428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3289934468312716, "mean_inference_ms": 10.55545600107609, "mean_action_processing_ms": 0.44544905454895917, "mean_env_wait_ms": 0.28542298093562807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25970911979675293, "StateBufferConnector_ms": 0.004782676696777344, "ViewRequirementAgentConnector_ms": 0.18683338165283203}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3289934468312716, "mean_inference_ms": 10.55545600107609, "mean_action_processing_ms": 0.44544905454895917, "mean_env_wait_ms": 0.28542298093562807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25970911979675293, "StateBufferConnector_ms": 0.004782676696777344, "ViewRequirementAgentConnector_ms": 0.18683338165283203}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944, "num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.029222305144219, "num_agent_steps_trained_throughput_per_sec": 7.029222305144219, "timesteps_total": 18944, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 18944, "timers": {"training_iteration_time_ms": 72737.178, "sample_time_ms": 6447.149, "load_time_ms": 0.281, "load_throughput": 1820518.522, "learn_time_ms": 66289.229, "learn_throughput": 7.724, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944}, "done": false, "episodes_total": 1184, "training_iteration": 37, "trial_id": "08022_00064", "date": "2024-02-26_21-38-31", "timestamp": 1708979911, "time_this_iter_s": 72.8440625667572, "time_total_s": 2716.3863649368286, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2716.3863649368286, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 51.260576923076925, "ram_util_percent": 20.184615384615388}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.82, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005625, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.554118224636962, "policy_loss": -0.10511984198043743, "vf_loss": 0.8739516228437424, "vf_explained_var": 0.5525002896785736, "kl": 0.0, "entropy": 97.6739112854004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.82, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.82, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005625, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3282387553682395, "mean_inference_ms": 10.55153889877729, "mean_action_processing_ms": 0.4452242899905683, "mean_env_wait_ms": 0.28523022863594394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2561001777648926, "StateBufferConnector_ms": 0.004692792892456055, "ViewRequirementAgentConnector_ms": 0.1794145107269287}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.82, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3282387553682395, "mean_inference_ms": 10.55153889877729, "mean_action_processing_ms": 0.4452242899905683, "mean_env_wait_ms": 0.28523022863594394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2561001777648926, "StateBufferConnector_ms": 0.004692792892456055, "ViewRequirementAgentConnector_ms": 0.1794145107269287}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.994687426861599, "num_agent_steps_trained_throughput_per_sec": 6.994687426861599, "timesteps_total": 19456, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 19456, "timers": {"training_iteration_time_ms": 72722.877, "sample_time_ms": 6439.993, "load_time_ms": 0.283, "load_throughput": 1807798.34, "learn_time_ms": 66282.08, "learn_throughput": 7.725, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "done": false, "episodes_total": 1216, "training_iteration": 38, "trial_id": "08022_00064", "date": "2024-02-26_21-39-44", "timestamp": 1708979984, "time_this_iter_s": 73.20372176170349, "time_total_s": 2789.590086698532, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2789.590086698532, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 51.51442307692308, "ram_util_percent": 20.114423076923075}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.8, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5959236825505893, "policy_loss": -0.10117275475834807, "vf_loss": 0.9241404514759779, "vf_explained_var": 0.49747936328252157, "kl": 0.0, "entropy": 97.28701540629069, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.8, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.8, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.327522719497609, "mean_inference_ms": 10.547774216723637, "mean_action_processing_ms": 0.4449860935905737, "mean_env_wait_ms": 0.2850255287716742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2574281692504883, "StateBufferConnector_ms": 0.004762411117553711, "ViewRequirementAgentConnector_ms": 0.17875051498413086}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.8, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.327522719497609, "mean_inference_ms": 10.547774216723637, "mean_action_processing_ms": 0.4449860935905737, "mean_env_wait_ms": 0.2850255287716742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2574281692504883, "StateBufferConnector_ms": 0.004762411117553711, "ViewRequirementAgentConnector_ms": 0.17875051498413086}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968, "num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.98692200267955, "num_agent_steps_trained_throughput_per_sec": 6.98692200267955, "timesteps_total": 19968, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 19968, "timers": {"training_iteration_time_ms": 72805.795, "sample_time_ms": 6454.55, "load_time_ms": 0.284, "load_throughput": 1804153.279, "learn_time_ms": 66350.432, "learn_throughput": 7.717, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968}, "done": false, "episodes_total": 1248, "training_iteration": 39, "trial_id": "08022_00064", "date": "2024-02-26_21-40-58", "timestamp": 1708980058, "time_this_iter_s": 73.28526663780212, "time_total_s": 2862.8753533363342, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2862.8753533363342, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 51.41923076923077, "ram_util_percent": 19.720192307692308}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5584259804027776, "policy_loss": -0.10099865403026342, "vf_loss": 0.874198957408468, "vf_explained_var": 0.1839216247200966, "kl": 0.0, "entropy": 97.75460955301921, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3273267332366843, "mean_inference_ms": 10.546629644441243, "mean_action_processing_ms": 0.44490965120980036, "mean_env_wait_ms": 0.2849473094096833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.260861873626709, "StateBufferConnector_ms": 0.004873991012573242, "ViewRequirementAgentConnector_ms": 0.18462014198303223}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3273267332366843, "mean_inference_ms": 10.546629644441243, "mean_action_processing_ms": 0.44490965120980036, "mean_env_wait_ms": 0.2849473094096833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.260861873626709, "StateBufferConnector_ms": 0.004873991012573242, "ViewRequirementAgentConnector_ms": 0.18462014198303223}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.04528229165097, "num_agent_steps_trained_throughput_per_sec": 7.04528229165097, "timesteps_total": 20480, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 72797.436, "sample_time_ms": 6463.14, "load_time_ms": 0.313, "load_throughput": 1633688.587, "learn_time_ms": 66333.452, "learn_throughput": 7.719, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "done": false, "episodes_total": 1280, "training_iteration": 40, "trial_id": "08022_00064", "date": "2024-02-26_21-42-11", "timestamp": 1708980131, "time_this_iter_s": 72.67783689498901, "time_total_s": 2935.5531902313232, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2935.5531902313232, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 52.24563106796116, "ram_util_percent": 19.55728155339806}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5131832973721127, "policy_loss": -0.10792056238278747, "vf_loss": 0.823397126669685, "vf_explained_var": 0.4179672166705132, "kl": 0.0, "entropy": 97.838707224528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.327400056893542, "mean_inference_ms": 10.546848961582171, "mean_action_processing_ms": 0.4449365311912505, "mean_env_wait_ms": 0.28499100572277886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.263669490814209, "StateBufferConnector_ms": 0.0049746036529541016, "ViewRequirementAgentConnector_ms": 0.19022607803344727}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.327400056893542, "mean_inference_ms": 10.546848961582171, "mean_action_processing_ms": 0.4449365311912505, "mean_env_wait_ms": 0.28499100572277886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.263669490814209, "StateBufferConnector_ms": 0.0049746036529541016, "ViewRequirementAgentConnector_ms": 0.19022607803344727}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992, "num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.038214488760068, "num_agent_steps_trained_throughput_per_sec": 7.038214488760068, "timesteps_total": 20992, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 20992, "timers": {"training_iteration_time_ms": 72800.942, "sample_time_ms": 6465.797, "load_time_ms": 0.309, "load_throughput": 1659570.053, "learn_time_ms": 66334.331, "learn_throughput": 7.718, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992}, "done": false, "episodes_total": 1312, "training_iteration": 41, "trial_id": "08022_00064", "date": "2024-02-26_21-43-23", "timestamp": 1708980203, "time_this_iter_s": 72.75076723098755, "time_total_s": 3008.303957462311, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3008.303957462311, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 51.17669902912622, "ram_util_percent": 19.618446601941745}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5472566488509377, "policy_loss": -0.1068901669854919, "vf_loss": 0.8672021623700857, "vf_explained_var": 0.40455898890892666, "kl": 0.0, "entropy": 97.75598131815592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3273866361234774, "mean_inference_ms": 10.546081744173746, "mean_action_processing_ms": 0.4449147099879987, "mean_env_wait_ms": 0.2849919211723598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2619800567626953, "StateBufferConnector_ms": 0.004893779754638672, "ViewRequirementAgentConnector_ms": 0.19098782539367676}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3273866361234774, "mean_inference_ms": 10.546081744173746, "mean_action_processing_ms": 0.4449147099879987, "mean_env_wait_ms": 0.2849919211723598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2619800567626953, "StateBufferConnector_ms": 0.004893779754638672, "ViewRequirementAgentConnector_ms": 0.19098782539367676}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.085688919673953, "num_agent_steps_trained_throughput_per_sec": 7.085688919673953, "timesteps_total": 21504, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 72790.1, "sample_time_ms": 6452.829, "load_time_ms": 0.303, "load_throughput": 1691597.99, "learn_time_ms": 66336.461, "learn_throughput": 7.718, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "done": false, "episodes_total": 1344, "training_iteration": 42, "trial_id": "08022_00064", "date": "2024-02-26_21-44-36", "timestamp": 1708980276, "time_this_iter_s": 72.26337432861328, "time_total_s": 3080.567331790924, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3080.567331790924, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 51.10776699029126, "ram_util_percent": 19.73300970873786}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5072425700413684, "policy_loss": -0.10708950863530238, "vf_loss": 0.8144197718550762, "vf_explained_var": 0.17727628548940022, "kl": 0.0, "entropy": 97.81444098154704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3271465883290465, "mean_inference_ms": 10.54344735836001, "mean_action_processing_ms": 0.44479507552628006, "mean_env_wait_ms": 0.28491260730045725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25829339027404785, "StateBufferConnector_ms": 0.004820108413696289, "ViewRequirementAgentConnector_ms": 0.1863861083984375}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3271465883290465, "mean_inference_ms": 10.54344735836001, "mean_action_processing_ms": 0.44479507552628006, "mean_env_wait_ms": 0.28491260730045725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25829339027404785, "StateBufferConnector_ms": 0.004820108413696289, "ViewRequirementAgentConnector_ms": 0.1863861083984375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016, "num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.0863204081450695, "num_agent_steps_trained_throughput_per_sec": 7.0863204081450695, "timesteps_total": 22016, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 22016, "timers": {"training_iteration_time_ms": 72740.216, "sample_time_ms": 6442.712, "load_time_ms": 0.3, "load_throughput": 1707468.91, "learn_time_ms": 66296.705, "learn_throughput": 7.723, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016}, "done": false, "episodes_total": 1376, "training_iteration": 43, "trial_id": "08022_00064", "date": "2024-02-26_21-45-48", "timestamp": 1708980348, "time_this_iter_s": 72.25720715522766, "time_total_s": 3152.8245389461517, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3152.8245389461517, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 51.600980392156856, "ram_util_percent": 20.00196078431372}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.512879838142544, "policy_loss": -0.11239573719600836, "vf_loss": 0.8289275733133157, "vf_explained_var": 0.2042265440026919, "kl": 0.0, "entropy": 97.32886168162028, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.326854324323608, "mean_inference_ms": 10.540665641974396, "mean_action_processing_ms": 0.4447034390168145, "mean_env_wait_ms": 0.2847992257881422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.257810115814209, "StateBufferConnector_ms": 0.004767417907714844, "ViewRequirementAgentConnector_ms": 0.1864032745361328}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.326854324323608, "mean_inference_ms": 10.540665641974396, "mean_action_processing_ms": 0.4447034390168145, "mean_env_wait_ms": 0.2847992257881422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.257810115814209, "StateBufferConnector_ms": 0.004767417907714844, "ViewRequirementAgentConnector_ms": 0.1864032745361328}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.058182714429199, "num_agent_steps_trained_throughput_per_sec": 7.058182714429199, "timesteps_total": 22528, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 22528, "timers": {"training_iteration_time_ms": 72746.793, "sample_time_ms": 6438.217, "load_time_ms": 0.298, "load_throughput": 1717025.384, "learn_time_ms": 66307.787, "learn_throughput": 7.722, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "done": false, "episodes_total": 1408, "training_iteration": 44, "trial_id": "08022_00064", "date": "2024-02-26_21-47-01", "timestamp": 1708980421, "time_this_iter_s": 72.5449800491333, "time_total_s": 3225.369518995285, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3225.369518995285, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 51.69805825242719, "ram_util_percent": 19.96504854368933}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.3713639815648397, "policy_loss": -0.04589395144333442, "vf_loss": 0.5531586566319068, "vf_explained_var": 0.3900429094831149, "kl": 0.0, "entropy": 97.17288029988607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3267832350066826, "mean_inference_ms": 10.540266121162192, "mean_action_processing_ms": 0.4447528087505093, "mean_env_wait_ms": 0.2847844033432678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26012539863586426, "StateBufferConnector_ms": 0.004819393157958984, "ViewRequirementAgentConnector_ms": 0.1889791488647461}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3267832350066826, "mean_inference_ms": 10.540266121162192, "mean_action_processing_ms": 0.4447528087505093, "mean_env_wait_ms": 0.2847844033432678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26012539863586426, "StateBufferConnector_ms": 0.004819393157958984, "ViewRequirementAgentConnector_ms": 0.1889791488647461}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.083767089136846, "num_agent_steps_trained_throughput_per_sec": 7.083767089136846, "timesteps_total": 23040, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 23040, "timers": {"training_iteration_time_ms": 72667.113, "sample_time_ms": 6437.65, "load_time_ms": 0.293, "load_throughput": 1749905.189, "learn_time_ms": 66228.696, "learn_throughput": 7.731, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "done": false, "episodes_total": 1440, "training_iteration": 45, "trial_id": "08022_00064", "date": "2024-02-26_21-48-13", "timestamp": 1708980493, "time_this_iter_s": 72.28325152397156, "time_total_s": 3297.6527705192566, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3297.6527705192566, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 51.2990291262136, "ram_util_percent": 19.928155339805823}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.24069318122540911, "policy_loss": -0.11075467371071378, "vf_loss": 0.46591427040596806, "vf_explained_var": 0.3297913779815038, "kl": 0.0, "entropy": 97.3358315149943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.326094095713409, "mean_inference_ms": 10.537427390456614, "mean_action_processing_ms": 0.4445774111523004, "mean_env_wait_ms": 0.2845904065496077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2550685405731201, "StateBufferConnector_ms": 0.0047245025634765625, "ViewRequirementAgentConnector_ms": 0.1825237274169922}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.326094095713409, "mean_inference_ms": 10.537427390456614, "mean_action_processing_ms": 0.4445774111523004, "mean_env_wait_ms": 0.2845904065496077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2550685405731201, "StateBufferConnector_ms": 0.0047245025634765625, "ViewRequirementAgentConnector_ms": 0.1825237274169922}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.201730539896437, "num_agent_steps_trained_throughput_per_sec": 7.201730539896437, "timesteps_total": 23552, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 23552, "timers": {"training_iteration_time_ms": 72515.714, "sample_time_ms": 6402.856, "load_time_ms": 0.292, "load_throughput": 1753477.299, "learn_time_ms": 66112.101, "learn_throughput": 7.744, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "done": false, "episodes_total": 1472, "training_iteration": 46, "trial_id": "08022_00064", "date": "2024-02-26_21-49-24", "timestamp": 1708980564, "time_this_iter_s": 71.09913039207458, "time_total_s": 3368.751900911331, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3368.751900911331, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 50.71980198019803, "ram_util_percent": 20.026732673267322}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.17727037969355783, "policy_loss": -0.08088524769991637, "vf_loss": 0.34223681191603345, "vf_explained_var": 0.39348520934581754, "kl": 0.0, "entropy": 97.24093519846598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3248062388586022, "mean_inference_ms": 10.531566096072645, "mean_action_processing_ms": 0.44416826692585915, "mean_env_wait_ms": 0.2842106382924611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24852228164672852, "StateBufferConnector_ms": 0.004750728607177734, "ViewRequirementAgentConnector_ms": 0.17193031311035156}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3248062388586022, "mean_inference_ms": 10.531566096072645, "mean_action_processing_ms": 0.44416826692585915, "mean_env_wait_ms": 0.2842106382924611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24852228164672852, "StateBufferConnector_ms": 0.004750728607177734, "ViewRequirementAgentConnector_ms": 0.17193031311035156}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064, "num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.088576873894254, "num_agent_steps_trained_throughput_per_sec": 7.088576873894254, "timesteps_total": 24064, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 24064, "timers": {"training_iteration_time_ms": 72454.725, "sample_time_ms": 6384.391, "load_time_ms": 0.293, "load_throughput": 1749762.607, "learn_time_ms": 66069.594, "learn_throughput": 7.749, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064}, "done": false, "episodes_total": 1504, "training_iteration": 47, "trial_id": "08022_00064", "date": "2024-02-26_21-50-36", "timestamp": 1708980636, "time_this_iter_s": 72.23391270637512, "time_total_s": 3440.9858136177063, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3440.9858136177063, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 51.368627450980405, "ram_util_percent": 19.89411764705883}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.2561846575466916, "policy_loss": -0.06480795022410651, "vf_loss": 0.4255397713432709, "vf_explained_var": 0.21618783324956894, "kl": 0.0, "entropy": 97.56121037801107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.322894411516777, "mean_inference_ms": 10.522133591127151, "mean_action_processing_ms": 0.44348000354554806, "mean_env_wait_ms": 0.2836579621965215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2416994571685791, "StateBufferConnector_ms": 0.0046503543853759766, "ViewRequirementAgentConnector_ms": 0.16378140449523926}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.322894411516777, "mean_inference_ms": 10.522133591127151, "mean_action_processing_ms": 0.44348000354554806, "mean_env_wait_ms": 0.2836579621965215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2416994571685791, "StateBufferConnector_ms": 0.0046503543853759766, "ViewRequirementAgentConnector_ms": 0.16378140449523926}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.141157615636873, "num_agent_steps_trained_throughput_per_sec": 7.141157615636873, "timesteps_total": 24576, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 72304.591, "sample_time_ms": 6367.859, "load_time_ms": 0.292, "load_throughput": 1752332.638, "learn_time_ms": 65935.987, "learn_throughput": 7.765, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "done": false, "episodes_total": 1536, "training_iteration": 48, "trial_id": "08022_00064", "date": "2024-02-26_21-51-48", "timestamp": 1708980708, "time_this_iter_s": 71.70224213600159, "time_total_s": 3512.688055753708, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3512.688055753708, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 51.89117647058824, "ram_util_percent": 19.923529411764704}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.469436532103767, "policy_loss": -0.07400893180941542, "vf_loss": 0.7204454235111674, "vf_explained_var": 0.7070223187406858, "kl": 0.0, "entropy": 97.61386572519937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3216182228263984, "mean_inference_ms": 10.516336532155794, "mean_action_processing_ms": 0.4430494175868307, "mean_env_wait_ms": 0.28331200875743706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24928879737854004, "StateBufferConnector_ms": 0.004774570465087891, "ViewRequirementAgentConnector_ms": 0.17623114585876465}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3216182228263984, "mean_inference_ms": 10.516336532155794, "mean_action_processing_ms": 0.4430494175868307, "mean_env_wait_ms": 0.28331200875743706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24928879737854004, "StateBufferConnector_ms": 0.004774570465087891, "ViewRequirementAgentConnector_ms": 0.17623114585876465}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088, "num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.076420446110827, "num_agent_steps_trained_throughput_per_sec": 7.076420446110827, "timesteps_total": 25088, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 25088, "timers": {"training_iteration_time_ms": 72211.91, "sample_time_ms": 6370.83, "load_time_ms": 0.292, "load_throughput": 1751475.123, "learn_time_ms": 65840.332, "learn_throughput": 7.776, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088}, "done": false, "episodes_total": 1568, "training_iteration": 49, "trial_id": "08022_00064", "date": "2024-02-26_21-53-00", "timestamp": 1708980780, "time_this_iter_s": 72.35812044143677, "time_total_s": 3585.0461761951447, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3585.0461761951447, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 51.352941176470594, "ram_util_percent": 19.900980392156868}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.74, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.008125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.008125, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.3549738840355227, "policy_loss": -0.05524671400586764, "vf_loss": 0.5438292677824695, "vf_explained_var": 0.6407257134715716, "kl": 0.0, "entropy": 97.43781388600668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.74, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.74, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.008125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.008125, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -12.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3211907399011436, "mean_inference_ms": 10.516088347893442, "mean_action_processing_ms": 0.44290504128991076, "mean_env_wait_ms": 0.28321175587180814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2557542324066162, "StateBufferConnector_ms": 0.0046596527099609375, "ViewRequirementAgentConnector_ms": 0.1891191005706787}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.74, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -12.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3211907399011436, "mean_inference_ms": 10.516088347893442, "mean_action_processing_ms": 0.44290504128991076, "mean_env_wait_ms": 0.28321175587180814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2557542324066162, "StateBufferConnector_ms": 0.0046596527099609375, "ViewRequirementAgentConnector_ms": 0.1891191005706787}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.063857630939236, "num_agent_steps_trained_throughput_per_sec": 7.063857630939236, "timesteps_total": 25600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 72192.8, "sample_time_ms": 6382.581, "load_time_ms": 0.258, "load_throughput": 1981621.895, "learn_time_ms": 65809.514, "learn_throughput": 7.78, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "done": false, "episodes_total": 1600, "training_iteration": 50, "trial_id": "08022_00064", "date": "2024-02-26_21-54-13", "timestamp": 1708980853, "time_this_iter_s": 72.48662424087524, "time_total_s": 3657.53280043602, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3657.53280043602, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 51.274757281553384, "ram_util_percent": 19.918446601941753}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.64, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.01125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.01125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.48384232247093073, "policy_loss": -0.0704296946603184, "vf_loss": 0.7347981826712687, "vf_explained_var": 0.7282401780287425, "kl": 0.0, "entropy": 98.25289758046468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.64, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.64, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.01125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.01125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -12.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -10.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3206657169483647, "mean_inference_ms": 10.51517833204491, "mean_action_processing_ms": 0.4427328703776267, "mean_env_wait_ms": 0.2830474368366962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25194549560546875, "StateBufferConnector_ms": 0.004566192626953125, "ViewRequirementAgentConnector_ms": 0.18493437767028809}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.64, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -12.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -10.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3206657169483647, "mean_inference_ms": 10.51517833204491, "mean_action_processing_ms": 0.4427328703776267, "mean_env_wait_ms": 0.2830474368366962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25194549560546875, "StateBufferConnector_ms": 0.004566192626953125, "ViewRequirementAgentConnector_ms": 0.18493437767028809}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112, "num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.159494938476916, "num_agent_steps_trained_throughput_per_sec": 7.159494938476916, "timesteps_total": 26112, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 26112, "timers": {"training_iteration_time_ms": 72069.57, "sample_time_ms": 6345.786, "load_time_ms": 0.257, "load_throughput": 1995246.351, "learn_time_ms": 65723.078, "learn_throughput": 7.79, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112}, "done": false, "episodes_total": 1632, "training_iteration": 51, "trial_id": "08022_00064", "date": "2024-02-26_21-55-24", "timestamp": 1708980924, "time_this_iter_s": 71.51850175857544, "time_total_s": 3729.0513021945953, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3729.0513021945953, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 51.36960784313726, "ram_util_percent": 19.949019607843137}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.54, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.014375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.014375, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.16649081803237398, "policy_loss": -0.07002358948811889, "vf_loss": 0.31354705107708775, "vf_explained_var": 0.831825756529967, "kl": 0.0, "entropy": 98.07716426849365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.54, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.54, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.014375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.014375, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -12.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -10.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3198838860390094, "mean_inference_ms": 10.512580482081715, "mean_action_processing_ms": 0.44247174878580686, "mean_env_wait_ms": 0.2828058372681969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2480621337890625, "StateBufferConnector_ms": 0.004526853561401367, "ViewRequirementAgentConnector_ms": 0.17961668968200684}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.54, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -12.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -10.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3198838860390094, "mean_inference_ms": 10.512580482081715, "mean_action_processing_ms": 0.44247174878580686, "mean_env_wait_ms": 0.2828058372681969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2480621337890625, "StateBufferConnector_ms": 0.004526853561401367, "ViewRequirementAgentConnector_ms": 0.17961668968200684}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.10211297357436, "num_agent_steps_trained_throughput_per_sec": 7.10211297357436, "timesteps_total": 26624, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 26624, "timers": {"training_iteration_time_ms": 72052.86, "sample_time_ms": 6336.605, "load_time_ms": 0.276, "load_throughput": 1858167.04, "learn_time_ms": 65715.524, "learn_throughput": 7.791, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "done": false, "episodes_total": 1664, "training_iteration": 52, "trial_id": "08022_00064", "date": "2024-02-26_21-56-37", "timestamp": 1708980997, "time_this_iter_s": 72.09634184837341, "time_total_s": 3801.1476440429688, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3801.1476440429688, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 51.567647058823525, "ram_util_percent": 19.999999999999996}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.6, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.0125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.35706175041074556, "policy_loss": -0.016695147007703783, "vf_loss": 0.49548936225473883, "vf_explained_var": 0.6790178492665291, "kl": 0.0, "entropy": 97.05173524220784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.6, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.6, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.0125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -10.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3191864393974402, "mean_inference_ms": 10.509181972910367, "mean_action_processing_ms": 0.44221868850366747, "mean_env_wait_ms": 0.28260469743677374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24841856956481934, "StateBufferConnector_ms": 0.0045888423919677734, "ViewRequirementAgentConnector_ms": 0.17873859405517578}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.6, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -10.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3191864393974402, "mean_inference_ms": 10.509181972910367, "mean_action_processing_ms": 0.44221868850366747, "mean_env_wait_ms": 0.28260469743677374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24841856956481934, "StateBufferConnector_ms": 0.0045888423919677734, "ViewRequirementAgentConnector_ms": 0.17873859405517578}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136, "num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.067476849986543, "num_agent_steps_trained_throughput_per_sec": 7.067476849986543, "timesteps_total": 27136, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 27136, "timers": {"training_iteration_time_ms": 72072.124, "sample_time_ms": 6357.74, "load_time_ms": 0.279, "load_throughput": 1835769.916, "learn_time_ms": 65713.653, "learn_throughput": 7.791, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136}, "done": false, "episodes_total": 1696, "training_iteration": 53, "trial_id": "08022_00064", "date": "2024-02-26_21-57-49", "timestamp": 1708981069, "time_this_iter_s": 72.449782371521, "time_total_s": 3873.5974264144897, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3873.5974264144897, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 51.64271844660195, "ram_util_percent": 20.007766990291262}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.7, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.009375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.009375, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.540465536310027, "policy_loss": -0.056191622046753764, "vf_loss": 0.7909881460790833, "vf_explained_var": 0.5342772841453552, "kl": 0.0, "entropy": 96.72904434204102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.7, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.7, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.009375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.009375, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.31891869062477, "mean_inference_ms": 10.508002107179832, "mean_action_processing_ms": 0.4421469478475555, "mean_env_wait_ms": 0.2825560878311903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25472545623779297, "StateBufferConnector_ms": 0.0047190189361572266, "ViewRequirementAgentConnector_ms": 0.18642425537109375}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.7, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.31891869062477, "mean_inference_ms": 10.508002107179832, "mean_action_processing_ms": 0.4421469478475555, "mean_env_wait_ms": 0.2825560878311903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25472545623779297, "StateBufferConnector_ms": 0.0047190189361572266, "ViewRequirementAgentConnector_ms": 0.18642425537109375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.059220108714527, "num_agent_steps_trained_throughput_per_sec": 7.059220108714527, "timesteps_total": 27648, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 27648, "timers": {"training_iteration_time_ms": 72071.057, "sample_time_ms": 6352.621, "load_time_ms": 0.28, "load_throughput": 1825315.468, "learn_time_ms": 65717.706, "learn_throughput": 7.791, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "done": false, "episodes_total": 1728, "training_iteration": 54, "trial_id": "08022_00064", "date": "2024-02-26_21-59-02", "timestamp": 1708981142, "time_this_iter_s": 72.53427267074585, "time_total_s": 3946.1316990852356, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3946.1316990852356, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 51.1, "ram_util_percent": 19.81844660194175}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.8, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.21328758799160522, "policy_loss": -0.052513489065070945, "vf_loss": 0.35237237221250933, "vf_explained_var": 0.7024647821982701, "kl": 0.0, "entropy": 97.09215405782064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.8, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.8, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3186075871102119, "mean_inference_ms": 10.506650998724881, "mean_action_processing_ms": 0.4420806127750809, "mean_env_wait_ms": 0.28251467069638475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2550356388092041, "StateBufferConnector_ms": 0.004683494567871094, "ViewRequirementAgentConnector_ms": 0.18470263481140137}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.8, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3186075871102119, "mean_inference_ms": 10.506650998724881, "mean_action_processing_ms": 0.4420806127750809, "mean_env_wait_ms": 0.28251467069638475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2550356388092041, "StateBufferConnector_ms": 0.004683494567871094, "ViewRequirementAgentConnector_ms": 0.18470263481140137}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160, "num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.153934218569282, "num_agent_steps_trained_throughput_per_sec": 7.153934218569282, "timesteps_total": 28160, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 28160, "timers": {"training_iteration_time_ms": 72000.168, "sample_time_ms": 6316.982, "load_time_ms": 0.28, "load_throughput": 1825781.03, "learn_time_ms": 65682.469, "learn_throughput": 7.795, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160}, "done": false, "episodes_total": 1760, "training_iteration": 55, "trial_id": "08022_00064", "date": "2024-02-26_22-00-13", "timestamp": 1708981213, "time_this_iter_s": 71.57416725158691, "time_total_s": 4017.7058663368225, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4017.7058663368225, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 51.6656862745098, "ram_util_percent": 19.388235294117646}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.74, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.008125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.008125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.4965292442900439, "policy_loss": -0.05137456293838719, "vf_loss": 0.7263558449844519, "vf_explained_var": 0.8526990701754887, "kl": 0.0, "entropy": 98.04848181406656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.74, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.74, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.008125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.008125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3179230435603304, "mean_inference_ms": 10.502925335559517, "mean_action_processing_ms": 0.4418490820839448, "mean_env_wait_ms": 0.28231561427035456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24970006942749023, "StateBufferConnector_ms": 0.004778861999511719, "ViewRequirementAgentConnector_ms": 0.17536234855651855}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.74, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3179230435603304, "mean_inference_ms": 10.502925335559517, "mean_action_processing_ms": 0.4418490820839448, "mean_env_wait_ms": 0.28231561427035456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24970006942749023, "StateBufferConnector_ms": 0.004778861999511719, "ViewRequirementAgentConnector_ms": 0.17536234855651855}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.078191356489225, "num_agent_steps_trained_throughput_per_sec": 7.078191356489225, "timesteps_total": 28672, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 28672, "timers": {"training_iteration_time_ms": 72124.252, "sample_time_ms": 6333.215, "load_time_ms": 0.28, "load_throughput": 1831698.779, "learn_time_ms": 65790.32, "learn_throughput": 7.782, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "done": false, "episodes_total": 1792, "training_iteration": 56, "trial_id": "08022_00064", "date": "2024-02-26_22-01-26", "timestamp": 1708981286, "time_this_iter_s": 72.34022808074951, "time_total_s": 4090.046094417572, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4090.046094417572, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 51.38725490196079, "ram_util_percent": 19.387254901960787}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.66, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.010625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.010625, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.38329778918996454, "policy_loss": -0.07279277558748921, "vf_loss": 0.6046390687425931, "vf_explained_var": 0.8495431259274483, "kl": 0.0, "entropy": 96.02397581736247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.66, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.66, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.010625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.010625, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3172940148862244, "mean_inference_ms": 10.498480667112712, "mean_action_processing_ms": 0.4415915423112446, "mean_env_wait_ms": 0.282100110071277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2497115135192871, "StateBufferConnector_ms": 0.004762887954711914, "ViewRequirementAgentConnector_ms": 0.17139434814453125}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.66, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3172940148862244, "mean_inference_ms": 10.498480667112712, "mean_action_processing_ms": 0.4415915423112446, "mean_env_wait_ms": 0.282100110071277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2497115135192871, "StateBufferConnector_ms": 0.004762887954711914, "ViewRequirementAgentConnector_ms": 0.17139434814453125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184, "num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.090120692898818, "num_agent_steps_trained_throughput_per_sec": 7.090120692898818, "timesteps_total": 29184, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 29184, "timers": {"training_iteration_time_ms": 72122.679, "sample_time_ms": 6355.662, "load_time_ms": 0.285, "load_throughput": 1795254.68, "learn_time_ms": 65766.27, "learn_throughput": 7.785, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184}, "done": false, "episodes_total": 1824, "training_iteration": 57, "trial_id": "08022_00064", "date": "2024-02-26_22-02-38", "timestamp": 1708981358, "time_this_iter_s": 72.21830987930298, "time_total_s": 4162.264404296875, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4162.264404296875, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 51.5378640776699, "ram_util_percent": 19.360194174757282}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.6, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.0125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.17694122741619747, "policy_loss": -0.07140725008988132, "vf_loss": 0.32923547364771366, "vf_explained_var": 0.3280661230285962, "kl": 0.0, "entropy": 96.05512790679931, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.6, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.6, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.0125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3169421781464323, "mean_inference_ms": 10.49545188945105, "mean_action_processing_ms": 0.44140682879683746, "mean_env_wait_ms": 0.28196207558271547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.254594087600708, "StateBufferConnector_ms": 0.004892110824584961, "ViewRequirementAgentConnector_ms": 0.17597532272338867}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.6, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3169421781464323, "mean_inference_ms": 10.49545188945105, "mean_action_processing_ms": 0.44140682879683746, "mean_env_wait_ms": 0.28196207558271547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.254594087600708, "StateBufferConnector_ms": 0.004892110824584961, "ViewRequirementAgentConnector_ms": 0.17597532272338867}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.115323358655275, "num_agent_steps_trained_throughput_per_sec": 7.115323358655275, "timesteps_total": 29696, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 29696, "timers": {"training_iteration_time_ms": 72148.712, "sample_time_ms": 6375.983, "load_time_ms": 0.285, "load_throughput": 1799014.533, "learn_time_ms": 65771.996, "learn_throughput": 7.784, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "done": false, "episodes_total": 1856, "training_iteration": 58, "trial_id": "08022_00064", "date": "2024-02-26_22-03-50", "timestamp": 1708981430, "time_this_iter_s": 71.96229600906372, "time_total_s": 4234.226700305939, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4234.226700305939, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 51.14901960784314, "ram_util_percent": 19.38137254901961}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.56, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.01375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.01375, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.27360768834284194, "policy_loss": -0.07561832492550215, "vf_loss": 0.46296877848605317, "vf_explained_var": 0.9204310134053231, "kl": 0.0, "entropy": 95.84736862182618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.56, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.56, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.01375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.01375, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3164859548607484, "mean_inference_ms": 10.49296298608779, "mean_action_processing_ms": 0.44123541426140384, "mean_env_wait_ms": 0.281818034920571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2546861171722412, "StateBufferConnector_ms": 0.004692554473876953, "ViewRequirementAgentConnector_ms": 0.1750657558441162}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.56, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3164859548607484, "mean_inference_ms": 10.49296298608779, "mean_action_processing_ms": 0.44123541426140384, "mean_env_wait_ms": 0.281818034920571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2546861171722412, "StateBufferConnector_ms": 0.004692554473876953, "ViewRequirementAgentConnector_ms": 0.1750657558441162}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208, "num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.117215317447073, "num_agent_steps_trained_throughput_per_sec": 7.117215317447073, "timesteps_total": 30208, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 30208, "timers": {"training_iteration_time_ms": 72107.242, "sample_time_ms": 6354.716, "load_time_ms": 0.286, "load_throughput": 1790315.672, "learn_time_ms": 65751.796, "learn_throughput": 7.787, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208}, "done": false, "episodes_total": 1888, "training_iteration": 59, "trial_id": "08022_00064", "date": "2024-02-26_22-05-04", "timestamp": 1708981504, "time_this_iter_s": 71.94318509101868, "time_total_s": 4306.169885396957, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4306.169885396957, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 51.06190476190476, "ram_util_percent": 19.46}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.58, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.013125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.013125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.24571371587614219, "policy_loss": -0.06293398418153326, "vf_loss": 0.4091741230338812, "vf_explained_var": 0.7824725329875946, "kl": 0.0, "entropy": 94.95023625691732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.58, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.58, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.013125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.013125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3160342233832474, "mean_inference_ms": 10.4913956881886, "mean_action_processing_ms": 0.4411065761333537, "mean_env_wait_ms": 0.2816974202110337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2561979293823242, "StateBufferConnector_ms": 0.004732847213745117, "ViewRequirementAgentConnector_ms": 0.17694544792175293}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.58, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3160342233832474, "mean_inference_ms": 10.4913956881886, "mean_action_processing_ms": 0.4411065761333537, "mean_env_wait_ms": 0.2816974202110337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2561979293823242, "StateBufferConnector_ms": 0.004732847213745117, "ViewRequirementAgentConnector_ms": 0.17694544792175293}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.122644615529552, "num_agent_steps_trained_throughput_per_sec": 7.122644615529552, "timesteps_total": 30720, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 30720, "timers": {"training_iteration_time_ms": 72047.418, "sample_time_ms": 6332.511, "load_time_ms": 0.287, "load_throughput": 1786294.833, "learn_time_ms": 65714.15, "learn_throughput": 7.791, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "done": false, "episodes_total": 1920, "training_iteration": 60, "trial_id": "08022_00064", "date": "2024-02-26_22-06-16", "timestamp": 1708981576, "time_this_iter_s": 71.89021039009094, "time_total_s": 4378.060095787048, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4378.060095787048, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 51.49901960784313, "ram_util_percent": 19.51372549019608}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.5, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.015625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.015625, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.3171089458434532, "policy_loss": -0.08338195361817877, "vf_loss": 0.5309306158373753, "vf_explained_var": 0.9490774288773537, "kl": 0.0, "entropy": 94.84690163930257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.5, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.5, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.015625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.015625, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3156658056313615, "mean_inference_ms": 10.490279580452123, "mean_action_processing_ms": 0.44099127148408374, "mean_env_wait_ms": 0.28160757057473357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2562856674194336, "StateBufferConnector_ms": 0.004685878753662109, "ViewRequirementAgentConnector_ms": 0.1805891990661621}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.5, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3156658056313615, "mean_inference_ms": 10.490279580452123, "mean_action_processing_ms": 0.44099127148408374, "mean_env_wait_ms": 0.28160757057473357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2562856674194336, "StateBufferConnector_ms": 0.004685878753662109, "ViewRequirementAgentConnector_ms": 0.1805891990661621}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232, "num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.081289326000651, "num_agent_steps_trained_throughput_per_sec": 7.081289326000651, "timesteps_total": 31232, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 31232, "timers": {"training_iteration_time_ms": 72126.397, "sample_time_ms": 6367.048, "load_time_ms": 0.289, "load_throughput": 1771266.618, "learn_time_ms": 65758.591, "learn_throughput": 7.786, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232}, "done": false, "episodes_total": 1952, "training_iteration": 61, "trial_id": "08022_00064", "date": "2024-02-26_22-07-29", "timestamp": 1708981649, "time_this_iter_s": 72.30841112136841, "time_total_s": 4450.368506908417, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4450.368506908417, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 51.31844660194174, "ram_util_percent": 19.39611650485437}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.32, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.02125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.02125, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.6912884872406722, "policy_loss": -0.06770132264743249, "vf_loss": 1.0061924636363984, "vf_explained_var": 0.48720665673414865, "kl": 0.0, "entropy": 94.16516768137613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "sampler_results": {"episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.32, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.32, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.02125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.02125, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.31538109904711, "mean_inference_ms": 10.48886910595742, "mean_action_processing_ms": 0.44087470452077754, "mean_env_wait_ms": 0.28154301997192804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2572784423828125, "StateBufferConnector_ms": 0.004770755767822266, "ViewRequirementAgentConnector_ms": 0.18252205848693848}}, "episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.32, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.31538109904711, "mean_inference_ms": 10.48886910595742, "mean_action_processing_ms": 0.44087470452077754, "mean_env_wait_ms": 0.28154301997192804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2572784423828125, "StateBufferConnector_ms": 0.004770755767822266, "ViewRequirementAgentConnector_ms": 0.18252205848693848}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.091622187657112, "num_agent_steps_trained_throughput_per_sec": 7.091622187657112, "timesteps_total": 31744, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 31744, "timers": {"training_iteration_time_ms": 72137.061, "sample_time_ms": 6365.958, "load_time_ms": 0.27, "load_throughput": 1893891.567, "learn_time_ms": 65770.369, "learn_throughput": 7.785, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "done": false, "episodes_total": 1984, "training_iteration": 62, "trial_id": "08022_00064", "date": "2024-02-26_22-08-41", "timestamp": 1708981721, "time_this_iter_s": 72.20304846763611, "time_total_s": 4522.571555376053, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4522.571555376053, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 50.969607843137254, "ram_util_percent": 19.41078431372549}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.98, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.031875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.031875, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5513116975625356, "policy_loss": -0.08784908577799797, "vf_loss": 0.8473351827512184, "vf_explained_var": 0.9662547071774801, "kl": 0.0, "entropy": 94.13203983306884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "sampler_results": {"episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.98, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.031875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.031875, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -10.0, -8.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3153727760369642, "mean_inference_ms": 10.489089097419047, "mean_action_processing_ms": 0.44082802662216863, "mean_env_wait_ms": 0.2815312561368504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.259002685546875, "StateBufferConnector_ms": 0.004770755767822266, "ViewRequirementAgentConnector_ms": 0.18633723258972168}}, "episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -10.0, -8.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3153727760369642, "mean_inference_ms": 10.489089097419047, "mean_action_processing_ms": 0.44082802662216863, "mean_env_wait_ms": 0.2815312561368504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.259002685546875, "StateBufferConnector_ms": 0.004770755767822266, "ViewRequirementAgentConnector_ms": 0.18633723258972168}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.008901222197513, "num_agent_steps_trained_throughput_per_sec": 7.008901222197513, "timesteps_total": 32256, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 72197.606, "sample_time_ms": 6369.144, "load_time_ms": 0.266, "load_throughput": 1927031.271, "learn_time_ms": 65827.733, "learn_throughput": 7.778, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "done": false, "episodes_total": 2016, "training_iteration": 63, "trial_id": "08022_00064", "date": "2024-02-26_22-09-54", "timestamp": 1708981794, "time_this_iter_s": 73.05504322052002, "time_total_s": 4595.626598596573, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4595.626598596573, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 51.472115384615385, "ram_util_percent": 19.487499999999997}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.76, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.03875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.03875, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.45129537815228105, "policy_loss": -0.09357870692232002, "vf_loss": 0.722339342162013, "vf_explained_var": 0.7084560741980871, "kl": 0.0, "entropy": 94.41462999979655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "sampler_results": {"episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.76, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.76, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.03875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.03875, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -10.0, -8.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -10.0, -14.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -12.0, -16.0, -16.0, -16.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3155010834601182, "mean_inference_ms": 10.491119149134146, "mean_action_processing_ms": 0.4408772847801769, "mean_env_wait_ms": 0.2815468474633583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2629249095916748, "StateBufferConnector_ms": 0.004809379577636719, "ViewRequirementAgentConnector_ms": 0.18723559379577637}}, "episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.76, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -10.0, -8.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -10.0, -14.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -12.0, -16.0, -16.0, -16.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3155010834601182, "mean_inference_ms": 10.491119149134146, "mean_action_processing_ms": 0.4408772847801769, "mean_env_wait_ms": 0.2815468474633583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2629249095916748, "StateBufferConnector_ms": 0.004809379577636719, "ViewRequirementAgentConnector_ms": 0.18723559379577637}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.081074928878345, "num_agent_steps_trained_throughput_per_sec": 7.081074928878345, "timesteps_total": 32768, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 32768, "timers": {"training_iteration_time_ms": 72175.22, "sample_time_ms": 6394.226, "load_time_ms": 0.27, "load_throughput": 1897237.961, "learn_time_ms": 65780.255, "learn_throughput": 7.783, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "done": false, "episodes_total": 2048, "training_iteration": 64, "trial_id": "08022_00064", "date": "2024-02-26_22-11-06", "timestamp": 1708981866, "time_this_iter_s": 72.31049609184265, "time_total_s": 4667.9370946884155, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4667.9370946884155, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 51.46796116504854, "ram_util_percent": 19.494174757281545}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.9, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.034375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.034375, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.32887924873114877, "policy_loss": -0.05047730170190334, "vf_loss": 0.5029128108794491, "vf_explained_var": 0.6070921932657559, "kl": 0.0, "entropy": 94.34230143229166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280}, "sampler_results": {"episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.9, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.034375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.034375, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-10.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -10.0, -8.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -10.0, -14.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -12.0, -16.0, -16.0, -16.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3160194810846886, "mean_inference_ms": 10.495320780320341, "mean_action_processing_ms": 0.44108385057255944, "mean_env_wait_ms": 0.28167272783007447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2679879665374756, "StateBufferConnector_ms": 0.004828453063964844, "ViewRequirementAgentConnector_ms": 0.19606852531433105}}, "episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -10.0, -8.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -10.0, -14.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -12.0, -16.0, -16.0, -16.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3160194810846886, "mean_inference_ms": 10.495320780320341, "mean_action_processing_ms": 0.44108385057255944, "mean_env_wait_ms": 0.28167272783007447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2679879665374756, "StateBufferConnector_ms": 0.004828453063964844, "ViewRequirementAgentConnector_ms": 0.19606852531433105}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280, "num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.930669696557995, "num_agent_steps_trained_throughput_per_sec": 6.930669696557995, "timesteps_total": 33280, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 33280, "timers": {"training_iteration_time_ms": 72405.772, "sample_time_ms": 6430.618, "load_time_ms": 0.275, "load_throughput": 1860259.57, "learn_time_ms": 65974.386, "learn_throughput": 7.761, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280}, "done": false, "episodes_total": 2080, "training_iteration": 65, "trial_id": "08022_00064", "date": "2024-02-26_22-12-20", "timestamp": 1708981940, "time_this_iter_s": 73.87991619110107, "time_total_s": 4741.817010879517, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4741.817010879517, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 52.42285714285714, "ram_util_percent": 19.38857142857143}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.12, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0275, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.0275, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.6266388356685638, "policy_loss": -0.07954755467362702, "vf_loss": 0.936191001906991, "vf_explained_var": 0.4926513502995173, "kl": 0.0, "entropy": 94.68719476064047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "sampler_results": {"episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.12, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.12, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0275, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.0275, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -10.0, -14.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -12.0, -16.0, -16.0, -16.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -12.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3164144050619484, "mean_inference_ms": 10.49876756276839, "mean_action_processing_ms": 0.44125625296665083, "mean_env_wait_ms": 0.2817781872494048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26731204986572266, "StateBufferConnector_ms": 0.004813671112060547, "ViewRequirementAgentConnector_ms": 0.1966080665588379}}, "episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.12, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -10.0, -14.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -12.0, -16.0, -16.0, -16.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -12.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3164144050619484, "mean_inference_ms": 10.49876756276839, "mean_action_processing_ms": 0.44125625296665083, "mean_env_wait_ms": 0.2817781872494048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26731204986572266, "StateBufferConnector_ms": 0.004813671112060547, "ViewRequirementAgentConnector_ms": 0.1966080665588379}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.993146602273174, "num_agent_steps_trained_throughput_per_sec": 6.993146602273174, "timesteps_total": 33792, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 33792, "timers": {"training_iteration_time_ms": 72493.739, "sample_time_ms": 6452.5, "load_time_ms": 0.275, "load_throughput": 1864458.802, "learn_time_ms": 66040.477, "learn_throughput": 7.753, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "done": false, "episodes_total": 2112, "training_iteration": 66, "trial_id": "08022_00064", "date": "2024-02-26_22-13-34", "timestamp": 1708982014, "time_this_iter_s": 73.21966886520386, "time_total_s": 4815.0366797447205, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4815.0366797447205, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 50.979611650485424, "ram_util_percent": 19.38834951456311}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.06, "reward_total_min": -16, "reward_total_max": -4, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.029375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.375, "reward_score_mean": 0.029375, "reward_score_min": 0.0, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.543753930926323, "policy_loss": -0.08179056259493032, "vf_loss": 0.8292840745300054, "vf_explained_var": 0.5616184994578362, "kl": 0.0, "entropy": 95.1959638595581, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304}, "sampler_results": {"episode_reward_max": -4.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.06, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.06, "reward_total_min": -16, "reward_total_max": -4, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.029375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.375, "reward_score_mean": 0.029375, "reward_score_min": 0.0, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -12.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -6.0, -4.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3167748395699113, "mean_inference_ms": 10.50136829533844, "mean_action_processing_ms": 0.4413804730894789, "mean_env_wait_ms": 0.28188188909501655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2644491195678711, "StateBufferConnector_ms": 0.0047647953033447266, "ViewRequirementAgentConnector_ms": 0.19840121269226074}}, "episode_reward_max": -4.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.06, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -12.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -6.0, -4.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3167748395699113, "mean_inference_ms": 10.50136829533844, "mean_action_processing_ms": 0.4413804730894789, "mean_env_wait_ms": 0.28188188909501655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2644491195678711, "StateBufferConnector_ms": 0.0047647953033447266, "ViewRequirementAgentConnector_ms": 0.19840121269226074}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304, "num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.919176288199577, "num_agent_steps_trained_throughput_per_sec": 6.919176288199577, "timesteps_total": 34304, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 34304, "timers": {"training_iteration_time_ms": 72672.146, "sample_time_ms": 6473.916, "load_time_ms": 0.271, "load_throughput": 1890057.779, "learn_time_ms": 66197.474, "learn_throughput": 7.734, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304}, "done": false, "episodes_total": 2144, "training_iteration": 67, "trial_id": "08022_00064", "date": "2024-02-26_22-14-48", "timestamp": 1708982088, "time_this_iter_s": 74.00243616104126, "time_total_s": 4889.039115905762, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4889.039115905762, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 51.66, "ram_util_percent": 19.320952380952384}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.86, "reward_total_min": -16, "reward_total_max": -2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.035625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4375, "reward_score_mean": 0.035625, "reward_score_min": 0.0, "reward_score_max": 0.4375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.29484330313280227, "policy_loss": -0.05889005319525798, "vf_loss": 0.4689441593363881, "vf_explained_var": 0.5268682340780894, "kl": 0.0, "entropy": 95.76156527201334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "sampler_results": {"episode_reward_max": -2.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.86, "reward_total_min": -16, "reward_total_max": -2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.035625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4375, "reward_score_mean": 0.035625, "reward_score_min": 0.0, "reward_score_max": 0.4375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-12.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -12.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -6.0, -4.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3170593488756932, "mean_inference_ms": 10.50324240431031, "mean_action_processing_ms": 0.4414507440226471, "mean_env_wait_ms": 0.28196980289454543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2641105651855469, "StateBufferConnector_ms": 0.004822254180908203, "ViewRequirementAgentConnector_ms": 0.1983354091644287}}, "episode_reward_max": -2.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -12.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -6.0, -4.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3170593488756932, "mean_inference_ms": 10.50324240431031, "mean_action_processing_ms": 0.4414507440226471, "mean_env_wait_ms": 0.28196980289454543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2641105651855469, "StateBufferConnector_ms": 0.004822254180908203, "ViewRequirementAgentConnector_ms": 0.1983354091644287}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.999521854865577, "num_agent_steps_trained_throughput_per_sec": 6.999521854865577, "timesteps_total": 34816, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 34816, "timers": {"training_iteration_time_ms": 72791.194, "sample_time_ms": 6485.286, "load_time_ms": 0.274, "load_throughput": 1869490.422, "learn_time_ms": 66305.151, "learn_throughput": 7.722, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "done": false, "episodes_total": 2176, "training_iteration": 68, "trial_id": "08022_00064", "date": "2024-02-26_22-16-01", "timestamp": 1708982161, "time_this_iter_s": 73.1529221534729, "time_total_s": 4962.192038059235, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4962.192038059235, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 51.51442307692308, "ram_util_percent": 19.297115384615385}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.68, "reward_total_min": -16, "reward_total_max": -2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.04125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4375, "reward_score_mean": 0.04125, "reward_score_min": 0.0, "reward_score_max": 0.4375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.6136434576939791, "policy_loss": -0.08428298787524303, "vf_loss": 0.9252407871186733, "vf_explained_var": 0.9661293645699819, "kl": 0.0, "entropy": 94.83997192382813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328}, "sampler_results": {"episode_reward_max": -2.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.68, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.68, "reward_total_min": -16, "reward_total_max": -2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.04125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4375, "reward_score_mean": 0.04125, "reward_score_min": 0.0, "reward_score_max": 0.4375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -6.0, -4.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -10.0, -16.0, -4.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.317424263599474, "mean_inference_ms": 10.505297900521484, "mean_action_processing_ms": 0.4415513678601648, "mean_env_wait_ms": 0.28209071638108507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2644009590148926, "StateBufferConnector_ms": 0.004843711853027344, "ViewRequirementAgentConnector_ms": 0.1979846954345703}}, "episode_reward_max": -2.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.68, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -6.0, -4.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -10.0, -16.0, -4.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.317424263599474, "mean_inference_ms": 10.505297900521484, "mean_action_processing_ms": 0.4415513678601648, "mean_env_wait_ms": 0.28209071638108507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2644009590148926, "StateBufferConnector_ms": 0.004843711853027344, "ViewRequirementAgentConnector_ms": 0.1979846954345703}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328, "num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.935403665430893, "num_agent_steps_trained_throughput_per_sec": 6.935403665430893, "timesteps_total": 35328, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 35328, "timers": {"training_iteration_time_ms": 72979.78, "sample_time_ms": 6510.84, "load_time_ms": 0.275, "load_throughput": 1861872.419, "learn_time_ms": 66468.161, "learn_throughput": 7.703, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328}, "done": false, "episodes_total": 2208, "training_iteration": 69, "trial_id": "08022_00064", "date": "2024-02-26_22-17-15", "timestamp": 1708982235, "time_this_iter_s": 73.82904744148254, "time_total_s": 5036.021085500717, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5036.021085500717, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 51.05576923076922, "ram_util_percent": 19.334615384615386}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.62, "reward_total_min": -16, "reward_total_max": -2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.043125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4375, "reward_score_mean": 0.043125, "reward_score_min": 0.0, "reward_score_max": 0.4375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.37028830066944163, "policy_loss": -0.09889531965988378, "vf_loss": 0.6219965192178886, "vf_explained_var": 0.531639376282692, "kl": 0.0, "entropy": 95.37454554239909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "sampler_results": {"episode_reward_max": -2.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.62, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.62, "reward_total_min": -16, "reward_total_max": -2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.043125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4375, "reward_score_mean": 0.043125, "reward_score_min": 0.0, "reward_score_max": 0.4375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -10.0, -16.0, -4.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -10.0, -16.0, -16.0, -6.0, -16.0, -12.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3172488784184646, "mean_inference_ms": 10.504389840270658, "mean_action_processing_ms": 0.4414499458847764, "mean_env_wait_ms": 0.28201855806319454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25660181045532227, "StateBufferConnector_ms": 0.004717826843261719, "ViewRequirementAgentConnector_ms": 0.18616724014282227}}, "episode_reward_max": -2.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.62, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -10.0, -16.0, -4.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -10.0, -16.0, -16.0, -6.0, -16.0, -12.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3172488784184646, "mean_inference_ms": 10.504389840270658, "mean_action_processing_ms": 0.4414499458847764, "mean_env_wait_ms": 0.28201855806319454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25660181045532227, "StateBufferConnector_ms": 0.004717826843261719, "ViewRequirementAgentConnector_ms": 0.18616724014282227}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.0975774109826135, "num_agent_steps_trained_throughput_per_sec": 7.0975774109826135, "timesteps_total": 35840, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 35840, "timers": {"training_iteration_time_ms": 73005.169, "sample_time_ms": 6480.597, "load_time_ms": 0.279, "load_throughput": 1836083.83, "learn_time_ms": 66523.807, "learn_throughput": 7.696, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "done": false, "episodes_total": 2240, "training_iteration": 70, "trial_id": "08022_00064", "date": "2024-02-26_22-18-27", "timestamp": 1708982307, "time_this_iter_s": 72.14278817176819, "time_total_s": 5108.163873672485, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5108.163873672485, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 51.60485436893204, "ram_util_percent": 19.333980582524276}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.78, "reward_total_min": -16, "reward_total_max": -4, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.038125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.375, "reward_score_mean": 0.038125, "reward_score_min": 0.0, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.24716255298505227, "policy_loss": -0.06476495131695022, "vf_loss": 0.4135221609845757, "vf_explained_var": -0.006559417645136515, "kl": 0.0, "entropy": 96.35878410339356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled": 36352, "num_agent_steps_trained": 36352}, "sampler_results": {"episode_reward_max": -4.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.78, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.78, "reward_total_min": -16, "reward_total_max": -4, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.038125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.375, "reward_score_mean": 0.038125, "reward_score_min": 0.0, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -10.0, -16.0, -4.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -10.0, -16.0, -16.0, -6.0, -16.0, -12.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3170212289618939, "mean_inference_ms": 10.504135060692434, "mean_action_processing_ms": 0.44134857446654235, "mean_env_wait_ms": 0.2819180769993196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2558329105377197, "StateBufferConnector_ms": 0.0047016143798828125, "ViewRequirementAgentConnector_ms": 0.18484973907470703}}, "episode_reward_max": -4.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.78, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -10.0, -16.0, -4.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -10.0, -16.0, -16.0, -6.0, -16.0, -12.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3170212289618939, "mean_inference_ms": 10.504135060692434, "mean_action_processing_ms": 0.44134857446654235, "mean_env_wait_ms": 0.2819180769993196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2558329105377197, "StateBufferConnector_ms": 0.0047016143798828125, "ViewRequirementAgentConnector_ms": 0.18484973907470703}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36352, "num_agent_steps_trained": 36352, "num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.01007664652563, "num_agent_steps_trained_throughput_per_sec": 7.01007664652563, "timesteps_total": 36352, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 36352, "timers": {"training_iteration_time_ms": 73078.619, "sample_time_ms": 6494.687, "load_time_ms": 0.279, "load_throughput": 1838126.892, "learn_time_ms": 66583.166, "learn_throughput": 7.69, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled": 36352, "num_agent_steps_trained": 36352}, "done": false, "episodes_total": 2272, "training_iteration": 71, "trial_id": "08022_00064", "date": "2024-02-26_22-19-41", "timestamp": 1708982381, "time_this_iter_s": 73.04283452033997, "time_total_s": 5181.206708192825, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5181.206708192825, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 51.525000000000006, "ram_util_percent": 19.332692307692305}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.92, "reward_total_min": -16, "reward_total_max": -2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.03375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4375, "reward_score_mean": 0.03375, "reward_score_min": 0.0, "reward_score_max": 0.4375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.45217482674246035, "policy_loss": -0.06396267746264736, "vf_loss": 0.6842432697614034, "vf_explained_var": 0.009289958576361338, "kl": 0.0, "entropy": 96.80870552062989, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "sampler_results": {"episode_reward_max": -2.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.92, "reward_total_min": -16, "reward_total_max": -2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.03375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4375, "reward_score_mean": 0.03375, "reward_score_min": 0.0, "reward_score_max": 0.4375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -10.0, -16.0, -16.0, -6.0, -16.0, -12.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -8.0, -16.0, -6.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3167528531435695, "mean_inference_ms": 10.503434352939548, "mean_action_processing_ms": 0.44121306799925186, "mean_env_wait_ms": 0.28179974259327895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2549872398376465, "StateBufferConnector_ms": 0.004659175872802734, "ViewRequirementAgentConnector_ms": 0.185075044631958}}, "episode_reward_max": -2.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -10.0, -16.0, -16.0, -6.0, -16.0, -12.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -8.0, -16.0, -6.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3167528531435695, "mean_inference_ms": 10.503434352939548, "mean_action_processing_ms": 0.44121306799925186, "mean_env_wait_ms": 0.28179974259327895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2549872398376465, "StateBufferConnector_ms": 0.004659175872802734, "ViewRequirementAgentConnector_ms": 0.185075044631958}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.002397909942921, "num_agent_steps_trained_throughput_per_sec": 7.002397909942921, "timesteps_total": 36864, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 36864, "timers": {"training_iteration_time_ms": 73170.614, "sample_time_ms": 6515.259, "load_time_ms": 0.279, "load_throughput": 1837183.376, "learn_time_ms": 66654.589, "learn_throughput": 7.681, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "done": false, "episodes_total": 2304, "training_iteration": 72, "trial_id": "08022_00064", "date": "2024-02-26_22-20-54", "timestamp": 1708982454, "time_this_iter_s": 73.12305355072021, "time_total_s": 5254.3297617435455, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5254.3297617435455, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 52.051923076923075, "ram_util_percent": 19.376923076923077}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.56, "reward_total_min": -16, "reward_total_max": -2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.045, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4375, "reward_score_mean": 0.045, "reward_score_min": 0.0, "reward_score_max": 0.4375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 1.0310831256210804, "policy_loss": -0.09566706080610553, "vf_loss": 1.4937322435279687, "vf_explained_var": 0.98968572417895, "kl": 0.0, "entropy": 96.27314929962158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled": 37376, "num_agent_steps_trained": 37376}, "sampler_results": {"episode_reward_max": -2.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.56, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.56, "reward_total_min": -16, "reward_total_max": -2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.045, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4375, "reward_score_mean": 0.045, "reward_score_min": 0.0, "reward_score_max": 0.4375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -8.0, -16.0, -6.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -4.0, -16.0, -16.0, -10.0, -16.0, -8.0, -16.0, -16.0, -4.0, -16.0, -16.0, -6.0, -4.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.316595258399215, "mean_inference_ms": 10.502983696555015, "mean_action_processing_ms": 0.44113568495670435, "mean_env_wait_ms": 0.2817481971740022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.257305383682251, "StateBufferConnector_ms": 0.0047037601470947266, "ViewRequirementAgentConnector_ms": 0.1879594326019287}}, "episode_reward_max": -2.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.56, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -8.0, -16.0, -6.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -4.0, -16.0, -16.0, -10.0, -16.0, -8.0, -16.0, -16.0, -4.0, -16.0, -16.0, -6.0, -4.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.316595258399215, "mean_inference_ms": 10.502983696555015, "mean_action_processing_ms": 0.44113568495670435, "mean_env_wait_ms": 0.2817481971740022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.257305383682251, "StateBufferConnector_ms": 0.0047037601470947266, "ViewRequirementAgentConnector_ms": 0.1879594326019287}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37376, "num_agent_steps_trained": 37376, "num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.060921104780086, "num_agent_steps_trained_throughput_per_sec": 7.060921104780086, "timesteps_total": 37376, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 37376, "timers": {"training_iteration_time_ms": 73116.796, "sample_time_ms": 6476.318, "load_time_ms": 0.28, "load_throughput": 1825625.817, "learn_time_ms": 66639.703, "learn_throughput": 7.683, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled": 37376, "num_agent_steps_trained": 37376}, "done": false, "episodes_total": 2336, "training_iteration": 73, "trial_id": "08022_00064", "date": "2024-02-26_22-22-07", "timestamp": 1708982527, "time_this_iter_s": 72.51669597625732, "time_total_s": 5326.846457719803, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5326.846457719803, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 52.18737864077671, "ram_util_percent": 19.456310679611654}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.02, "reward_total_min": -16, "reward_total_max": 0, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.061875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5, "reward_score_mean": 0.061875, "reward_score_min": 0.0, "reward_score_max": 0.5, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.8085555960734685, "policy_loss": -0.07737292887177319, "vf_loss": 1.1744750685989858, "vf_explained_var": 0.49355240563551583, "kl": 0.0, "entropy": 96.38047059377034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.02, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.02, "reward_total_min": -16, "reward_total_max": 0, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.061875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5, "reward_score_mean": 0.061875, "reward_score_min": 0.0, "reward_score_max": 0.5, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-8.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -8.0, -16.0, -6.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -4.0, -16.0, -16.0, -10.0, -16.0, -8.0, -16.0, -16.0, -4.0, -16.0, -16.0, -6.0, -4.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -8.0, -12.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3165368079442428, "mean_inference_ms": 10.502295673419733, "mean_action_processing_ms": 0.44110692922425054, "mean_env_wait_ms": 0.28172954810447076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25945329666137695, "StateBufferConnector_ms": 0.0047147274017333984, "ViewRequirementAgentConnector_ms": 0.1905965805053711}}, "episode_reward_max": 0.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.02, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -8.0, -16.0, -6.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -4.0, -16.0, -16.0, -10.0, -16.0, -8.0, -16.0, -16.0, -4.0, -16.0, -16.0, -6.0, -4.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -8.0, -12.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3165368079442428, "mean_inference_ms": 10.502295673419733, "mean_action_processing_ms": 0.44110692922425054, "mean_env_wait_ms": 0.28172954810447076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25945329666137695, "StateBufferConnector_ms": 0.0047147274017333984, "ViewRequirementAgentConnector_ms": 0.1905965805053711}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.026364501092682, "num_agent_steps_trained_throughput_per_sec": 7.026364501092682, "timesteps_total": 37888, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 37888, "timers": {"training_iteration_time_ms": 73173.097, "sample_time_ms": 6463.277, "load_time_ms": 0.284, "load_throughput": 1805518.453, "learn_time_ms": 66709.036, "learn_throughput": 7.675, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "done": false, "episodes_total": 2368, "training_iteration": 74, "trial_id": "08022_00064", "date": "2024-02-26_22-23-19", "timestamp": 1708982599, "time_this_iter_s": 72.87347865104675, "time_total_s": 5399.71993637085, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5399.71993637085, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 52.27307692307692, "ram_util_percent": 19.477884615384617}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -13.86, "reward_total_min": -16, "reward_total_max": 2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.066875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5625, "reward_score_mean": 0.066875, "reward_score_min": 0.0, "reward_score_max": 0.5625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5638228883966804, "policy_loss": -0.06979007051171114, "vf_loss": 0.8399804260581731, "vf_explained_var": 0.9904685134689013, "kl": 0.0, "entropy": 96.35255317687988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400}, "sampler_results": {"episode_reward_max": 2.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -13.86, "reward_total_min": -16, "reward_total_max": 2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.066875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5625, "reward_score_mean": 0.066875, "reward_score_min": 0.0, "reward_score_max": 0.5625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -4.0, -16.0, -16.0, -10.0, -16.0, -8.0, -16.0, -16.0, -4.0, -16.0, -16.0, -6.0, -4.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -8.0, -12.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -10.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3164658660128377, "mean_inference_ms": 10.501751706530587, "mean_action_processing_ms": 0.4410833668005708, "mean_env_wait_ms": 0.2817130273433971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2592582702636719, "StateBufferConnector_ms": 0.0046923160552978516, "ViewRequirementAgentConnector_ms": 0.18926572799682617}}, "episode_reward_max": 2.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -4.0, -16.0, -16.0, -10.0, -16.0, -8.0, -16.0, -16.0, -4.0, -16.0, -16.0, -6.0, -4.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -8.0, -12.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -10.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3164658660128377, "mean_inference_ms": 10.501751706530587, "mean_action_processing_ms": 0.4410833668005708, "mean_env_wait_ms": 0.2817130273433971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2592582702636719, "StateBufferConnector_ms": 0.0046923160552978516, "ViewRequirementAgentConnector_ms": 0.18926572799682617}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.0392417294016205, "num_agent_steps_trained_throughput_per_sec": 7.0392417294016205, "timesteps_total": 38400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 38400, "timers": {"training_iteration_time_ms": 73059.153, "sample_time_ms": 6455.281, "load_time_ms": 0.284, "load_throughput": 1804001.72, "learn_time_ms": 66603.088, "learn_throughput": 7.687, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400}, "done": false, "episodes_total": 2400, "training_iteration": 75, "trial_id": "08022_00064", "date": "2024-02-26_22-24-32", "timestamp": 1708982672, "time_this_iter_s": 72.74030637741089, "time_total_s": 5472.4602427482605, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5472.4602427482605, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 52.58058252427184, "ram_util_percent": 19.399029126213595}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.08, "reward_total_min": -16, "reward_total_max": 2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.06, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5625, "reward_score_mean": 0.06, "reward_score_min": 0.0, "reward_score_max": 0.5625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.6993505651752154, "policy_loss": -0.05058282884419896, "vf_loss": 0.9941863796363274, "vf_explained_var": 0.9924064616362254, "kl": 0.0, "entropy": 96.74984741210938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "sampler_results": {"episode_reward_max": 2.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.08, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.08, "reward_total_min": -16, "reward_total_max": 2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.06, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5625, "reward_score_mean": 0.06, "reward_score_min": 0.0, "reward_score_max": 0.5625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -8.0, -12.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3168452081800914, "mean_inference_ms": 10.503439874073786, "mean_action_processing_ms": 0.44120366509672665, "mean_env_wait_ms": 0.28180394032270106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26659703254699707, "StateBufferConnector_ms": 0.0048105716705322266, "ViewRequirementAgentConnector_ms": 0.201033353805542}}, "episode_reward_max": 2.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.08, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -8.0, -12.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3168452081800914, "mean_inference_ms": 10.503439874073786, "mean_action_processing_ms": 0.44120366509672665, "mean_env_wait_ms": 0.28180394032270106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26659703254699707, "StateBufferConnector_ms": 0.0048105716705322266, "ViewRequirementAgentConnector_ms": 0.201033353805542}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.024756010947123, "num_agent_steps_trained_throughput_per_sec": 7.024756010947123, "timesteps_total": 38912, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 38912, "timers": {"training_iteration_time_ms": 73026.209, "sample_time_ms": 6467.416, "load_time_ms": 0.287, "load_throughput": 1781848.364, "learn_time_ms": 66558.002, "learn_throughput": 7.693, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "done": false, "episodes_total": 2432, "training_iteration": 76, "trial_id": "08022_00064", "date": "2024-02-26_22-25-45", "timestamp": 1708982745, "time_this_iter_s": 72.88999533653259, "time_total_s": 5545.350238084793, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5545.350238084793, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 52.65242718446603, "ram_util_percent": 19.371844660194178}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.08, "reward_total_min": -16, "reward_total_max": 4, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.06, "reward_percentile_min": 0.0, "reward_percentile_max": 0.625, "reward_score_mean": 0.06, "reward_score_min": 0.0, "reward_score_max": 0.625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.7784938547760248, "policy_loss": -0.05180491662273804, "vf_loss": 1.100726732549568, "vf_explained_var": 0.612602861225605, "kl": 0.0, "entropy": 95.3626610438029, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled": 39424, "num_agent_steps_trained": 39424}, "sampler_results": {"episode_reward_max": 4.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.08, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.08, "reward_total_min": -16, "reward_total_max": 4, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.06, "reward_percentile_min": 0.0, "reward_percentile_max": 0.625, "reward_score_mean": 0.06, "reward_score_min": 0.0, "reward_score_max": 0.625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-6.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3173016443212315, "mean_inference_ms": 10.505290810195172, "mean_action_processing_ms": 0.4413095528483025, "mean_env_wait_ms": 0.2818965503254278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2658963203430176, "StateBufferConnector_ms": 0.004841327667236328, "ViewRequirementAgentConnector_ms": 0.20290637016296387}}, "episode_reward_max": 4.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.08, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3173016443212315, "mean_inference_ms": 10.505290810195172, "mean_action_processing_ms": 0.4413095528483025, "mean_env_wait_ms": 0.2818965503254278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2658963203430176, "StateBufferConnector_ms": 0.004841327667236328, "ViewRequirementAgentConnector_ms": 0.20290637016296387}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39424, "num_agent_steps_trained": 39424, "num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.002855239901468, "num_agent_steps_trained_throughput_per_sec": 7.002855239901468, "timesteps_total": 39424, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 39424, "timers": {"training_iteration_time_ms": 72937.79, "sample_time_ms": 6462.621, "load_time_ms": 0.286, "load_throughput": 1788079.64, "learn_time_ms": 66474.399, "learn_throughput": 7.702, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled": 39424, "num_agent_steps_trained": 39424}, "done": false, "episodes_total": 2464, "training_iteration": 77, "trial_id": "08022_00064", "date": "2024-02-26_22-26-58", "timestamp": 1708982818, "time_this_iter_s": 73.11796975135803, "time_total_s": 5618.468207836151, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5618.468207836151, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 52.5701923076923, "ram_util_percent": 19.477884615384617}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.18, "reward_total_min": -16, "reward_total_max": 4, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.056875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.625, "reward_score_mean": 0.056875, "reward_score_min": 0.0, "reward_score_max": 0.625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.742233692916731, "policy_loss": -0.07160273256401221, "vf_loss": 1.0789026167864602, "vf_explained_var": 0.49440679798523585, "kl": 0.0, "entropy": 94.44078057607015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "sampler_results": {"episode_reward_max": 4.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.18, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.18, "reward_total_min": -16, "reward_total_max": 4, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.056875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.625, "reward_score_mean": 0.056875, "reward_score_min": 0.0, "reward_score_max": 0.625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -10.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.317808509066443, "mean_inference_ms": 10.507139446837476, "mean_action_processing_ms": 0.44143393493477034, "mean_env_wait_ms": 0.2819917598334237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26687097549438477, "StateBufferConnector_ms": 0.004847288131713867, "ViewRequirementAgentConnector_ms": 0.2029738426208496}}, "episode_reward_max": 4.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.18, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -10.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.317808509066443, "mean_inference_ms": 10.507139446837476, "mean_action_processing_ms": 0.44143393493477034, "mean_env_wait_ms": 0.2819917598334237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26687097549438477, "StateBufferConnector_ms": 0.004847288131713867, "ViewRequirementAgentConnector_ms": 0.2029738426208496}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.9145866436196295, "num_agent_steps_trained_throughput_per_sec": 6.9145866436196295, "timesteps_total": 39936, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 39936, "timers": {"training_iteration_time_ms": 73027.64, "sample_time_ms": 6463.909, "load_time_ms": 0.287, "load_throughput": 1781257.173, "learn_time_ms": 66562.945, "learn_throughput": 7.692, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "done": false, "episodes_total": 2496, "training_iteration": 78, "trial_id": "08022_00064", "date": "2024-02-26_22-28-12", "timestamp": 1708982892, "time_this_iter_s": 74.05183100700378, "time_total_s": 5692.520038843155, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5692.520038843155, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 51.98571428571429, "ram_util_percent": 19.5}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.08, "reward_total_min": -16, "reward_total_max": 4, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.06, "reward_percentile_min": 0.0, "reward_percentile_max": 0.625, "reward_score_mean": 0.06, "reward_score_min": 0.0, "reward_score_max": 0.625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.6126381779710451, "policy_loss": -0.07423877610902613, "vf_loss": 0.9105924968918164, "vf_explained_var": 0.5282742450634639, "kl": 0.0, "entropy": 94.72675501505533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled": 40448, "num_agent_steps_trained": 40448}, "sampler_results": {"episode_reward_max": 4.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.08, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.08, "reward_total_min": -16, "reward_total_max": 4, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.06, "reward_percentile_min": 0.0, "reward_percentile_max": 0.625, "reward_score_mean": 0.06, "reward_score_min": 0.0, "reward_score_max": 0.625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, 2.0, -16.0, -2.0, -10.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3181159019605615, "mean_inference_ms": 10.508350612463714, "mean_action_processing_ms": 0.4414933478347367, "mean_env_wait_ms": 0.2820205871066125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26377439498901367, "StateBufferConnector_ms": 0.004768848419189453, "ViewRequirementAgentConnector_ms": 0.1992175579071045}}, "episode_reward_max": 4.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.08, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, 2.0, -16.0, -2.0, -10.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3181159019605615, "mean_inference_ms": 10.508350612463714, "mean_action_processing_ms": 0.4414933478347367, "mean_env_wait_ms": 0.2820205871066125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26377439498901367, "StateBufferConnector_ms": 0.004768848419189453, "ViewRequirementAgentConnector_ms": 0.1992175579071045}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40448, "num_agent_steps_trained": 40448, "num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.954317232856135, "num_agent_steps_trained_throughput_per_sec": 6.954317232856135, "timesteps_total": 40448, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 40448, "timers": {"training_iteration_time_ms": 73007.562, "sample_time_ms": 6457.69, "load_time_ms": 0.284, "load_throughput": 1804608.108, "learn_time_ms": 66549.119, "learn_throughput": 7.694, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled": 40448, "num_agent_steps_trained": 40448}, "done": false, "episodes_total": 2528, "training_iteration": 79, "trial_id": "08022_00064", "date": "2024-02-26_22-29-26", "timestamp": 1708982966, "time_this_iter_s": 73.62826657295227, "time_total_s": 5766.148305416107, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5766.148305416107, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 52.49615384615385, "ram_util_percent": 19.396153846153847}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -13.38, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.081875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.081875, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.8531039526065191, "policy_loss": -0.05885291592373202, "vf_loss": 1.2089808516204357, "vf_explained_var": 0.9937206735213597, "kl": 0.0, "entropy": 95.01434555053712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "sampler_results": {"episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.38, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -13.38, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.081875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.081875, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, 2.0, -16.0, -2.0, -10.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, 2.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3183922186302985, "mean_inference_ms": 10.509938208770606, "mean_action_processing_ms": 0.4415402793234904, "mean_env_wait_ms": 0.2820790438980195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2654116153717041, "StateBufferConnector_ms": 0.0047607421875, "ViewRequirementAgentConnector_ms": 0.1991891860961914}}, "episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.38, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, 2.0, -16.0, -2.0, -10.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, 2.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3183922186302985, "mean_inference_ms": 10.509938208770606, "mean_action_processing_ms": 0.4415402793234904, "mean_env_wait_ms": 0.2820790438980195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2654116153717041, "StateBufferConnector_ms": 0.0047607421875, "ViewRequirementAgentConnector_ms": 0.1991891860961914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.991573018106088, "num_agent_steps_trained_throughput_per_sec": 6.991573018106088, "timesteps_total": 40960, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 40960, "timers": {"training_iteration_time_ms": 73116.935, "sample_time_ms": 6503.579, "load_time_ms": 0.284, "load_throughput": 1801882.571, "learn_time_ms": 66612.6, "learn_throughput": 7.686, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "done": false, "episodes_total": 2560, "training_iteration": 80, "trial_id": "08022_00064", "date": "2024-02-26_22-30-41", "timestamp": 1708983041, "time_this_iter_s": 73.23631024360657, "time_total_s": 5839.384615659714, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5839.384615659714, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 52.84056603773585, "ram_util_percent": 19.471698113207548}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.76, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.10125, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.7225846245884895, "policy_loss": -0.06511433938673387, "vf_loss": 1.0442521837850411, "vf_explained_var": 0.9957188457250595, "kl": 0.0, "entropy": 95.35324745178222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled": 41472, "num_agent_steps_trained": 41472}, "sampler_results": {"episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.76, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.76, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.10125, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, 2.0, -16.0, -2.0, -10.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, 2.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3187229290035734, "mean_inference_ms": 10.512100648024388, "mean_action_processing_ms": 0.4416058568561963, "mean_env_wait_ms": 0.2821836479471102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2639012336730957, "StateBufferConnector_ms": 0.004769563674926758, "ViewRequirementAgentConnector_ms": 0.2005763053894043}}, "episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.76, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, 2.0, -16.0, -2.0, -10.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, 2.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3187229290035734, "mean_inference_ms": 10.512100648024388, "mean_action_processing_ms": 0.4416058568561963, "mean_env_wait_ms": 0.2821836479471102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2639012336730957, "StateBufferConnector_ms": 0.004769563674926758, "ViewRequirementAgentConnector_ms": 0.2005763053894043}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41472, "num_agent_steps_trained": 41472, "num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.914864264189792, "num_agent_steps_trained_throughput_per_sec": 6.914864264189792, "timesteps_total": 41472, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 41472, "timers": {"training_iteration_time_ms": 73217.503, "sample_time_ms": 6507.221, "load_time_ms": 0.292, "load_throughput": 1752189.661, "learn_time_ms": 66709.503, "learn_throughput": 7.675, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled": 41472, "num_agent_steps_trained": 41472}, "done": false, "episodes_total": 2592, "training_iteration": 81, "trial_id": "08022_00064", "date": "2024-02-26_22-31-55", "timestamp": 1708983115, "time_this_iter_s": 74.048424243927, "time_total_s": 5913.433039903641, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5913.433039903641, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 52.76285714285714, "ram_util_percent": 19.36285714285714}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.4, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.14375, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 1.2844303295016288, "policy_loss": -0.10127853701512018, "vf_loss": 1.8370336671670278, "vf_explained_var": 0.9938260758916537, "kl": 0.0, "entropy": 96.20662180582683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "sampler_results": {"episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.4, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.4, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.14375, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, 2.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 0.0, 4.0, 6.0, 0.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 0.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 0.0, 0.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3191039423605375, "mean_inference_ms": 10.514320602217797, "mean_action_processing_ms": 0.44168076616921714, "mean_env_wait_ms": 0.28230768542831425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2635376453399658, "StateBufferConnector_ms": 0.004799365997314453, "ViewRequirementAgentConnector_ms": 0.19826483726501465}}, "episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.4, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, 2.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 0.0, 4.0, 6.0, 0.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 0.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 0.0, 0.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3191039423605375, "mean_inference_ms": 10.514320602217797, "mean_action_processing_ms": 0.44168076616921714, "mean_env_wait_ms": 0.28230768542831425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2635376453399658, "StateBufferConnector_ms": 0.004799365997314453, "ViewRequirementAgentConnector_ms": 0.19826483726501465}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.992862455496034, "num_agent_steps_trained_throughput_per_sec": 6.992862455496034, "timesteps_total": 41984, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 41984, "timers": {"training_iteration_time_ms": 73227.471, "sample_time_ms": 6510.434, "load_time_ms": 0.301, "load_throughput": 1698421.107, "learn_time_ms": 66716.225, "learn_throughput": 7.674, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "done": false, "episodes_total": 2624, "training_iteration": 82, "trial_id": "08022_00064", "date": "2024-02-26_22-33-08", "timestamp": 1708983188, "time_this_iter_s": 73.22307467460632, "time_total_s": 5986.656114578247, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5986.656114578247, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 51.260576923076925, "ram_util_percent": 18.51153846153846}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.02, "reward_total_min": -16, "reward_total_max": 6, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.155625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6875, "reward_score_mean": 0.155625, "reward_score_min": 0.0, "reward_score_max": 0.6875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 1.1018504224717618, "policy_loss": -0.10004485435783864, "vf_loss": 1.5933520489682753, "vf_explained_var": 0.8355810021360716, "kl": 0.0, "entropy": 96.12092253367106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled": 42496, "num_agent_steps_trained": 42496}, "sampler_results": {"episode_reward_max": 6.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.02, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.02, "reward_total_min": -16, "reward_total_max": 6, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.155625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6875, "reward_score_mean": 0.155625, "reward_score_min": 0.0, "reward_score_max": 0.6875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [0.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 0.0, 4.0, 6.0, 0.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 0.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 0.0, 0.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, 0.0, 0.0, -16.0, -2.0, 0.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 6.0, -16.0, -16.0, -2.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3193060369695422, "mean_inference_ms": 10.51497126411383, "mean_action_processing_ms": 0.44168122453069364, "mean_env_wait_ms": 0.2823373566964439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25681567192077637, "StateBufferConnector_ms": 0.004687309265136719, "ViewRequirementAgentConnector_ms": 0.1890244483947754}}, "episode_reward_max": 6.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.02, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 0.0, 4.0, 6.0, 0.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 0.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 0.0, 0.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, 0.0, 0.0, -16.0, -2.0, 0.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 6.0, -16.0, -16.0, -2.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3193060369695422, "mean_inference_ms": 10.51497126411383, "mean_action_processing_ms": 0.44168122453069364, "mean_env_wait_ms": 0.2823373566964439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25681567192077637, "StateBufferConnector_ms": 0.004687309265136719, "ViewRequirementAgentConnector_ms": 0.1890244483947754}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42496, "num_agent_steps_trained": 42496, "num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.045646718963994, "num_agent_steps_trained_throughput_per_sec": 7.045646718963994, "timesteps_total": 42496, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 42496, "timers": {"training_iteration_time_ms": 73243.191, "sample_time_ms": 6520.513, "load_time_ms": 0.304, "load_throughput": 1683772.658, "learn_time_ms": 66721.86, "learn_throughput": 7.674, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled": 42496, "num_agent_steps_trained": 42496}, "done": false, "episodes_total": 2656, "training_iteration": 83, "trial_id": "08022_00064", "date": "2024-02-26_22-34-21", "timestamp": 1708983261, "time_this_iter_s": 72.67410206794739, "time_total_s": 6059.3302166461945, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6059.3302166461945, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 50.90970873786409, "ram_util_percent": 18.515533980582518}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.08, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.15375, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 1.0002410208185515, "policy_loss": -0.07229946870356799, "vf_loss": 1.4218664916232229, "vf_explained_var": 0.5225897282361984, "kl": 0.0, "entropy": 96.21331926981608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "sampler_results": {"episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.08, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.08, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.15375, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 0.0, 4.0, 6.0, 0.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 0.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 0.0, 0.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, 0.0, 0.0, -16.0, -2.0, 0.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 6.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 0.0, 8.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3194579501824109, "mean_inference_ms": 10.515428065588578, "mean_action_processing_ms": 0.44168649369755697, "mean_env_wait_ms": 0.2823337505325794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25885772705078125, "StateBufferConnector_ms": 0.004723548889160156, "ViewRequirementAgentConnector_ms": 0.18978524208068848}}, "episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.08, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 0.0, 4.0, 6.0, 0.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 0.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 0.0, 0.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, 0.0, 0.0, -16.0, -2.0, 0.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 6.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 0.0, 8.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3194579501824109, "mean_inference_ms": 10.515428065588578, "mean_action_processing_ms": 0.44168649369755697, "mean_env_wait_ms": 0.2823337505325794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25885772705078125, "StateBufferConnector_ms": 0.004723548889160156, "ViewRequirementAgentConnector_ms": 0.18978524208068848}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.947259748583953, "num_agent_steps_trained_throughput_per_sec": 6.947259748583953, "timesteps_total": 43008, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 73326.161, "sample_time_ms": 6526.757, "load_time_ms": 0.298, "load_throughput": 1717849.49, "learn_time_ms": 66798.6, "learn_throughput": 7.665, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "done": false, "episodes_total": 2688, "training_iteration": 84, "trial_id": "08022_00064", "date": "2024-02-26_22-35-35", "timestamp": 1708983335, "time_this_iter_s": 73.70339465141296, "time_total_s": 6133.033611297607, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6133.033611297607, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 49.90380952380952, "ram_util_percent": 17.82761904761905}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.36, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.145, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.145, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.6369016816218694, "policy_loss": -0.09901382797397673, "vf_loss": 0.9756028813620409, "vf_explained_var": 0.9977688913544019, "kl": 0.0, "entropy": 96.87506478627523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520}, "sampler_results": {"episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.36, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.36, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.145, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.145, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 6.0, 0.0, 0.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, 0.0, 0.0, -16.0, -2.0, 0.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 6.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 0.0, 8.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, 8.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3195738472118677, "mean_inference_ms": 10.51597225903001, "mean_action_processing_ms": 0.4417054352109121, "mean_env_wait_ms": 0.2823360230530787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26065564155578613, "StateBufferConnector_ms": 0.004754781723022461, "ViewRequirementAgentConnector_ms": 0.19200897216796875}}, "episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.36, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 6.0, 0.0, 0.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, 0.0, 0.0, -16.0, -2.0, 0.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 6.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 0.0, 8.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, 8.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3195738472118677, "mean_inference_ms": 10.51597225903001, "mean_action_processing_ms": 0.4417054352109121, "mean_env_wait_ms": 0.2823360230530787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26065564155578613, "StateBufferConnector_ms": 0.004754781723022461, "ViewRequirementAgentConnector_ms": 0.19200897216796875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520, "num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.913125523272861, "num_agent_steps_trained_throughput_per_sec": 6.913125523272861, "timesteps_total": 43520, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 43520, "timers": {"training_iteration_time_ms": 73458.852, "sample_time_ms": 6529.505, "load_time_ms": 0.295, "load_throughput": 1737446.317, "learn_time_ms": 66928.545, "learn_throughput": 7.65, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520}, "done": false, "episodes_total": 2720, "training_iteration": 85, "trial_id": "08022_00064", "date": "2024-02-26_22-36-49", "timestamp": 1708983409, "time_this_iter_s": 74.06750106811523, "time_total_s": 6207.101112365723, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6207.101112365723, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 50.20190476190476, "ram_util_percent": 16.42761904761905}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.1, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.121875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.121875, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.8841004657248656, "policy_loss": -0.08973179558136811, "vf_loss": 1.291009022295475, "vf_explained_var": 0.9971596692999204, "kl": 0.0, "entropy": 96.93437582651774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "sampler_results": {"episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.1, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.1, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.121875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.121875, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 0.0, 8.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, 0.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 4.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3198826239987955, "mean_inference_ms": 10.517838635847449, "mean_action_processing_ms": 0.441824350529956, "mean_env_wait_ms": 0.28241856346366606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26616334915161133, "StateBufferConnector_ms": 0.00485539436340332, "ViewRequirementAgentConnector_ms": 0.20057249069213867}}, "episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.1, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 0.0, 8.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, 0.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 4.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3198826239987955, "mean_inference_ms": 10.517838635847449, "mean_action_processing_ms": 0.441824350529956, "mean_env_wait_ms": 0.28241856346366606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26616334915161133, "StateBufferConnector_ms": 0.00485539436340332, "ViewRequirementAgentConnector_ms": 0.20057249069213867}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.901235789520224, "num_agent_steps_trained_throughput_per_sec": 6.901235789520224, "timesteps_total": 44032, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 44032, "timers": {"training_iteration_time_ms": 73589.303, "sample_time_ms": 6526.958, "load_time_ms": 0.296, "load_throughput": 1729192.083, "learn_time_ms": 67061.523, "learn_throughput": 7.635, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "done": false, "episodes_total": 2752, "training_iteration": 86, "trial_id": "08022_00064", "date": "2024-02-26_22-38-03", "timestamp": 1708983483, "time_this_iter_s": 74.19496536254883, "time_total_s": 6281.2960777282715, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6281.2960777282715, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 51.88761904761905, "ram_util_percent": 15.219047619047622}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.82, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.130625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.130625, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.7720961570739746, "policy_loss": -0.08918679336396357, "vf_loss": 1.1418024344990652, "vf_explained_var": 0.9984039008617401, "kl": 0.0, "entropy": 97.81204954783122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled": 44544, "num_agent_steps_trained": 44544}, "sampler_results": {"episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.82, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.82, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.130625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.130625, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, 0.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 4.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 6.0, 8.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, 4.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3203320165526458, "mean_inference_ms": 10.520420191520351, "mean_action_processing_ms": 0.44198752080287745, "mean_env_wait_ms": 0.28252013742960386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27052950859069824, "StateBufferConnector_ms": 0.004904747009277344, "ViewRequirementAgentConnector_ms": 0.20313358306884766}}, "episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.82, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, 0.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 4.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 6.0, 8.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, 4.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3203320165526458, "mean_inference_ms": 10.520420191520351, "mean_action_processing_ms": 0.44198752080287745, "mean_env_wait_ms": 0.28252013742960386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27052950859069824, "StateBufferConnector_ms": 0.004904747009277344, "ViewRequirementAgentConnector_ms": 0.20313358306884766}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44544, "num_agent_steps_trained": 44544, "num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.855520727116845, "num_agent_steps_trained_throughput_per_sec": 6.855520727116845, "timesteps_total": 44544, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 44544, "timers": {"training_iteration_time_ms": 73746.429, "sample_time_ms": 6544.038, "load_time_ms": 0.299, "load_throughput": 1711960.816, "learn_time_ms": 67201.537, "learn_throughput": 7.619, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled": 44544, "num_agent_steps_trained": 44544}, "done": false, "episodes_total": 2784, "training_iteration": 87, "trial_id": "08022_00064", "date": "2024-02-26_22-39-18", "timestamp": 1708983558, "time_this_iter_s": 74.68956255912781, "time_total_s": 6355.985640287399, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6355.985640287399, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 52.150943396226424, "ram_util_percent": 14.89433962264151}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.46, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.141875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.141875, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.8093539218107859, "policy_loss": -0.09337260299362242, "vf_loss": 1.1967441784838835, "vf_explained_var": 0.9980993141730626, "kl": 0.0, "entropy": 98.01197929382325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.46, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.46, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.141875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.141875, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, 0.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 4.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 6.0, 8.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 6.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -2.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3208683786493882, "mean_inference_ms": 10.5234190836429, "mean_action_processing_ms": 0.44215629057801564, "mean_env_wait_ms": 0.2826237241512077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2703537940979004, "StateBufferConnector_ms": 0.004896879196166992, "ViewRequirementAgentConnector_ms": 0.20309042930603027}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.46, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, 0.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 4.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 6.0, 8.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 6.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -2.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3208683786493882, "mean_inference_ms": 10.5234190836429, "mean_action_processing_ms": 0.44215629057801564, "mean_env_wait_ms": 0.2826237241512077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2703537940979004, "StateBufferConnector_ms": 0.004896879196166992, "ViewRequirementAgentConnector_ms": 0.20309042930603027}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.882720772449516, "num_agent_steps_trained_throughput_per_sec": 6.882720772449516, "timesteps_total": 45056, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 45056, "timers": {"training_iteration_time_ms": 73780.711, "sample_time_ms": 6553.789, "load_time_ms": 0.3, "load_throughput": 1706926.038, "learn_time_ms": 67226.076, "learn_throughput": 7.616, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "done": false, "episodes_total": 2816, "training_iteration": 88, "trial_id": "08022_00064", "date": "2024-02-26_22-40-32", "timestamp": 1708983632, "time_this_iter_s": 74.3943943977356, "time_total_s": 6430.380034685135, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6430.380034685135, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 53.26190476190476, "ram_util_percent": 14.914285714285715}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.94, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.126875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.126875, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.6634228177368641, "policy_loss": -0.07705313016970952, "vf_loss": 0.9816486599234243, "vf_explained_var": 0.5705722505847614, "kl": 0.0, "entropy": 98.72618732452392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled": 45568, "num_agent_steps_trained": 45568}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.94, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.126875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.126875, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 6.0, 8.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 6.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 4.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 8.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.321429393858849, "mean_inference_ms": 10.526279017966022, "mean_action_processing_ms": 0.4422849104605898, "mean_env_wait_ms": 0.28273676754629473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27112746238708496, "StateBufferConnector_ms": 0.004893779754638672, "ViewRequirementAgentConnector_ms": 0.20006370544433594}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 6.0, 8.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 6.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 4.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 8.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.321429393858849, "mean_inference_ms": 10.526279017966022, "mean_action_processing_ms": 0.4422849104605898, "mean_env_wait_ms": 0.28273676754629473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27112746238708496, "StateBufferConnector_ms": 0.004893779754638672, "ViewRequirementAgentConnector_ms": 0.20006370544433594}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45568, "num_agent_steps_trained": 45568, "num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.889516093964771, "num_agent_steps_trained_throughput_per_sec": 6.889516093964771, "timesteps_total": 45568, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 45568, "timers": {"training_iteration_time_ms": 73849.959, "sample_time_ms": 6562.223, "load_time_ms": 0.3, "load_throughput": 1706247.933, "learn_time_ms": 67286.888, "learn_throughput": 7.609, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled": 45568, "num_agent_steps_trained": 45568}, "done": false, "episodes_total": 2848, "training_iteration": 89, "trial_id": "08022_00064", "date": "2024-02-26_22-41-46", "timestamp": 1708983706, "time_this_iter_s": 74.32098984718323, "time_total_s": 6504.701024532318, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6504.701024532318, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 53.19150943396226, "ram_util_percent": 14.966981132075471}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.86, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.129375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.129375, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5451527329782645, "policy_loss": -0.07665359852835536, "vf_loss": 0.8243283932407697, "vf_explained_var": 0.9986971984306972, "kl": 0.0, "entropy": 97.8804240544637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.86, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.129375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.129375, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -2.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 6.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 4.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3219089574967011, "mean_inference_ms": 10.528958412765817, "mean_action_processing_ms": 0.4424046238130005, "mean_env_wait_ms": 0.28284910670155944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2704334259033203, "StateBufferConnector_ms": 0.004918098449707031, "ViewRequirementAgentConnector_ms": 0.2008371353149414}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -2.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 6.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 4.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3219089574967011, "mean_inference_ms": 10.528958412765817, "mean_action_processing_ms": 0.4424046238130005, "mean_env_wait_ms": 0.28284910670155944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2704334259033203, "StateBufferConnector_ms": 0.004918098449707031, "ViewRequirementAgentConnector_ms": 0.2008371353149414}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.882683271955303, "num_agent_steps_trained_throughput_per_sec": 6.882683271955303, "timesteps_total": 46080, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 46080, "timers": {"training_iteration_time_ms": 73965.817, "sample_time_ms": 6568.939, "load_time_ms": 0.299, "load_throughput": 1710188.459, "learn_time_ms": 67396.036, "learn_throughput": 7.597, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "done": false, "episodes_total": 2880, "training_iteration": 90, "trial_id": "08022_00064", "date": "2024-02-26_22-43-01", "timestamp": 1708983781, "time_this_iter_s": 74.39478397369385, "time_total_s": 6579.095808506012, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6579.095808506012, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 53.12761904761906, "ram_util_percent": 15.024761904761904}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.52, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.10875, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.39886908084154127, "policy_loss": -0.06959329691405097, "vf_loss": 0.621040381429096, "vf_explained_var": 0.9056465288003286, "kl": 0.0, "entropy": 100.06194070180257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled": 46592, "num_agent_steps_trained": 46592}, "sampler_results": {"episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.52, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.52, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.10875, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 4.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 4.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.322290214987361, "mean_inference_ms": 10.531104033033522, "mean_action_processing_ms": 0.4425181417072357, "mean_env_wait_ms": 0.2829609668288788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2685527801513672, "StateBufferConnector_ms": 0.004883527755737305, "ViewRequirementAgentConnector_ms": 0.19832682609558105}}, "episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.52, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 4.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 4.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.322290214987361, "mean_inference_ms": 10.531104033033522, "mean_action_processing_ms": 0.4425181417072357, "mean_env_wait_ms": 0.2829609668288788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2685527801513672, "StateBufferConnector_ms": 0.004883527755737305, "ViewRequirementAgentConnector_ms": 0.19832682609558105}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46592, "num_agent_steps_trained": 46592, "num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.978735978901783, "num_agent_steps_trained_throughput_per_sec": 6.978735978901783, "timesteps_total": 46592, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 46592, "timers": {"training_iteration_time_ms": 73898.05, "sample_time_ms": 6561.8, "load_time_ms": 0.296, "load_throughput": 1731283.173, "learn_time_ms": 67335.421, "learn_throughput": 7.604, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled": 46592, "num_agent_steps_trained": 46592}, "done": false, "episodes_total": 2912, "training_iteration": 91, "trial_id": "08022_00064", "date": "2024-02-26_22-44-14", "timestamp": 1708983854, "time_this_iter_s": 73.37097501754761, "time_total_s": 6652.46678352356, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6652.46678352356, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 53.33269230769231, "ram_util_percent": 14.963461538461539}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.68, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.135, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.135, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.8184377285341422, "policy_loss": -0.1076238045313706, "vf_loss": 1.2276793787876765, "vf_explained_var": 0.9987828527887662, "kl": 0.0, "entropy": 100.38277448018393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.68, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.68, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.135, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.135, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 6.0, -16.0, -16.0, 2.0, 8.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 0.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3226469309879436, "mean_inference_ms": 10.533297278857916, "mean_action_processing_ms": 0.4426472919374254, "mean_env_wait_ms": 0.28303329433722446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26695775985717773, "StateBufferConnector_ms": 0.004883289337158203, "ViewRequirementAgentConnector_ms": 0.19543218612670898}}, "episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.68, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 6.0, -16.0, -16.0, 2.0, 8.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 0.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3226469309879436, "mean_inference_ms": 10.533297278857916, "mean_action_processing_ms": 0.4426472919374254, "mean_env_wait_ms": 0.28303329433722446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26695775985717773, "StateBufferConnector_ms": 0.004883289337158203, "ViewRequirementAgentConnector_ms": 0.19543218612670898}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.001080874053867, "num_agent_steps_trained_throughput_per_sec": 7.001080874053867, "timesteps_total": 47104, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 47104, "timers": {"training_iteration_time_ms": 73889.457, "sample_time_ms": 6568.689, "load_time_ms": 0.293, "load_throughput": 1748765.186, "learn_time_ms": 67319.951, "learn_throughput": 7.605, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "done": false, "episodes_total": 2944, "training_iteration": 92, "trial_id": "08022_00064", "date": "2024-02-26_22-45-27", "timestamp": 1708983927, "time_this_iter_s": 73.13664126396179, "time_total_s": 6725.603424787521, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6725.603424787521, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 53.84134615384615, "ram_util_percent": 15.039423076923073}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.54, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.108125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.108125, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.1792987217505773, "policy_loss": -0.04636593163013458, "vf_loss": 0.2991635346629967, "vf_explained_var": 0.24293468445539473, "kl": 0.0, "entropy": 101.53767986297608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled": 47616, "num_agent_steps_trained": 47616}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.54, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.54, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.108125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.108125, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [4.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 6.0, -16.0, -16.0, 2.0, 8.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 0.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3228933962661042, "mean_inference_ms": 10.534535295425064, "mean_action_processing_ms": 0.44270519630927213, "mean_env_wait_ms": 0.283054509590109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2623608112335205, "StateBufferConnector_ms": 0.004774570465087891, "ViewRequirementAgentConnector_ms": 0.19072222709655762}}, "episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.54, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 6.0, -16.0, -16.0, 2.0, 8.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 0.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3228933962661042, "mean_inference_ms": 10.534535295425064, "mean_action_processing_ms": 0.44270519630927213, "mean_env_wait_ms": 0.283054509590109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2623608112335205, "StateBufferConnector_ms": 0.004774570465087891, "ViewRequirementAgentConnector_ms": 0.19072222709655762}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47616, "num_agent_steps_trained": 47616, "num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.951789431255355, "num_agent_steps_trained_throughput_per_sec": 6.951789431255355, "timesteps_total": 47616, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 47616, "timers": {"training_iteration_time_ms": 73987.568, "sample_time_ms": 6583.718, "load_time_ms": 0.293, "load_throughput": 1749905.189, "learn_time_ms": 67403.038, "learn_throughput": 7.596, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled": 47616, "num_agent_steps_trained": 47616}, "done": false, "episodes_total": 2976, "training_iteration": 93, "trial_id": "08022_00064", "date": "2024-02-26_22-46-41", "timestamp": 1708984001, "time_this_iter_s": 73.65507745742798, "time_total_s": 6799.258502244949, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6799.258502244949, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 53.70480769230768, "ram_util_percent": 14.806730769230768}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.86, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.098125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.098125, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.389574648005267, "policy_loss": -0.059315434540621936, "vf_loss": 0.5950933810944359, "vf_explained_var": 0.7061860327919324, "kl": 0.0, "entropy": 102.82663923899332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.86, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.098125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.098125, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 6.0, 6.0, -16.0, -16.0, 2.0, 8.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 0.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3230524043438212, "mean_inference_ms": 10.535044664335826, "mean_action_processing_ms": 0.4426968898679943, "mean_env_wait_ms": 0.28302145629845266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2596924304962158, "StateBufferConnector_ms": 0.004806041717529297, "ViewRequirementAgentConnector_ms": 0.188218355178833}}, "episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 6.0, 6.0, -16.0, -16.0, 2.0, 8.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 0.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3230524043438212, "mean_inference_ms": 10.535044664335826, "mean_action_processing_ms": 0.4426968898679943, "mean_env_wait_ms": 0.28302145629845266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2596924304962158, "StateBufferConnector_ms": 0.004806041717529297, "ViewRequirementAgentConnector_ms": 0.188218355178833}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.992225429423346, "num_agent_steps_trained_throughput_per_sec": 6.992225429423346, "timesteps_total": 48128, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 48128, "timers": {"training_iteration_time_ms": 73940.175, "sample_time_ms": 6567.511, "load_time_ms": 0.291, "load_throughput": 1759943.983, "learn_time_ms": 67371.856, "learn_throughput": 7.6, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "done": false, "episodes_total": 3008, "training_iteration": 94, "trial_id": "08022_00064", "date": "2024-02-26_22-47-54", "timestamp": 1708984074, "time_this_iter_s": 73.22933459281921, "time_total_s": 6872.487836837769, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6872.487836837769, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 52.799038461538466, "ram_util_percent": 14.944230769230769}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -13.1, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.090625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.090625, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.7760442753632864, "policy_loss": -0.07907306513904283, "vf_loss": 1.1336287015428146, "vf_explained_var": 0.9475868622461955, "kl": 0.0, "entropy": 103.00702495574951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640}, "sampler_results": {"episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.1, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -13.1, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.090625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.090625, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 6.0, -16.0, -16.0, -16.0, -16.0, 2.0, 14.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3231576851131701, "mean_inference_ms": 10.535699322717402, "mean_action_processing_ms": 0.44269815964331627, "mean_env_wait_ms": 0.28302204311455637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2622990608215332, "StateBufferConnector_ms": 0.004823207855224609, "ViewRequirementAgentConnector_ms": 0.19127821922302246}}, "episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.1, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 6.0, -16.0, -16.0, -16.0, -16.0, 2.0, 14.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3231576851131701, "mean_inference_ms": 10.535699322717402, "mean_action_processing_ms": 0.44269815964331627, "mean_env_wait_ms": 0.28302204311455637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2622990608215332, "StateBufferConnector_ms": 0.004823207855224609, "ViewRequirementAgentConnector_ms": 0.19127821922302246}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640, "num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.977868932853138, "num_agent_steps_trained_throughput_per_sec": 6.977868932853138, "timesteps_total": 48640, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 48640, "timers": {"training_iteration_time_ms": 73871.46, "sample_time_ms": 6574.063, "load_time_ms": 0.296, "load_throughput": 1726828.279, "learn_time_ms": 67296.594, "learn_throughput": 7.608, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640}, "done": false, "episodes_total": 3040, "training_iteration": 95, "trial_id": "08022_00064", "date": "2024-02-26_22-49-08", "timestamp": 1708984148, "time_this_iter_s": 73.37992358207703, "time_total_s": 6945.867760419846, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6945.867760419846, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 54.339423076923076, "ram_util_percent": 15.282692307692312}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -13.1, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.090625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.090625, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.44411677988246084, "policy_loss": -0.054831007743875185, "vf_loss": 0.6614548874087631, "vf_explained_var": 0.3171408399939537, "kl": 0.0, "entropy": 103.7709482828776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "sampler_results": {"episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.1, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -13.1, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.090625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.090625, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 6.0, -16.0, -16.0, -16.0, -16.0, 2.0, 14.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.32323966165151, "mean_inference_ms": 10.536600566505651, "mean_action_processing_ms": 0.44272284594514505, "mean_env_wait_ms": 0.2830351335705744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2620217800140381, "StateBufferConnector_ms": 0.0048580169677734375, "ViewRequirementAgentConnector_ms": 0.19029545783996582}}, "episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.1, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 6.0, -16.0, -16.0, -16.0, -16.0, 2.0, 14.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.32323966165151, "mean_inference_ms": 10.536600566505651, "mean_action_processing_ms": 0.44272284594514505, "mean_env_wait_ms": 0.2830351335705744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2620217800140381, "StateBufferConnector_ms": 0.0048580169677734375, "ViewRequirementAgentConnector_ms": 0.19029545783996582}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.995371956971297, "num_agent_steps_trained_throughput_per_sec": 6.995371956971297, "timesteps_total": 49152, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 49152, "timers": {"training_iteration_time_ms": 73771.623, "sample_time_ms": 6568.83, "load_time_ms": 0.295, "load_throughput": 1736462.883, "learn_time_ms": 67202.007, "learn_throughput": 7.619, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "done": false, "episodes_total": 3072, "training_iteration": 96, "trial_id": "08022_00064", "date": "2024-02-26_22-50-21", "timestamp": 1708984221, "time_this_iter_s": 73.1963758468628, "time_total_s": 7019.064136266708, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7019.064136266708, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 54.30865384615385, "ram_util_percent": 15.499038461538463}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.82, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.099375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.099375, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.6476883730540673, "policy_loss": -0.054594538857539496, "vf_loss": 0.9310161652198682, "vf_explained_var": 0.7743679811557134, "kl": 0.0, "entropy": 102.05433451334635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled": 49664, "num_agent_steps_trained": 49664}, "sampler_results": {"episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.82, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.82, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.099375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.099375, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 6.0, -16.0, -16.0, -16.0, -16.0, 2.0, 14.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3233739443527894, "mean_inference_ms": 10.537648887377436, "mean_action_processing_ms": 0.44278265697718566, "mean_env_wait_ms": 0.28307527168038876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2652289867401123, "StateBufferConnector_ms": 0.004858255386352539, "ViewRequirementAgentConnector_ms": 0.19455456733703613}}, "episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.82, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 6.0, -16.0, -16.0, -16.0, -16.0, 2.0, 14.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3233739443527894, "mean_inference_ms": 10.537648887377436, "mean_action_processing_ms": 0.44278265697718566, "mean_env_wait_ms": 0.28307527168038876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2652289867401123, "StateBufferConnector_ms": 0.004858255386352539, "ViewRequirementAgentConnector_ms": 0.19455456733703613}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49664, "num_agent_steps_trained": 49664, "num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.860160688196882, "num_agent_steps_trained_throughput_per_sec": 6.860160688196882, "timesteps_total": 49664, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 49664, "timers": {"training_iteration_time_ms": 73766.574, "sample_time_ms": 6547.156, "load_time_ms": 0.291, "load_throughput": 1761821.026, "learn_time_ms": 67218.65, "learn_throughput": 7.617, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled": 49664, "num_agent_steps_trained": 49664}, "done": false, "episodes_total": 3104, "training_iteration": 97, "trial_id": "08022_00064", "date": "2024-02-26_22-51-36", "timestamp": 1708984296, "time_this_iter_s": 74.639164686203, "time_total_s": 7093.703300952911, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7093.703300952911, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 54.90849056603773, "ram_util_percent": 15.684905660377362}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.98, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.094375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.094375, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5506767867753903, "policy_loss": -0.08153329769459863, "vf_loss": 0.8381206372131904, "vf_explained_var": 0.9994057446718216, "kl": 0.0, "entropy": 103.71399739583333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.98, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.094375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.094375, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.323565800744109, "mean_inference_ms": 10.538408446805809, "mean_action_processing_ms": 0.44283732325201447, "mean_env_wait_ms": 0.28310078557759916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26451635360717773, "StateBufferConnector_ms": 0.004793882369995117, "ViewRequirementAgentConnector_ms": 0.19467377662658691}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.323565800744109, "mean_inference_ms": 10.538408446805809, "mean_action_processing_ms": 0.44283732325201447, "mean_env_wait_ms": 0.28310078557759916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26451635360717773, "StateBufferConnector_ms": 0.004793882369995117, "ViewRequirementAgentConnector_ms": 0.19467377662658691}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.971049405779329, "num_agent_steps_trained_throughput_per_sec": 6.971049405779329, "timesteps_total": 50176, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 50176, "timers": {"training_iteration_time_ms": 73672.317, "sample_time_ms": 6539.262, "load_time_ms": 0.291, "load_throughput": 1758934.923, "learn_time_ms": 67132.289, "learn_throughput": 7.627, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "done": false, "episodes_total": 3136, "training_iteration": 98, "trial_id": "08022_00064", "date": "2024-02-26_22-52-49", "timestamp": 1708984369, "time_this_iter_s": 73.4517126083374, "time_total_s": 7167.155013561249, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7167.155013561249, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 54.837500000000006, "ram_util_percent": 16.0875}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.24, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1175, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.1175, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.6427480833915372, "policy_loss": -0.08020904993948837, "vf_loss": 0.9584239535033703, "vf_explained_var": 0.9994970227281252, "kl": 0.0, "entropy": 103.60019493103027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 50688, "num_env_steps_trained": 50688, "num_agent_steps_sampled": 50688, "num_agent_steps_trained": 50688}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.24, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.24, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1175, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.1175, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 10.0, -16.0, -16.0, 8.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3236624570062978, "mean_inference_ms": 10.538672404562348, "mean_action_processing_ms": 0.4428885188627727, "mean_env_wait_ms": 0.2831235624772163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2639784812927246, "StateBufferConnector_ms": 0.004745960235595703, "ViewRequirementAgentConnector_ms": 0.19249343872070312}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.24, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 10.0, -16.0, -16.0, 8.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3236624570062978, "mean_inference_ms": 10.538672404562348, "mean_action_processing_ms": 0.4428885188627727, "mean_env_wait_ms": 0.2831235624772163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2639784812927246, "StateBufferConnector_ms": 0.004745960235595703, "ViewRequirementAgentConnector_ms": 0.19249343872070312}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50688, "num_agent_steps_trained": 50688, "num_env_steps_sampled": 50688, "num_env_steps_trained": 50688, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.976798552035087, "num_agent_steps_trained_throughput_per_sec": 6.976798552035087, "timesteps_total": 50688, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 50688, "timers": {"training_iteration_time_ms": 73579.346, "sample_time_ms": 6527.545, "load_time_ms": 0.292, "load_throughput": 1756201.871, "learn_time_ms": 67051.034, "learn_throughput": 7.636, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 50688, "num_env_steps_trained": 50688, "num_agent_steps_sampled": 50688, "num_agent_steps_trained": 50688}, "done": false, "episodes_total": 3168, "training_iteration": 99, "trial_id": "08022_00064", "date": "2024-02-26_22-54-03", "timestamp": 1708984443, "time_this_iter_s": 73.39144992828369, "time_total_s": 7240.5464634895325, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7240.5464634895325, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 55.2847619047619, "ram_util_percent": 16.00952380952381}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.8, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.1, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.15907747060991823, "policy_loss": -0.06814552868405978, "vf_loss": 0.30122943265984453, "vf_explained_var": 0.883074909945329, "kl": 0.0, "entropy": 104.32566992441814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.8, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.8, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.1, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 10.0, -16.0, -16.0, 8.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3238295891388392, "mean_inference_ms": 10.53981361684667, "mean_action_processing_ms": 0.4429754714060134, "mean_env_wait_ms": 0.2831857030754509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26567554473876953, "StateBufferConnector_ms": 0.00476527214050293, "ViewRequirementAgentConnector_ms": 0.19497418403625488}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.8, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 10.0, -16.0, -16.0, 8.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3238295891388392, "mean_inference_ms": 10.53981361684667, "mean_action_processing_ms": 0.4429754714060134, "mean_env_wait_ms": 0.2831857030754509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26567554473876953, "StateBufferConnector_ms": 0.00476527214050293, "ViewRequirementAgentConnector_ms": 0.19497418403625488}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.043817103959401, "num_agent_steps_trained_throughput_per_sec": 7.043817103959401, "timesteps_total": 51200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 51200, "timers": {"training_iteration_time_ms": 73409.172, "sample_time_ms": 6527.121, "load_time_ms": 0.29, "load_throughput": 1763991.825, "learn_time_ms": 66881.287, "learn_throughput": 7.655, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "done": false, "episodes_total": 3200, "training_iteration": 100, "trial_id": "08022_00064", "date": "2024-02-26_22-55-15", "timestamp": 1708984515, "time_this_iter_s": 72.69293856620789, "time_total_s": 7313.23940205574, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7313.23940205574, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 55.82156862745097, "ram_util_percent": 16.056862745098034}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.54, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.108125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.108125, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.6787981435656547, "policy_loss": -0.07342531237130363, "vf_loss": 0.9972223242123922, "vf_explained_var": 0.9994553118944168, "kl": 0.0, "entropy": 103.74056084950765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 51712, "num_env_steps_trained": 51712, "num_agent_steps_sampled": 51712, "num_agent_steps_trained": 51712}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.54, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.54, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.108125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.108125, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 10.0, -16.0, -16.0, 8.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 6.0, -16.0, -16.0, -16.0, 8.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.324012837365348, "mean_inference_ms": 10.541000420020355, "mean_action_processing_ms": 0.44306036925927633, "mean_env_wait_ms": 0.2832529475640364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26559972763061523, "StateBufferConnector_ms": 0.004809141159057617, "ViewRequirementAgentConnector_ms": 0.19751238822937012}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.54, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 10.0, -16.0, -16.0, 8.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 6.0, -16.0, -16.0, -16.0, 8.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.324012837365348, "mean_inference_ms": 10.541000420020355, "mean_action_processing_ms": 0.44306036925927633, "mean_env_wait_ms": 0.2832529475640364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26559972763061523, "StateBufferConnector_ms": 0.004809141159057617, "ViewRequirementAgentConnector_ms": 0.19751238822937012}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51712, "num_agent_steps_trained": 51712, "num_env_steps_sampled": 51712, "num_env_steps_trained": 51712, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.031649392029141, "num_agent_steps_trained_throughput_per_sec": 7.031649392029141, "timesteps_total": 51712, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 51712, "timers": {"training_iteration_time_ms": 73353.964, "sample_time_ms": 6527.198, "load_time_ms": 0.29, "load_throughput": 1765877.517, "learn_time_ms": 66825.999, "learn_throughput": 7.662, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 51712, "num_env_steps_trained": 51712, "num_agent_steps_sampled": 51712, "num_agent_steps_trained": 51712}, "done": false, "episodes_total": 3232, "training_iteration": 101, "trial_id": "08022_00064", "date": "2024-02-26_22-56-28", "timestamp": 1708984588, "time_this_iter_s": 72.81870365142822, "time_total_s": 7386.058105707169, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7386.058105707169, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 55.74807692307692, "ram_util_percent": 16.032692307692308}, "checkpoint_dir_name": "checkpoint_000001"}
{"custom_metrics": {"reward_total_mean": -12.72, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.1025, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.42117595171245437, "policy_loss": -0.05628941880228619, "vf_loss": 0.6329756457048158, "vf_explained_var": 0.8675379807750384, "kl": 0.0, "entropy": 104.3835667292277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.72, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.1025, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 6.0, -16.0, -16.0, -16.0, 8.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3241610012623124, "mean_inference_ms": 10.541690572261025, "mean_action_processing_ms": 0.4431115546028434, "mean_env_wait_ms": 0.28330626930773256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26532506942749023, "StateBufferConnector_ms": 0.004861593246459961, "ViewRequirementAgentConnector_ms": 0.19690418243408203}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 6.0, -16.0, -16.0, -16.0, 8.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3241610012623124, "mean_inference_ms": 10.541690572261025, "mean_action_processing_ms": 0.4431115546028434, "mean_env_wait_ms": 0.28330626930773256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26532506942749023, "StateBufferConnector_ms": 0.004861593246459961, "ViewRequirementAgentConnector_ms": 0.19690418243408203}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.07618922913355, "num_agent_steps_trained_throughput_per_sec": 7.07618922913355, "timesteps_total": 52224, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 52224, "timers": {"training_iteration_time_ms": 73276.34, "sample_time_ms": 6505.973, "load_time_ms": 0.288, "load_throughput": 1776100.941, "learn_time_ms": 66769.61, "learn_throughput": 7.668, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "done": false, "episodes_total": 3264, "training_iteration": 102, "trial_id": "08022_00064", "date": "2024-02-26_22-57-41", "timestamp": 1708984661, "time_this_iter_s": 72.3603835105896, "time_total_s": 7458.418489217758, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7458.418489217758, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 55.67087378640776, "ram_util_percent": 15.604854368932031}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.06, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.123125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.123125, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.7315021480744084, "policy_loss": -0.06582837042709191, "vf_loss": 1.0570207465750476, "vf_explained_var": 0.7733175451556842, "kl": 0.0, "entropy": 104.69157276153564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 52736, "num_env_steps_trained": 52736, "num_agent_steps_sampled": 52736, "num_agent_steps_trained": 52736}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.06, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.06, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.123125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.123125, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 6.0, -16.0, -16.0, -16.0, 8.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, -16.0, 6.0, -16.0, 8.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.324058375692929, "mean_inference_ms": 10.540815042790378, "mean_action_processing_ms": 0.44307492984781677, "mean_env_wait_ms": 0.2832915627347661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25878214836120605, "StateBufferConnector_ms": 0.0047817230224609375, "ViewRequirementAgentConnector_ms": 0.18744468688964844}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.06, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 6.0, -16.0, -16.0, -16.0, 8.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, -16.0, 6.0, -16.0, 8.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.324058375692929, "mean_inference_ms": 10.540815042790378, "mean_action_processing_ms": 0.44307492984781677, "mean_env_wait_ms": 0.2832915627347661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25878214836120605, "StateBufferConnector_ms": 0.0047817230224609375, "ViewRequirementAgentConnector_ms": 0.18744468688964844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52736, "num_agent_steps_trained": 52736, "num_env_steps_sampled": 52736, "num_env_steps_trained": 52736, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.084601521301677, "num_agent_steps_trained_throughput_per_sec": 7.084601521301677, "timesteps_total": 52736, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 52736, "timers": {"training_iteration_time_ms": 73138.271, "sample_time_ms": 6488.745, "load_time_ms": 0.285, "load_throughput": 1799165.255, "learn_time_ms": 66648.781, "learn_throughput": 7.682, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 52736, "num_env_steps_trained": 52736, "num_agent_steps_sampled": 52736, "num_agent_steps_trained": 52736}, "done": false, "episodes_total": 3296, "training_iteration": 103, "trial_id": "08022_00064", "date": "2024-02-26_22-58-53", "timestamp": 1708984733, "time_this_iter_s": 72.27444458007812, "time_total_s": 7530.692933797836, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7530.692933797836, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 55.452941176470596, "ram_util_percent": 15.596078431372547}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.54, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.108125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.108125, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.12375974170863628, "policy_loss": -0.08585468352151414, "vf_loss": 0.27788575099160273, "vf_explained_var": 0.8775904898842176, "kl": 0.0, "entropy": 103.92449010213217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.54, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.54, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.108125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.108125, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 8.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, -16.0, 6.0, -16.0, 8.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3237771706648231, "mean_inference_ms": 10.539174741550196, "mean_action_processing_ms": 0.44303119257577295, "mean_env_wait_ms": 0.2832724569106215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25719118118286133, "StateBufferConnector_ms": 0.00475311279296875, "ViewRequirementAgentConnector_ms": 0.18145346641540527}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.54, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 8.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, -16.0, 6.0, -16.0, 8.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3237771706648231, "mean_inference_ms": 10.539174741550196, "mean_action_processing_ms": 0.44303119257577295, "mean_env_wait_ms": 0.2832724569106215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25719118118286133, "StateBufferConnector_ms": 0.00475311279296875, "ViewRequirementAgentConnector_ms": 0.18145346641540527}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.243566803572414, "num_agent_steps_trained_throughput_per_sec": 7.243566803572414, "timesteps_total": 53248, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 53248, "timers": {"training_iteration_time_ms": 72884.194, "sample_time_ms": 6486.579, "load_time_ms": 0.285, "load_throughput": 1798110.733, "learn_time_ms": 66396.874, "learn_throughput": 7.711, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "done": false, "episodes_total": 3328, "training_iteration": 104, "trial_id": "08022_00064", "date": "2024-02-26_23-00-04", "timestamp": 1708984804, "time_this_iter_s": 70.68842816352844, "time_total_s": 7601.381361961365, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7601.381361961365, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 55.605, "ram_util_percent": 15.590999999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.7, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.134375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.134375, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.8310844212770462, "policy_loss": -0.09607960126983622, "vf_loss": 1.2291409432888032, "vf_explained_var": 0.9994593913356463, "kl": 0.0, "entropy": 103.32059930165609, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.7, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.7, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.134375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.134375, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, -16.0, 6.0, -16.0, 8.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 4.0, 2.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, 12.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3234327168591724, "mean_inference_ms": 10.537156774731354, "mean_action_processing_ms": 0.44298436526598506, "mean_env_wait_ms": 0.2832396061046709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25713610649108887, "StateBufferConnector_ms": 0.0046749114990234375, "ViewRequirementAgentConnector_ms": 0.1731398105621338}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.7, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, -16.0, 6.0, -16.0, 8.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 4.0, 2.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, 12.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3234327168591724, "mean_inference_ms": 10.537156774731354, "mean_action_processing_ms": 0.44298436526598506, "mean_env_wait_ms": 0.2832396061046709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25713610649108887, "StateBufferConnector_ms": 0.0046749114990234375, "ViewRequirementAgentConnector_ms": 0.1731398105621338}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.266399705511471, "num_agent_steps_trained_throughput_per_sec": 7.266399705511471, "timesteps_total": 53760, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 72592.84, "sample_time_ms": 6456.968, "load_time_ms": 0.305, "load_throughput": 1680478.635, "learn_time_ms": 66135.103, "learn_throughput": 7.742, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "done": false, "episodes_total": 3360, "training_iteration": 105, "trial_id": "08022_00064", "date": "2024-02-26_23-01-14", "timestamp": 1708984874, "time_this_iter_s": 70.46737360954285, "time_total_s": 7671.848735570908, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7671.848735570908, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 55.68118811881188, "ram_util_percent": 15.510891089108917}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.44, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1425, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.1425, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.4982637332752347, "policy_loss": -0.09526123190298677, "vf_loss": 0.7868357972552379, "vf_explained_var": 0.865750926733017, "kl": 0.0, "entropy": 103.25044218699138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272}, "sampler_results": {"episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.44, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.44, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1425, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.1425, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 4.0, 2.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, 12.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 14.0, 6.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3231838660183117, "mean_inference_ms": 10.535414818921243, "mean_action_processing_ms": 0.44297382374809685, "mean_env_wait_ms": 0.28323467335247104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.260591983795166, "StateBufferConnector_ms": 0.004876852035522461, "ViewRequirementAgentConnector_ms": 0.17328166961669922}}, "episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.44, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 4.0, 2.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, 12.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 14.0, 6.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3231838660183117, "mean_inference_ms": 10.535414818921243, "mean_action_processing_ms": 0.44297382374809685, "mean_env_wait_ms": 0.28323467335247104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.260591983795166, "StateBufferConnector_ms": 0.004876852035522461, "ViewRequirementAgentConnector_ms": 0.17328166961669922}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272, "num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.253009856515223, "num_agent_steps_trained_throughput_per_sec": 7.253009856515223, "timesteps_total": 54272, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 54272, "timers": {"training_iteration_time_ms": 72332.854, "sample_time_ms": 6441.551, "load_time_ms": 0.304, "load_throughput": 1683244.747, "learn_time_ms": 65890.542, "learn_throughput": 7.77, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272}, "done": false, "episodes_total": 3392, "training_iteration": 106, "trial_id": "08022_00064", "date": "2024-02-26_23-02-25", "timestamp": 1708984945, "time_this_iter_s": 70.5964298248291, "time_total_s": 7742.445165395737, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7742.445165395737, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 55.309000000000005, "ram_util_percent": 15.499999999999995}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.88, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.16, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.16, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.3808262813525895, "policy_loss": -0.07380732521026706, "vf_loss": 0.6027075839539369, "vf_explained_var": 0.9997335523366928, "kl": 0.0, "entropy": 104.47608394622803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 54784, "num_env_steps_trained": 54784, "num_agent_steps_sampled": 54784, "num_agent_steps_trained": 54784}, "sampler_results": {"episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.88, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.16, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.16, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 4.0, 2.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, 12.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 14.0, 6.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 10.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3227325972262298, "mean_inference_ms": 10.532871686101801, "mean_action_processing_ms": 0.4428873298732002, "mean_env_wait_ms": 0.2831574529155565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.255108118057251, "StateBufferConnector_ms": 0.0047607421875, "ViewRequirementAgentConnector_ms": 0.1632542610168457}}, "episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 4.0, 2.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, 12.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 14.0, 6.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 10.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3227325972262298, "mean_inference_ms": 10.532871686101801, "mean_action_processing_ms": 0.4428873298732002, "mean_env_wait_ms": 0.2831574529155565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.255108118057251, "StateBufferConnector_ms": 0.0047607421875, "ViewRequirementAgentConnector_ms": 0.1632542610168457}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54784, "num_agent_steps_trained": 54784, "num_env_steps_sampled": 54784, "num_env_steps_trained": 54784, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.269602785506869, "num_agent_steps_trained_throughput_per_sec": 7.269602785506869, "timesteps_total": 54784, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 54784, "timers": {"training_iteration_time_ms": 71912.5, "sample_time_ms": 6412.595, "load_time_ms": 0.31, "load_throughput": 1652164.678, "learn_time_ms": 65499.155, "learn_throughput": 7.817, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 54784, "num_env_steps_trained": 54784, "num_agent_steps_sampled": 54784, "num_agent_steps_trained": 54784}, "done": false, "episodes_total": 3424, "training_iteration": 107, "trial_id": "08022_00064", "date": "2024-02-26_23-03-36", "timestamp": 1708985016, "time_this_iter_s": 70.43525767326355, "time_total_s": 7812.880423069, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7812.880423069, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 55.151, "ram_util_percent": 15.477}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.38, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.175625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.175625, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.8896957875539859, "policy_loss": -0.08892735956857602, "vf_loss": 1.297360289345185, "vf_explained_var": 0.9995654831329982, "kl": 0.0, "entropy": 102.44331289927165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296}, "sampler_results": {"episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.38, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.38, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.175625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.175625, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 12.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 14.0, 6.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 10.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 6.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 4.0, 10.0, 12.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3223040340106977, "mean_inference_ms": 10.530478596160702, "mean_action_processing_ms": 0.4428058111864564, "mean_env_wait_ms": 0.28308381849532743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25603199005126953, "StateBufferConnector_ms": 0.00479578971862793, "ViewRequirementAgentConnector_ms": 0.16625452041625977}}, "episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.38, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 12.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 14.0, 6.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 10.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 6.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 4.0, 10.0, 12.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3223040340106977, "mean_inference_ms": 10.530478596160702, "mean_action_processing_ms": 0.4428058111864564, "mean_env_wait_ms": 0.28308381849532743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25603199005126953, "StateBufferConnector_ms": 0.00479578971862793, "ViewRequirementAgentConnector_ms": 0.16625452041625977}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296, "num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.250855012308433, "num_agent_steps_trained_throughput_per_sec": 7.250855012308433, "timesteps_total": 55296, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 55296, "timers": {"training_iteration_time_ms": 71629.075, "sample_time_ms": 6391.824, "load_time_ms": 0.303, "load_throughput": 1687212.168, "learn_time_ms": 65236.503, "learn_throughput": 7.848, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296}, "done": false, "episodes_total": 3456, "training_iteration": 108, "trial_id": "08022_00064", "date": "2024-02-26_23-04-46", "timestamp": 1708985086, "time_this_iter_s": 70.6176962852478, "time_total_s": 7883.498119354248, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7883.498119354248, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 54.742999999999995, "ram_util_percent": 15.190999999999999}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.08, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.185, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.185, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.4264379511897763, "policy_loss": -0.0741783011762891, "vf_loss": 0.6636667557060718, "vf_explained_var": 0.9995992213487626, "kl": 0.0, "entropy": 104.01851437886556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 55808, "num_env_steps_trained": 55808, "num_agent_steps_sampled": 55808, "num_agent_steps_trained": 55808}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.08, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.08, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.185, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.185, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 10.0, 14.0, 6.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 10.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 6.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 4.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3218487292240584, "mean_inference_ms": 10.528036025233801, "mean_action_processing_ms": 0.4426991414161154, "mean_env_wait_ms": 0.2830054922299459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2568552494049072, "StateBufferConnector_ms": 0.0048105716705322266, "ViewRequirementAgentConnector_ms": 0.16749215126037598}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.08, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 10.0, 14.0, 6.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 10.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 6.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 4.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3218487292240584, "mean_inference_ms": 10.528036025233801, "mean_action_processing_ms": 0.4426991414161154, "mean_env_wait_ms": 0.2830054922299459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2568552494049072, "StateBufferConnector_ms": 0.0048105716705322266, "ViewRequirementAgentConnector_ms": 0.16749215126037598}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55808, "num_agent_steps_trained": 55808, "num_env_steps_sampled": 55808, "num_env_steps_trained": 55808, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.216730519003419, "num_agent_steps_trained_throughput_per_sec": 7.216730519003419, "timesteps_total": 55808, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 55808, "timers": {"training_iteration_time_ms": 71385.091, "sample_time_ms": 6381.095, "load_time_ms": 0.304, "load_throughput": 1686019.98, "learn_time_ms": 65003.241, "learn_throughput": 7.877, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 55808, "num_env_steps_trained": 55808, "num_agent_steps_sampled": 55808, "num_agent_steps_trained": 55808}, "done": false, "episodes_total": 3488, "training_iteration": 109, "trial_id": "08022_00064", "date": "2024-02-26_23-05-57", "timestamp": 1708985157, "time_this_iter_s": 70.95137643814087, "time_total_s": 7954.449495792389, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7954.449495792389, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 54.659405940594056, "ram_util_percent": 15.262376237623762}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.64, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1675, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.1675, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5796577436228593, "policy_loss": -0.06731784151246151, "vf_loss": 0.8576952431350946, "vf_explained_var": 0.8962344358364741, "kl": 0.0, "entropy": 103.94445012410482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.64, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.64, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1675, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.1675, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 6.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 4.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 4.0, -16.0, 2.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3216362586712704, "mean_inference_ms": 10.526702230012395, "mean_action_processing_ms": 0.4426645360747142, "mean_env_wait_ms": 0.2829931729868054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2633547782897949, "StateBufferConnector_ms": 0.0048143863677978516, "ViewRequirementAgentConnector_ms": 0.17577576637268066}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.64, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 6.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 4.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 4.0, -16.0, 2.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3216362586712704, "mean_inference_ms": 10.526702230012395, "mean_action_processing_ms": 0.4426645360747142, "mean_env_wait_ms": 0.2829931729868054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2633547782897949, "StateBufferConnector_ms": 0.0048143863677978516, "ViewRequirementAgentConnector_ms": 0.17577576637268066}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.216862332108963, "num_agent_steps_trained_throughput_per_sec": 7.216862332108963, "timesteps_total": 56320, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 56320, "timers": {"training_iteration_time_ms": 71210.798, "sample_time_ms": 6362.523, "load_time_ms": 0.304, "load_throughput": 1686152.362, "learn_time_ms": 64847.509, "learn_throughput": 7.895, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "done": false, "episodes_total": 3520, "training_iteration": 110, "trial_id": "08022_00064", "date": "2024-02-26_23-07-08", "timestamp": 1708985228, "time_this_iter_s": 70.95015525817871, "time_total_s": 8025.399651050568, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8025.399651050568, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 54.746534653465346, "ram_util_percent": 15.235643564356433}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.72, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.165, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.165, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5075095586168269, "policy_loss": -0.09722788306729248, "vf_loss": 0.8017001732407759, "vf_explained_var": 0.9275064513087272, "kl": 0.0, "entropy": 103.41557585398355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 56832, "num_env_steps_trained": 56832, "num_agent_steps_sampled": 56832, "num_agent_steps_trained": 56832}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.72, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.165, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.165, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 4.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 4.0, -16.0, 2.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3215027326815854, "mean_inference_ms": 10.526090489237992, "mean_action_processing_ms": 0.44264756860868965, "mean_env_wait_ms": 0.28300793233273924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2640559673309326, "StateBufferConnector_ms": 0.004955291748046875, "ViewRequirementAgentConnector_ms": 0.1777651309967041}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 4.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 4.0, -16.0, 2.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3215027326815854, "mean_inference_ms": 10.526090489237992, "mean_action_processing_ms": 0.44264756860868965, "mean_env_wait_ms": 0.28300793233273924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2640559673309326, "StateBufferConnector_ms": 0.004955291748046875, "ViewRequirementAgentConnector_ms": 0.1777651309967041}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56832, "num_agent_steps_trained": 56832, "num_env_steps_sampled": 56832, "num_env_steps_trained": 56832, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.233696088242023, "num_agent_steps_trained_throughput_per_sec": 7.233696088242023, "timesteps_total": 56832, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 56832, "timers": {"training_iteration_time_ms": 71007.42, "sample_time_ms": 6353.749, "load_time_ms": 0.3, "load_throughput": 1705841.328, "learn_time_ms": 64652.918, "learn_throughput": 7.919, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 56832, "num_env_steps_trained": 56832, "num_agent_steps_sampled": 56832, "num_agent_steps_trained": 56832}, "done": false, "episodes_total": 3552, "training_iteration": 111, "trial_id": "08022_00064", "date": "2024-02-26_23-08-19", "timestamp": 1708985299, "time_this_iter_s": 70.78484869003296, "time_total_s": 8096.184499740601, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8096.184499740601, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 55.218999999999994, "ram_util_percent": 15.238000000000001}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.02, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.155625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.155625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.41697957199066876, "policy_loss": -0.09867292284034193, "vf_loss": 0.6836002881328265, "vf_explained_var": 0.9997795616587003, "kl": 0.0, "entropy": 104.83033466339111, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.02, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.02, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.155625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.155625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 4.0, -16.0, 2.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3213754173076697, "mean_inference_ms": 10.525810458840159, "mean_action_processing_ms": 0.4426614851958544, "mean_env_wait_ms": 0.28302601551598505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26488757133483887, "StateBufferConnector_ms": 0.00499415397644043, "ViewRequirementAgentConnector_ms": 0.17763710021972656}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.02, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, 4.0, -16.0, 2.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3213754173076697, "mean_inference_ms": 10.525810458840159, "mean_action_processing_ms": 0.4426614851958544, "mean_env_wait_ms": 0.28302601551598505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26488757133483887, "StateBufferConnector_ms": 0.00499415397644043, "ViewRequirementAgentConnector_ms": 0.17763710021972656}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.25398938928683, "num_agent_steps_trained_throughput_per_sec": 7.25398938928683, "timesteps_total": 57344, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 57344, "timers": {"training_iteration_time_ms": 70830.073, "sample_time_ms": 6357.203, "load_time_ms": 0.298, "load_throughput": 1717299.998, "learn_time_ms": 64472.126, "learn_throughput": 7.941, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "done": false, "episodes_total": 3584, "training_iteration": 112, "trial_id": "08022_00064", "date": "2024-02-26_23-09-30", "timestamp": 1708985370, "time_this_iter_s": 70.58678817749023, "time_total_s": 8166.771287918091, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8166.771287918091, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 55.12079207920792, "ram_util_percent": 15.26138613861386}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.62, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.199375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.199375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.7817445963621139, "policy_loss": -0.10425091049013038, "vf_loss": 1.1745638685921829, "vf_explained_var": 0.9996990606188774, "kl": 0.0, "entropy": 103.63897921244303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 57856, "num_env_steps_trained": 57856, "num_agent_steps_sampled": 57856, "num_agent_steps_trained": 57856}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.62, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.62, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.199375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.199375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, 14.0, 12.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3210430386588976, "mean_inference_ms": 10.524347305356425, "mean_action_processing_ms": 0.4426168436640859, "mean_env_wait_ms": 0.28299119929087785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26020073890686035, "StateBufferConnector_ms": 0.004887580871582031, "ViewRequirementAgentConnector_ms": 0.17111802101135254}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.62, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, 14.0, 12.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3210430386588976, "mean_inference_ms": 10.524347305356425, "mean_action_processing_ms": 0.4426168436640859, "mean_env_wait_ms": 0.28299119929087785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26020073890686035, "StateBufferConnector_ms": 0.004887580871582031, "ViewRequirementAgentConnector_ms": 0.17111802101135254}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57856, "num_agent_steps_trained": 57856, "num_env_steps_sampled": 57856, "num_env_steps_trained": 57856, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.292034872239792, "num_agent_steps_trained_throughput_per_sec": 7.292034872239792, "timesteps_total": 57856, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 57856, "timers": {"training_iteration_time_ms": 70624.491, "sample_time_ms": 6344.221, "load_time_ms": 0.329, "load_throughput": 1554007.995, "learn_time_ms": 64279.496, "learn_throughput": 7.965, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 57856, "num_env_steps_trained": 57856, "num_agent_steps_sampled": 57856, "num_agent_steps_trained": 57856}, "done": false, "episodes_total": 3616, "training_iteration": 113, "trial_id": "08022_00064", "date": "2024-02-26_23-10-40", "timestamp": 1708985440, "time_this_iter_s": 70.21862006187439, "time_total_s": 8236.989907979965, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8236.989907979965, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 55.07979797979797, "ram_util_percent": 15.26161616161616}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.5, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.234375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.234375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.3678463496423016, "policy_loss": -0.10574153801426292, "vf_loss": 0.6278352609525124, "vf_explained_var": 0.9998601759473483, "kl": 0.0, "entropy": 104.12034047444662, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.5, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.5, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.234375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.234375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 12.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, 14.0, 12.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, 14.0, -16.0, 12.0, -16.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3206809395859613, "mean_inference_ms": 10.522470972695416, "mean_action_processing_ms": 0.44257360883101077, "mean_env_wait_ms": 0.2829444219627739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25892210006713867, "StateBufferConnector_ms": 0.004742145538330078, "ViewRequirementAgentConnector_ms": 0.17055916786193848}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.5, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 12.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, 14.0, 12.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, 14.0, -16.0, 12.0, -16.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3206809395859613, "mean_inference_ms": 10.522470972695416, "mean_action_processing_ms": 0.44257360883101077, "mean_env_wait_ms": 0.2829444219627739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25892210006713867, "StateBufferConnector_ms": 0.004742145538330078, "ViewRequirementAgentConnector_ms": 0.17055916786193848}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368, "num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.211087107848779, "num_agent_steps_trained_throughput_per_sec": 7.211087107848779, "timesteps_total": 58368, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 58368, "timers": {"training_iteration_time_ms": 70656.328, "sample_time_ms": 6341.56, "load_time_ms": 0.332, "load_throughput": 1542510.881, "learn_time_ms": 64313.984, "learn_throughput": 7.961, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368}, "done": false, "episodes_total": 3648, "training_iteration": 114, "trial_id": "08022_00064", "date": "2024-02-26_23-11-51", "timestamp": 1708985511, "time_this_iter_s": 71.00676083564758, "time_total_s": 8307.996668815613, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8307.996668815613, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 55.10891089108911, "ram_util_percent": 15.184158415841587}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -7.96, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.25125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.25125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5556261699646712, "policy_loss": -0.08783077479650576, "vf_loss": 0.853030604372422, "vf_explained_var": 0.9997725456953048, "kl": 0.0, "entropy": 102.96445713043212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 58880, "num_env_steps_trained": 58880, "num_agent_steps_sampled": 58880, "num_agent_steps_trained": 58880}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -7.96, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.25125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.25125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, 14.0, 12.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, 14.0, -16.0, 12.0, -16.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 12.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 10.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3202329206510774, "mean_inference_ms": 10.520281041107067, "mean_action_processing_ms": 0.4425066698045013, "mean_env_wait_ms": 0.2828774549154895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25581979751586914, "StateBufferConnector_ms": 0.0046956539154052734, "ViewRequirementAgentConnector_ms": 0.1666879653930664}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, 14.0, 12.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, 14.0, -16.0, 12.0, -16.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 12.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 10.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3202329206510774, "mean_inference_ms": 10.520281041107067, "mean_action_processing_ms": 0.4425066698045013, "mean_env_wait_ms": 0.2828774549154895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25581979751586914, "StateBufferConnector_ms": 0.0046956539154052734, "ViewRequirementAgentConnector_ms": 0.1666879653930664}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58880, "num_agent_steps_trained": 58880, "num_env_steps_sampled": 58880, "num_env_steps_trained": 58880, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.235881192253985, "num_agent_steps_trained_throughput_per_sec": 7.235881192253985, "timesteps_total": 58880, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 58880, "timers": {"training_iteration_time_ms": 70686.047, "sample_time_ms": 6343.058, "load_time_ms": 0.306, "load_throughput": 1675234.923, "learn_time_ms": 64342.246, "learn_throughput": 7.957, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 58880, "num_env_steps_trained": 58880, "num_agent_steps_sampled": 58880, "num_agent_steps_trained": 58880}, "done": false, "episodes_total": 3680, "training_iteration": 115, "trial_id": "08022_00064", "date": "2024-02-26_23-13-02", "timestamp": 1708985582, "time_this_iter_s": 70.76355123519897, "time_total_s": 8378.760220050812, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8378.760220050812, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 60.39009900990099, "ram_util_percent": 19.139603960396034}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.14, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.245625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.245625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5867707480986913, "policy_loss": -0.09240212035365403, "vf_loss": 0.900379186309874, "vf_explained_var": 0.6314769610762596, "kl": 0.0, "entropy": 101.81515967051187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.14, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.14, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.245625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.245625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, 14.0, -16.0, 12.0, -16.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 12.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 10.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 10.0, 16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3199063731019074, "mean_inference_ms": 10.518737987894228, "mean_action_processing_ms": 0.44247207375969694, "mean_env_wait_ms": 0.2828441282254079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25940775871276855, "StateBufferConnector_ms": 0.004749298095703125, "ViewRequirementAgentConnector_ms": 0.17050457000732422}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.14, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, 14.0, -16.0, 12.0, -16.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 12.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 10.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 10.0, 16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3199063731019074, "mean_inference_ms": 10.518737987894228, "mean_action_processing_ms": 0.44247207375969694, "mean_env_wait_ms": 0.2828441282254079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25940775871276855, "StateBufferConnector_ms": 0.004749298095703125, "ViewRequirementAgentConnector_ms": 0.17050457000732422}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392, "num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.27223430184248, "num_agent_steps_trained_throughput_per_sec": 7.27223430184248, "timesteps_total": 59392, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 59392, "timers": {"training_iteration_time_ms": 70667.386, "sample_time_ms": 6340.228, "load_time_ms": 0.305, "load_throughput": 1679164.632, "learn_time_ms": 64326.414, "learn_throughput": 7.959, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392}, "done": false, "episodes_total": 3712, "training_iteration": 116, "trial_id": "08022_00064", "date": "2024-02-26_23-14-12", "timestamp": 1708985652, "time_this_iter_s": 70.40972566604614, "time_total_s": 8449.169945716858, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8449.169945716858, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 61.206, "ram_util_percent": 21.75999999999999}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.66, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.229375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.229375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5401949842770895, "policy_loss": -0.055067379400134085, "vf_loss": 0.7891390713397414, "vf_explained_var": 0.8349181905388832, "kl": 0.0, "entropy": 103.17488651275634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 59904, "num_env_steps_trained": 59904, "num_agent_steps_sampled": 59904, "num_agent_steps_trained": 59904}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.66, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.66, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.229375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.229375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 12.0, -16.0, 12.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 10.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 10.0, 16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 10.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3195668636003959, "mean_inference_ms": 10.517149069512302, "mean_action_processing_ms": 0.4424347113671368, "mean_env_wait_ms": 0.28280879782048124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2585620880126953, "StateBufferConnector_ms": 0.00475001335144043, "ViewRequirementAgentConnector_ms": 0.17017316818237305}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.66, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 12.0, -16.0, 12.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, 10.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 10.0, 16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 10.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3195668636003959, "mean_inference_ms": 10.517149069512302, "mean_action_processing_ms": 0.4424347113671368, "mean_env_wait_ms": 0.28280879782048124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2585620880126953, "StateBufferConnector_ms": 0.00475001335144043, "ViewRequirementAgentConnector_ms": 0.17017316818237305}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59904, "num_agent_steps_trained": 59904, "num_env_steps_sampled": 59904, "num_env_steps_trained": 59904, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.256828664409663, "num_agent_steps_trained_throughput_per_sec": 7.256828664409663, "timesteps_total": 59904, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 59904, "timers": {"training_iteration_time_ms": 70679.783, "sample_time_ms": 6355.152, "load_time_ms": 0.302, "load_throughput": 1693065.002, "learn_time_ms": 64323.883, "learn_throughput": 7.96, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 59904, "num_env_steps_trained": 59904, "num_agent_steps_sampled": 59904, "num_agent_steps_trained": 59904}, "done": false, "episodes_total": 3744, "training_iteration": 117, "trial_id": "08022_00064", "date": "2024-02-26_23-15-23", "timestamp": 1708985723, "time_this_iter_s": 70.55949711799622, "time_total_s": 8519.729442834854, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8519.729442834854, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 61.302, "ram_util_percent": 22.231000000000012}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.76, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.195, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.195, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.3494675444439054, "policy_loss": -0.08990798080340028, "vf_loss": 0.582479945756495, "vf_explained_var": 0.6675235643982887, "kl": 0.0, "entropy": 104.63680750528971, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.76, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.76, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.195, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.195, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 10.0, 16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 10.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3192805628251856, "mean_inference_ms": 10.515234928760192, "mean_action_processing_ms": 0.4423914277709314, "mean_env_wait_ms": 0.28276954652198405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2587144374847412, "StateBufferConnector_ms": 0.004666328430175781, "ViewRequirementAgentConnector_ms": 0.17275714874267578}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.76, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 10.0, 16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 10.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3192805628251856, "mean_inference_ms": 10.515234928760192, "mean_action_processing_ms": 0.4423914277709314, "mean_env_wait_ms": 0.28276954652198405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2587144374847412, "StateBufferConnector_ms": 0.004666328430175781, "ViewRequirementAgentConnector_ms": 0.17275714874267578}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416, "num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.233955355601855, "num_agent_steps_trained_throughput_per_sec": 7.233955355601855, "timesteps_total": 60416, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 60416, "timers": {"training_iteration_time_ms": 70696.279, "sample_time_ms": 6348.124, "load_time_ms": 0.303, "load_throughput": 1687609.939, "learn_time_ms": 64347.413, "learn_throughput": 7.957, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416}, "done": false, "episodes_total": 3776, "training_iteration": 118, "trial_id": "08022_00064", "date": "2024-02-26_23-16-34", "timestamp": 1708985794, "time_this_iter_s": 70.78267669677734, "time_total_s": 8590.512119531631, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8590.512119531631, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 61.37200000000001, "ram_util_percent": 22.332000000000008}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.68, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.16625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.16625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.37887595674643915, "policy_loss": -0.06755432598292828, "vf_loss": 0.5918324402223031, "vf_explained_var": 0.999853431681792, "kl": 0.0, "entropy": 106.27805938720704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 60928, "num_env_steps_trained": 60928, "num_agent_steps_sampled": 60928, "num_agent_steps_trained": 60928}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.68, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.68, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.16625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.16625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 10.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, 16.0, -16.0, -16.0, 12.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3189774515110608, "mean_inference_ms": 10.512900028180226, "mean_action_processing_ms": 0.44232823531347165, "mean_env_wait_ms": 0.2827070357185395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25731325149536133, "StateBufferConnector_ms": 0.0046329498291015625, "ViewRequirementAgentConnector_ms": 0.17017364501953125}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.68, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 10.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, 16.0, -16.0, -16.0, 12.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3189774515110608, "mean_inference_ms": 10.512900028180226, "mean_action_processing_ms": 0.44232823531347165, "mean_env_wait_ms": 0.2827070357185395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25731325149536133, "StateBufferConnector_ms": 0.0046329498291015625, "ViewRequirementAgentConnector_ms": 0.17017364501953125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60928, "num_agent_steps_trained": 60928, "num_env_steps_sampled": 60928, "num_env_steps_trained": 60928, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.255003525181535, "num_agent_steps_trained_throughput_per_sec": 7.255003525181535, "timesteps_total": 60928, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 60928, "timers": {"training_iteration_time_ms": 70658.852, "sample_time_ms": 6338.581, "load_time_ms": 0.302, "load_throughput": 1692931.532, "learn_time_ms": 64319.538, "learn_throughput": 7.96, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 60928, "num_env_steps_trained": 60928, "num_agent_steps_sampled": 60928, "num_agent_steps_trained": 60928}, "done": false, "episodes_total": 3808, "training_iteration": 119, "trial_id": "08022_00064", "date": "2024-02-26_23-17-44", "timestamp": 1708985864, "time_this_iter_s": 70.57708048820496, "time_total_s": 8661.089200019836, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8661.089200019836, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 57.05899999999999, "ram_util_percent": 17.162}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.0, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.1875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.47584739134957393, "policy_loss": -0.09909345745885124, "vf_loss": 0.7621988360071554, "vf_explained_var": 0.8402174601952235, "kl": 0.0, "entropy": 105.5558490117391, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.0, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.0, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.1875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 14.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, 16.0, -16.0, -16.0, 12.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 12.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3186289141456349, "mean_inference_ms": 10.51036734003862, "mean_action_processing_ms": 0.4422541255892426, "mean_env_wait_ms": 0.2826324670968054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25669121742248535, "StateBufferConnector_ms": 0.004569292068481445, "ViewRequirementAgentConnector_ms": 0.16711902618408203}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.0, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 14.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, 16.0, -16.0, -16.0, 12.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 12.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3186289141456349, "mean_inference_ms": 10.51036734003862, "mean_action_processing_ms": 0.4422541255892426, "mean_env_wait_ms": 0.2826324670968054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25669121742248535, "StateBufferConnector_ms": 0.004569292068481445, "ViewRequirementAgentConnector_ms": 0.16711902618408203}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.351919490216383, "num_agent_steps_trained_throughput_per_sec": 7.351919490216383, "timesteps_total": 61440, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 61440, "timers": {"training_iteration_time_ms": 70528.524, "sample_time_ms": 6320.023, "load_time_ms": 0.301, "load_throughput": 1700034.554, "learn_time_ms": 64207.777, "learn_throughput": 7.974, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "done": false, "episodes_total": 3840, "training_iteration": 120, "trial_id": "08022_00064", "date": "2024-02-26_23-18-54", "timestamp": 1708985934, "time_this_iter_s": 69.64687013626099, "time_total_s": 8730.736070156097, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8730.736070156097, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 61.586868686868684, "ram_util_percent": 21.711111111111116}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.44, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.23625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.23625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.4647812790858249, "policy_loss": -0.11236793089968462, "vf_loss": 0.7651264606664578, "vf_explained_var": 0.9998450974623362, "kl": 0.0, "entropy": 104.73395646413168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 61952, "num_env_steps_trained": 61952, "num_agent_steps_sampled": 61952, "num_agent_steps_trained": 61952}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.44, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.44, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.23625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.23625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 12.0, -16.0, 16.0, -16.0, -16.0, 12.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 12.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, 16.0, -16.0, -16.0, -16.0, 16.0, 14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3183192017988292, "mean_inference_ms": 10.50838112589657, "mean_action_processing_ms": 0.4422111051250998, "mean_env_wait_ms": 0.2825792371120149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2586803436279297, "StateBufferConnector_ms": 0.00465083122253418, "ViewRequirementAgentConnector_ms": 0.16825532913208008}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.44, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 12.0, -16.0, 16.0, -16.0, -16.0, 12.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 12.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, 16.0, -16.0, -16.0, -16.0, 16.0, 14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3183192017988292, "mean_inference_ms": 10.50838112589657, "mean_action_processing_ms": 0.4422111051250998, "mean_env_wait_ms": 0.2825792371120149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2586803436279297, "StateBufferConnector_ms": 0.00465083122253418, "ViewRequirementAgentConnector_ms": 0.16825532913208008}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61952, "num_agent_steps_trained": 61952, "num_env_steps_sampled": 61952, "num_env_steps_trained": 61952, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.278030497284616, "num_agent_steps_trained_throughput_per_sec": 7.278030497284616, "timesteps_total": 61952, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 61952, "timers": {"training_iteration_time_ms": 70485.408, "sample_time_ms": 6312.714, "load_time_ms": 0.299, "load_throughput": 1709779.975, "learn_time_ms": 64171.976, "learn_throughput": 7.979, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 61952, "num_env_steps_trained": 61952, "num_agent_steps_sampled": 61952, "num_agent_steps_trained": 61952}, "done": false, "episodes_total": 3872, "training_iteration": 121, "trial_id": "08022_00064", "date": "2024-02-26_23-20-05", "timestamp": 1708986005, "time_this_iter_s": 70.35367107391357, "time_total_s": 8801.089741230011, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8801.089741230011, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 61.367, "ram_util_percent": 21.949999999999996}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -6.56, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.295, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.295, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.5760955614969134, "policy_loss": -0.11614710440238317, "vf_loss": 0.9177058187623819, "vf_explained_var": 0.9998134652773539, "kl": 0.0, "entropy": 104.05742276509604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -6.56, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -6.56, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.295, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.295, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 12.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, 16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 10.0, 16.0, 12.0, 14.0, -16.0, -16.0, -16.0, 12.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 14.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3180719070168425, "mean_inference_ms": 10.507023603502077, "mean_action_processing_ms": 0.44220150001179304, "mean_env_wait_ms": 0.2825476716280584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2619504928588867, "StateBufferConnector_ms": 0.004766941070556641, "ViewRequirementAgentConnector_ms": 0.17292165756225586}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -6.56, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 12.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, 16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 10.0, 16.0, 12.0, 14.0, -16.0, -16.0, -16.0, 12.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 14.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3180719070168425, "mean_inference_ms": 10.507023603502077, "mean_action_processing_ms": 0.44220150001179304, "mean_env_wait_ms": 0.2825476716280584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2619504928588867, "StateBufferConnector_ms": 0.004766941070556641, "ViewRequirementAgentConnector_ms": 0.17292165756225586}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464, "num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.2252320414817275, "num_agent_steps_trained_throughput_per_sec": 7.2252320414817275, "timesteps_total": 62464, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 62464, "timers": {"training_iteration_time_ms": 70513.5, "sample_time_ms": 6310.997, "load_time_ms": 0.297, "load_throughput": 1725579.468, "learn_time_ms": 64201.792, "learn_throughput": 7.975, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464}, "done": false, "episodes_total": 3904, "training_iteration": 122, "trial_id": "08022_00064", "date": "2024-02-26_23-21-15", "timestamp": 1708986075, "time_this_iter_s": 70.86816906929016, "time_total_s": 8871.957910299301, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8871.957910299301, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 61.254455445544565, "ram_util_percent": 22.00594059405941}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -7.72, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.25875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.25875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.07930097507002452, "policy_loss": -0.06681307765344778, "vf_loss": 0.19370334035872172, "vf_explained_var": 0.8043064917127292, "kl": 0.0, "entropy": 108.56011276245117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 62976, "num_env_steps_trained": 62976, "num_agent_steps_sampled": 62976, "num_agent_steps_trained": 62976}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -7.72, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.25875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.25875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, 16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 10.0, 16.0, 12.0, 14.0, -16.0, -16.0, -16.0, 12.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 14.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3179655105612411, "mean_inference_ms": 10.506350145916462, "mean_action_processing_ms": 0.4422358776368035, "mean_env_wait_ms": 0.28254835576166537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2660050392150879, "StateBufferConnector_ms": 0.0048253536224365234, "ViewRequirementAgentConnector_ms": 0.17774748802185059}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, 16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 10.0, 16.0, 12.0, 14.0, -16.0, -16.0, -16.0, 12.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 14.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3179655105612411, "mean_inference_ms": 10.506350145916462, "mean_action_processing_ms": 0.4422358776368035, "mean_env_wait_ms": 0.28254835576166537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2660050392150879, "StateBufferConnector_ms": 0.0048253536224365234, "ViewRequirementAgentConnector_ms": 0.17774748802185059}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62976, "num_agent_steps_trained": 62976, "num_env_steps_sampled": 62976, "num_env_steps_trained": 62976, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.262272241234021, "num_agent_steps_trained_throughput_per_sec": 7.262272241234021, "timesteps_total": 62976, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 62976, "timers": {"training_iteration_time_ms": 70542.274, "sample_time_ms": 6338.181, "load_time_ms": 0.264, "load_throughput": 1938687.052, "learn_time_ms": 64203.405, "learn_throughput": 7.975, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 62976, "num_env_steps_trained": 62976, "num_agent_steps_sampled": 62976, "num_agent_steps_trained": 62976}, "done": false, "episodes_total": 3936, "training_iteration": 123, "trial_id": "08022_00064", "date": "2024-02-26_23-22-26", "timestamp": 1708986146, "time_this_iter_s": 70.5063407421112, "time_total_s": 8942.464251041412, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8942.464251041412, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 62.629000000000005, "ram_util_percent": 21.663}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.68, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.22875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.22875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.3437138528097421, "policy_loss": -0.09283851023452977, "vf_loss": 0.5787372873164713, "vf_explained_var": 0.9062023028731346, "kl": 0.0, "entropy": 106.80819549560547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.68, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.68, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.22875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.22875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 10.0, 16.0, 12.0, 14.0, -16.0, -16.0, -16.0, 12.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 14.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3177907771757216, "mean_inference_ms": 10.505142998122325, "mean_action_processing_ms": 0.4422441336575873, "mean_env_wait_ms": 0.2825323903020667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26339221000671387, "StateBufferConnector_ms": 0.00475621223449707, "ViewRequirementAgentConnector_ms": 0.17524504661560059}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.68, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 10.0, 16.0, 12.0, 14.0, -16.0, -16.0, -16.0, 12.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 14.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3177907771757216, "mean_inference_ms": 10.505142998122325, "mean_action_processing_ms": 0.4422441336575873, "mean_env_wait_ms": 0.2825323903020667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26339221000671387, "StateBufferConnector_ms": 0.00475621223449707, "ViewRequirementAgentConnector_ms": 0.17524504661560059}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488, "num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.274752192360236, "num_agent_steps_trained_throughput_per_sec": 7.274752192360236, "timesteps_total": 63488, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 63488, "timers": {"training_iteration_time_ms": 70480.137, "sample_time_ms": 6324.901, "load_time_ms": 0.265, "load_throughput": 1934147.211, "learn_time_ms": 64154.547, "learn_throughput": 7.981, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488}, "done": false, "episodes_total": 3968, "training_iteration": 124, "trial_id": "08022_00064", "date": "2024-02-26_23-23-36", "timestamp": 1708986216, "time_this_iter_s": 70.38549828529358, "time_total_s": 9012.849749326706, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9012.849749326706, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 62.464000000000006, "ram_util_percent": 21.856000000000005}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.9, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.190625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.190625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0008320538152504311, "total_loss": 0.404380016370366, "policy_loss": -0.11386827263049781, "vf_loss": 0.687041528398792, "vf_explained_var": 0.9998829692602158, "kl": 0.0, "entropy": 105.66723728179932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.9, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.190625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.190625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, 16.0, 12.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3174977592728512, "mean_inference_ms": 10.503251751251778, "mean_action_processing_ms": 0.44222046134495163, "mean_env_wait_ms": 0.2824964095521022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25948381423950195, "StateBufferConnector_ms": 0.004698991775512695, "ViewRequirementAgentConnector_ms": 0.17242002487182617}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, 16.0, 12.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3174977592728512, "mean_inference_ms": 10.503251751251778, "mean_action_processing_ms": 0.44222046134495163, "mean_env_wait_ms": 0.2824964095521022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25948381423950195, "StateBufferConnector_ms": 0.004698991775512695, "ViewRequirementAgentConnector_ms": 0.17242002487182617}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.2944242959419014, "num_agent_steps_trained_throughput_per_sec": 7.2944242959419014, "timesteps_total": 64000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 70423.348, "sample_time_ms": 6313.888, "load_time_ms": 0.266, "load_throughput": 1928069.355, "learn_time_ms": 64108.778, "learn_throughput": 7.986, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 4000, "training_iteration": 125, "trial_id": "08022_00064", "date": "2024-02-26_23-24-47", "timestamp": 1708986287, "time_this_iter_s": 70.1956307888031, "time_total_s": 9083.045380115509, "pid": 48364, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fb8e0f91870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008320538152504314, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 7, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb8e304b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.012486660834163412, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.7543187301234235, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9189406754347922, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9083.045380115509, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 61.86767676767678, "ram_util_percent": 21.923232323232323}, "checkpoint_dir_name": null}
